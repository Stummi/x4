"use strict";(self.webpackChunkx4_new=self.webpackChunkx4_new||[]).push([[29],{1029:(tt,_,c)=>{c.r(_),c.d(_,{ModuleModule:()=>H});var Z=c(433),T=c(5398),d=c(2655),y=c(6157),h=c(973),A=c(1814),q=c(5730),m=c(617),t=c(1571),g=c(9746),w=c(7179),f=c(1481),x=c(8782),u=c(4943);let M=(()=>{class n extends y.${constructor(e,i,o,l,r){super(e,o,l),this.raceService=i,this.titleService=r,this.calculateMaxEfficiency=s=>this.calculateMaxEfficiencyCore(s),this.calculateMaxEfficiencyDisplay=s=>this.calculateMaxEfficiencyDisplayCore(s),this.calculateProduct=s=>this.calculateProductCore(s)}ngOnInit(){this.titleService.setTitle(`${m.q} - Modules`),this.races=this.raceService.getEntities(),this.moduleTypes=A.w.values(h.J),super.ngOnInit()}calculateProductCore(e){return e.product?.map(i=>i.name).join(", ")}calculateMaxEfficiencyCore(e){if(null!=e.product){const i=e.product.map(o=>o.production?.map(l=>l.effects?.find(r=>r.type===q.z.work))).map(o=>o[0]).filter(o=>null!=o).map(o=>o.product);if(i?.length>0)return 100*(1+Math.max(...i))}return 100}calculateMaxEfficiencyDisplayCore(e){return null==e.product?"-":`${this.calculateMaxEfficiencyCore(e)}%`}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(g.C),t.Y36(w.G),t.Y36(d.F0),t.Y36(d.gz),t.Y36(f.Dx))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],features:[t.qOj],decls:20,vars:19,consts:function(){let e;return e=$localize`:@@stationModules: Station Modules `,[[1,"row","content-row"],[1,"col-md-12"],[1,"card","shadow"],[1,"card-header","shadow-sm"],e,[1,"card-body"],["keyExpr","id",3,"dataSource","allowColumnReordering","allowColumnResizing","showBorders","hoverStateEnabled","onCellClick"],[3,"showPageSizeSelector","showNavigationButtons"],["mode","multiple"],[3,"applyFilter","visible"],[3,"visible"],["dataField","name","caption","Name"],["dataField","type","caption","Type"],[3,"dataSource"],["dataField","makerRace.id","caption","Race"],["valueExpr","id","displayExpr","name",3,"dataSource"],["caption","Product","name","productName",3,"calculateDisplayValue","allowSorting","allowFiltering"],["caption","Max Efficiency","name","maxEfficiency",3,"calculateDisplayValue","calculateSortValue","allowSorting","allowFiltering"],["column","name","summaryType","count"]]},template:function(i,o){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t.SDv(4,4),t.qZA(),t.TgZ(5,"div",5)(6,"dx-data-grid",6),t.NdJ("onCellClick",function(r){return o.onRowSelect(r)}),t._UZ(7,"dxo-pager",7)(8,"dxo-sorting",8)(9,"dxo-filter-row",9)(10,"dxo-filter-panel",10)(11,"dxi-column",11),t.TgZ(12,"dxi-column",12),t._UZ(13,"dxo-lookup",13),t.qZA(),t.TgZ(14,"dxi-column",14),t._UZ(15,"dxo-lookup",15),t.qZA(),t._UZ(16,"dxi-column",16)(17,"dxi-column",17),t.TgZ(18,"dxo-summary"),t._UZ(19,"dxi-total-item",18),t.qZA()()()()()()),2&i&&(t.xp6(6),t.Q6J("dataSource",o.entities)("allowColumnReordering",!0)("allowColumnResizing",!0)("showBorders",!0)("hoverStateEnabled",!0),t.xp6(1),t.Q6J("showPageSizeSelector",!0)("showNavigationButtons",!0),t.xp6(2),t.Q6J("applyFilter",o.currentFilter)("visible",!0),t.xp6(1),t.Q6J("visible",!0),t.xp6(3),t.Q6J("dataSource",o.moduleTypes),t.xp6(2),t.Q6J("dataSource",o.races),t.xp6(1),t.Q6J("calculateDisplayValue",o.calculateProduct)("allowSorting",!0)("allowFiltering",!0),t.xp6(1),t.Q6J("calculateDisplayValue",o.calculateMaxEfficiencyDisplay)("calculateSortValue",o.calculateMaxEfficiency)("allowSorting",!0)("allowFiltering",!0))},dependencies:[x.e,u.qvW,u.w3U,u.ecQ,u.I62,u.ilc,u.SWO,u.owF,u.DTS],encapsulation:2})}return n})();var U=c(9407),C=c(2459),p=c(6895);function S(n,a){if(1&n&&(t.TgZ(0,"div",18)(1,"label",19),t._uU(2),t.qZA()()),2&n){const e=t.oxw(3);t.xp6(2),t.Oqu(e.entity.description)}}const O=function(n){return["/races",n]};function D(n,a){if(1&n&&(t.TgZ(0,"span")(1,"a",20),t._uU(2),t.qZA()()),2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("routerLink",t.VKq(2,O,e.entity.makerRace.id)),t.xp6(1),t.Oqu(e.entity.makerRace.name)}}function J(n,a){1&n&&(t.TgZ(0,"span"),t._uU(1," - "),t.qZA())}function N(n,a){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.Oqu(e.entity.type)}}function E(n,a){1&n&&(t.TgZ(0,"span"),t._uU(1," - "),t.qZA())}const v=function(n){return["/wares/",n]};function Q(n,a){if(1&n&&(t.TgZ(0,"div")(1,"a",20),t._uU(2),t.qZA()()),2&n){const e=a.$implicit;t.xp6(1),t.Q6J("routerLink",t.VKq(2,v,e.id)),t.xp6(1),t.Oqu(e.name)}}function F(n,a){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,Q,3,4,"div",15),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",e.entity.product)}}function I(n,a){1&n&&(t.TgZ(0,"span"),t._uU(1," - "),t.qZA())}function Y(n,a){if(1&n&&(t.ynx(0),t.TgZ(1,"dt",11),t._uU(2),t.qZA(),t.TgZ(3,"dd",12),t._uU(4),t.ALo(5,"number"),t.qZA(),t.BQk()),2&n){const e=t.oxw(3);t.xp6(2),t.hij("Storage Capacity (",null==e.entity.cargo.type?null:e.entity.cargo.type.name,")"),t.xp6(2),t.Oqu(t.lcZ(5,2,e.entity.cargo.max))}}function P(n,a){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.Oqu(t.lcZ(2,1,e.entity.explosionDamage))}}function L(n,a){1&n&&(t.TgZ(0,"span"),t._uU(1," - "),t.qZA())}function R(n,a){if(1&n&&(t.ynx(0),t.TgZ(1,"dt",11),t._uU(2,"Workforce Needed"),t.qZA(),t.TgZ(3,"dd",12),t._uU(4),t.qZA(),t.BQk()),2&n){const e=t.oxw(3);t.xp6(4),t.Oqu(e.entity.workForce.max)}}function $(n,a){if(1&n&&(t.ynx(0),t.TgZ(1,"dt",11),t._uU(2,"Workforce Capacity"),t.qZA(),t.TgZ(3,"dd",12),t._uU(4),t.qZA(),t.BQk()),2&n){const e=t.oxw(3);t.xp6(4),t.Oqu(e.entity.workForce.capacity)}}const z=function(n){return["/factions/",n]};function b(n,a){if(1&n&&(t.TgZ(0,"li")(1,"a",20),t._uU(2),t.qZA()()),2&n){const e=a.$implicit;t.xp6(1),t.Q6J("routerLink",t.VKq(2,z,e.id)),t.xp6(1),t.Oqu(e.name)}}function k(n,a){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.TgZ(3,"a",20),t._uU(4),t.qZA()(),t.TgZ(5,"td",30),t._uU(6),t.ALo(7,"number"),t.qZA(),t.TgZ(8,"td",30),t._uU(9),t.ALo(10,"number"),t.qZA(),t.TgZ(11,"td",30),t._uU(12),t.ALo(13,"number"),t.qZA()()),2&n){const e=a.$implicit;t.xp6(2),t.hij(" ",e.amount," x "),t.xp6(1),t.Q6J("routerLink",t.VKq(12,v,e.ware.id)),t.xp6(1),t.Oqu(e.ware.name),t.xp6(2),t.Oqu(t.lcZ(7,6,e.amount*e.ware.price.min)),t.xp6(3),t.Oqu(t.lcZ(10,8,e.amount*e.ware.price.max)),t.xp6(3),t.Oqu(t.lcZ(13,10,e.amount*e.ware.price.avg))}}function B(n,a){if(1&n&&(t.TgZ(0,"div",9)(1,"div",28)(2,"h6"),t._uU(3,"Requirements"),t.qZA(),t.TgZ(4,"table",29)(5,"thead")(6,"tr")(7,"th"),t._uU(8,"Resource"),t.qZA(),t.TgZ(9,"th",30),t._uU(10,"Min"),t.qZA(),t.TgZ(11,"th",30),t._uU(12,"Max"),t.qZA(),t.TgZ(13,"th",30),t._uU(14,"Avg"),t.qZA()()(),t.TgZ(15,"tbody"),t.YNc(16,k,14,14,"tr",15),t.qZA(),t.TgZ(17,"tfoot")(18,"tr")(19,"th",30),t._uU(20,"Total"),t.qZA(),t.TgZ(21,"th",30),t._uU(22),t.ALo(23,"number"),t.qZA(),t.TgZ(24,"th",30),t._uU(25),t.ALo(26,"number"),t.qZA(),t.TgZ(27,"th",30),t._uU(28),t.ALo(29,"number"),t.qZA()()()()()()),2&n){const e=t.oxw().$implicit,i=t.oxw(4);t.xp6(16),t.Q6J("ngForOf",e.wares),t.xp6(6),t.Oqu(t.lcZ(23,4,i.getTotalMin(e))),t.xp6(3),t.Oqu(t.lcZ(26,6,i.getTotalMax(e))),t.xp6(3),t.Oqu(t.lcZ(29,8,i.getTotalAvg(e)))}}function V(n,a){if(1&n&&(t.TgZ(0,"div",23)(1,"div",24)(2,"div",25),t._uU(3," Production: "),t.TgZ(4,"em"),t._uU(5),t.qZA()(),t.TgZ(6,"div",26),t.YNc(7,B,30,10,"div",27),t.TgZ(8,"div",9)(9,"div",28)(10,"h6"),t._uU(11,"Production"),t.qZA(),t.TgZ(12,"table",29)(13,"tbody")(14,"tr")(15,"td"),t._uU(16,"Time"),t.qZA(),t.TgZ(17,"td",30),t._uU(18),t.qZA()()()()()()()()()),2&n){const e=a.$implicit,i=t.oxw(4);t.xp6(5),t.Oqu(e.name),t.xp6(2),t.Q6J("ngIf",e.wares.length),t.xp6(11),t.Oqu(i.getProductionTime(e.time))}}function j(n,a){if(1&n&&(t.TgZ(0,"div",21),t.YNc(1,V,19,3,"div",22),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",e.entityProduction)}}function K(n,a){if(1&n&&(t.TgZ(0,"div",7),t.YNc(1,S,3,1,"div",8),t.TgZ(2,"div",9)(3,"div",10)(4,"dl",9)(5,"dt",11),t._uU(6,"Race"),t.qZA(),t.TgZ(7,"dd",12),t.YNc(8,D,3,4,"span",13),t.YNc(9,J,2,0,"span",13),t.qZA(),t.TgZ(10,"dt",11),t._uU(11,"Type"),t.qZA(),t.TgZ(12,"dd",12),t.YNc(13,N,2,1,"span",13),t.YNc(14,E,2,0,"span",13),t.qZA(),t.TgZ(15,"dt",11),t._uU(16,"Product"),t.qZA(),t.TgZ(17,"dd",12),t.YNc(18,F,2,1,"div",13),t.YNc(19,I,2,0,"span",13),t.qZA(),t.YNc(20,Y,6,4,"ng-container",13),t.TgZ(21,"dt",11),t._uU(22,"Hull"),t.qZA(),t.TgZ(23,"dd",12),t._uU(24),t.ALo(25,"number"),t.qZA(),t.TgZ(26,"dt",11),t._uU(27,"Explosion Damage"),t.qZA(),t.TgZ(28,"dd",12),t.YNc(29,P,3,3,"span",13),t.YNc(30,L,2,0,"span",13),t.qZA(),t.YNc(31,R,5,1,"ng-container",13),t.YNc(32,$,5,1,"ng-container",13),t.TgZ(33,"dt",11),t._uU(34,"Owners"),t.qZA(),t.TgZ(35,"dd",12)(36,"ul",14),t.YNc(37,b,3,4,"li",15),t.qZA()()()(),t.TgZ(38,"div",10)(39,"div",16)(40,"dl",9)(41,"dt",11),t._uU(42,"Turrets"),t.qZA(),t.TgZ(43,"dd",12),t._uU(44),t.qZA(),t.TgZ(45,"dt",11),t._uU(46,"Shields"),t.qZA(),t.TgZ(47,"dd",12),t._uU(48),t.qZA()()()()(),t.YNc(49,j,2,1,"div",17),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf","No information available"!=e.entity.description),t.xp6(7),t.Q6J("ngIf",e.entity.makerRace),t.xp6(1),t.Q6J("ngIf",!e.entity.makerRace),t.xp6(4),t.Q6J("ngIf",e.entity.type),t.xp6(1),t.Q6J("ngIf",!e.entity.type),t.xp6(4),t.Q6J("ngIf",e.entity.product&&e.entity.product.length),t.xp6(1),t.Q6J("ngIf",!e.entity.product),t.xp6(1),t.Q6J("ngIf",e.entity.cargo),t.xp6(4),t.Oqu(t.lcZ(25,17,e.entity.hull)),t.xp6(5),t.Q6J("ngIf",e.entity.explosionDamage),t.xp6(1),t.Q6J("ngIf",!e.entity.explosionDamage),t.xp6(1),t.Q6J("ngIf",null==e.entity.workForce?null:e.entity.workForce.max),t.xp6(1),t.Q6J("ngIf",null==e.entity.workForce?null:e.entity.workForce.capacity),t.xp6(5),t.Q6J("ngForOf",e.entity.owners),t.xp6(7),t.Oqu(e.getSlotsStr(e.entity.turrets)),t.xp6(4),t.Oqu(e.getSlotsStr(e.entity.shields)),t.xp6(1),t.Q6J("ngIf",e.entityProduction&&e.entityProduction.length)}}function W(n,a){if(1&n&&(t.TgZ(0,"div",3)(1,"div",4)(2,"a",5),t._uU(3,"Station Modules"),t.qZA(),t._uU(4),t.qZA(),t.YNc(5,K,50,19,"div",6),t.qZA()),2&n){const e=t.oxw();t.xp6(4),t.hij(" - ",e.entity.name," "),t.xp6(1),t.Q6J("ngIf",e.entity)}}let X=(()=>{class n extends U.x{constructor(e,i,o,l){super(i,o),this.wareService=e,this.titleService=l}ngOnInit(){this.titleService.setTitle(`${m.q} - Modules`),super.ngOnInit()}onEntityLoaded(e){this.titleService.setTitle(`${m.q} - Modules - ${this.entity.name}`),this.entityProduction=this.entity.production.map(i=>({amount:i.amount,effects:i.effects,method:i.method,name:i.name,time:i.time,wares:i.wares.map(o=>({ware:this.wareService.getEntity(o.ware),amount:o.amount}))}))}getTotalMin(e){let i=0;return e.wares.forEach(o=>{i+=o.amount*o.ware.price.min}),i}getTotalMax(e){let i=0;return e.wares.forEach(o=>{i+=o.amount*o.ware.price.max}),i}getTotalAvg(e){let i=0;return e.wares.forEach(o=>{i+=o.amount*o.ware.price.avg}),i}getProductionTime(e){const i=Math.trunc(e/60),o=e-60*i;let l="";return i>0&&(l+=i+(1===i?" minute":" minutes")),o>0&&(i>0&&(l+=" "),l+=o+(1===o?" second":" seconds")),l}getSlotsStr(e){const i=this.getSlots(e);return 0==i.length?"-":i.map(o=>`${o.capacity} x ${o.size}`).join(", ")}getSlots(e){if(!e)return[];const i=e.reduce((l,r)=>(l[r.size]=l[r.size]||0,l[r.size]+=r.capacity||1,l),{}),o=[];return Object.keys(i).forEach(l=>{o.push({size:l,capacity:i[l]})}),o}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(C.l),t.Y36(g.C),t.Y36(d.gz),t.Y36(f.Dx))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],features:[t.qOj],decls:3,vars:1,consts:[[1,"row","content-row"],[1,"col-md-12"],["class","card shadow",4,"ngIf"],[1,"card","shadow"],[1,"card-header","shadow-sm"],["routerLink","/modules"],["class","card-body small",4,"ngIf"],[1,"card-body","small"],["class","form-group row",4,"ngIf"],[1,"row"],[1,"col-md-6","col-sm-12"],[1,"col-5"],[1,"col-7"],[4,"ngIf"],[1,"list-unstyled"],[4,"ngFor","ngForOf"],[1,"col-md-4","col-sm-12"],["class","row mt-2 mb-2",4,"ngIf"],[1,"form-group","row"],[1,"col","col-form-label","col-form-label-sm"],[3,"routerLink"],[1,"row","mt-2","mb-2"],["class","col-md-6 col-sm-6 col-lg-4",4,"ngFor","ngForOf"],[1,"col-md-6","col-sm-6","col-lg-4"],[1,"card","shadow-sm"],[1,"card-header"],[1,"card-body"],["class","row",4,"ngIf"],[1,"col"],[1,"table","table-sm"],[1,"text-right"]],template:function(i,o){1&i&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,W,6,2,"div",2),t.qZA()()),2&i&&(t.xp6(2),t.Q6J("ngIf",o.entity))},dependencies:[p.sg,p.O5,d.rH,p.JJ],encapsulation:2})}return n})(),G=(()=>{class n{static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({imports:[d.Bz.forChild([{path:"",component:M},{path:":id",component:X}]),d.Bz]})}return n})(),H=(()=>{class n{static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({imports:[p.ez,Z.u5,T.m,x.x,G]})}return n})()}}]);