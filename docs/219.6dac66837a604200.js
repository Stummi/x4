(self.webpackChunkx4_new=self.webpackChunkx4_new||[]).push([[219],{5219:(he,te,R)=>{"use strict";R.r(te),R.d(te,{StationModule:()=>Lr});var e=R(1571),O=R(6895);function M(o){return null!=o&&"false"!=`${o}`}function F(o,i=0){return function m(o){return!isNaN(parseFloat(o))&&!isNaN(Number(o))}(o)?Number(o):i}function U(o){return o instanceof e.SBq?o.nativeElement:o}var L=R(7579),z=R(9646),q=R(9751),B=R(4968),Y=R(4408),H=R(727);const W={schedule(o){let i=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:n}=W;n&&(i=n.requestAnimationFrame,t=n.cancelAnimationFrame);const r=i(l=>{t=void 0,o(l)});return new H.w0(()=>t?.(r))},requestAnimationFrame(...o){const{delegate:i}=W;return(i?.requestAnimationFrame||requestAnimationFrame)(...o)},cancelAnimationFrame(...o){const{delegate:i}=W;return(i?.cancelAnimationFrame||cancelAnimationFrame)(...o)},delegate:void 0};var N=R(640);const h=new class k extends N.v{flush(i){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let r;i=i||n.shift();do{if(r=i.execute(i.state,i.delay))break}while((i=n[0])&&i.id===t&&n.shift());if(this._active=!1,r){for(;(i=n[0])&&i.id===t&&n.shift();)i.unsubscribe();throw r}}}(class oe extends Y.o{constructor(i,t){super(i,t),this.scheduler=i,this.work=t}requestAsyncId(i,t,n=0){return null!==n&&n>0?super.requestAsyncId(i,t,n):(i.actions.push(this),i._scheduled||(i._scheduled=W.requestAnimationFrame(()=>i.flush(void 0))))}recycleAsyncId(i,t,n=0){var r;if(null!=n?n>0:this.delay>0)return super.recycleAsyncId(i,t,n);const{actions:l}=i;null!=t&&(null===(r=l[l.length-1])||void 0===r?void 0:r.id)!==t&&(W.cancelAnimationFrame(t),i._scheduled=void 0)}});let P,v=1;const $={};function T(o){return o in $&&(delete $[o],!0)}const K={setImmediate(o){const i=v++;return $[i]=!0,P||(P=Promise.resolve()),P.then(()=>T(i)&&o()),i},clearImmediate(o){T(o)}},{setImmediate:_e,clearImmediate:Me}=K,Ee={setImmediate(...o){const{delegate:i}=Ee;return(i?.setImmediate||_e)(...o)},clearImmediate(o){const{delegate:i}=Ee;return(i?.clearImmediate||Me)(o)},delegate:void 0};new class De extends N.v{flush(i){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let r;i=i||n.shift();do{if(r=i.execute(i.state,i.delay))break}while((i=n[0])&&i.id===t&&n.shift());if(this._active=!1,r){for(;(i=n[0])&&i.id===t&&n.shift();)i.unsubscribe();throw r}}}(class Oe extends Y.o{constructor(i,t){super(i,t),this.scheduler=i,this.work=t}requestAsyncId(i,t,n=0){return null!==n&&n>0?super.requestAsyncId(i,t,n):(i.actions.push(this),i._scheduled||(i._scheduled=Ee.setImmediate(i.flush.bind(i,void 0))))}recycleAsyncId(i,t,n=0){var r;if(null!=n?n>0:this.delay>0)return super.recycleAsyncId(i,t,n);const{actions:l}=i;null!=t&&(null===(r=l[l.length-1])||void 0===r?void 0:r.id)!==t&&(Ee.clearImmediate(t),i._scheduled=void 0)}});var we=R(4986),Re=R(4482),se=R(8421),pe=R(5403),be=R(5963);function xe(o,i=we.z){return function ke(o){return(0,Re.e)((i,t)=>{let n=!1,r=null,l=null,f=!1;const S=()=>{if(l?.unsubscribe(),l=null,n){n=!1;const b=r;r=null,t.next(b)}f&&t.complete()},E=()=>{l=null,f&&t.complete()};i.subscribe((0,pe.x)(t,b=>{n=!0,r=b,l||(0,se.Xf)(o(b)).subscribe(l=(0,pe.x)(t,S,E))},()=>{f=!0,(!n||!l||l.closed)&&t.complete()}))})}(()=>(0,be.H)(o,i))}var $e=R(9300);let _;try{_=typeof Intl<"u"&&Intl.v8BreakIterator}catch{_=!1}let Q,y,c=(()=>{class o{constructor(t){this._platformId=t,this.isBrowser=this._platformId?(0,O.NF)(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!_)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(e.Lbi))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function Te(o){return function me(){if(null==Q&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Q=!0}))}finally{Q=Q||!1}return Q}()?o:!!o.capture}function x(o){if(function w(){if(null==y){const o=typeof document<"u"?document.head:null;y=!(!o||!o.createShadowRoot&&!o.attachShadow)}return y}()){const i=o.getRootNode?o.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&i instanceof ShadowRoot)return i}return null}function ie(o){return o.composedPath?o.composedPath()[0]:o.target}let mn=(()=>{class o{constructor(t,n,r){this._ngZone=t,this._platform=n,this._scrolled=new L.x,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const n=this.scrollContainers.get(t);n&&(n.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new q.y(n=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(xe(t)).subscribe(n):this._scrolled.subscribe(n);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):(0,z.of)()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,n)=>this.deregister(n)),this._scrolled.complete()}ancestorScrolled(t,n){const r=this.getAncestorScrollContainers(t);return this.scrolled(n).pipe((0,$e.h)(l=>!l||r.indexOf(l)>-1))}getAncestorScrollContainers(t){const n=[];return this.scrollContainers.forEach((r,l)=>{this._scrollableContainsElement(l,t)&&n.push(l)}),n}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,n){let r=U(n),l=t.getElementRef().nativeElement;do{if(r==l)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>{const t=this._getWindow();return(0,B.R)(t.document,"scroll").subscribe(()=>this._scrolled.next())})}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(e.R0b),e.LFG(c),e.LFG(O.K0,8))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),Sn=(()=>{class o{constructor(t,n,r){this._platform=t,this._change=new L.x,this._changeListener=l=>{this._change.next(l)},this._document=r,n.runOutsideAngular(()=>{if(t.isBrowser){const l=this._getWindow();l.addEventListener("resize",this._changeListener),l.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:n,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+n,height:r,width:n}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,n=this._getWindow(),r=t.documentElement,l=r.getBoundingClientRect();return{top:-l.top||t.body.scrollTop||n.scrollY||r.scrollTop||0,left:-l.left||t.body.scrollLeft||n.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(xe(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(c),e.LFG(e.R0b),e.LFG(O.K0,8))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),Cn=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({}),o})();var lt=R(6451),Ve=R(2722),ct=R(8675),Ln=R(4004),bt=R(5698),Un=R(8505),Zn=R(3900);const Bn=new e.OlP("cdk-dir-doc",{providedIn:"root",factory:function $n(){return(0,e.f3M)(O.K0)}}),Yn=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let xt=(()=>{class o{constructor(t){this.value="ltr",this.change=new e.vpe,t&&(this.value=function Vn(o){const i=o?.toLowerCase()||"";return"auto"===i&&typeof navigator<"u"&&navigator?.language?Yn.test(navigator.language)?"rtl":"ltr":"rtl"===i?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(Bn,8))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function ut(o,i,t){for(let n in i)if(i.hasOwnProperty(n)){const r=i[n];r?o.setProperty(n,r,t?.has(n)?"important":""):o.removeProperty(n)}return o}function Fe(o,i){const t=i?"":"none";ut(o.style,{"touch-action":i?"":"none","-webkit-user-drag":i?"":"none","-webkit-tap-highlight-color":i?"":"transparent","user-select":t,"-ms-user-select":t,"-webkit-user-select":t,"-moz-user-select":t})}function Rt(o,i,t){ut(o.style,{position:i?"":"fixed",top:i?"":"0",opacity:i?"":"0",left:i?"":"-999em"},t)}function Qe(o,i){return i&&"none"!=i?o+" "+i:o}function Pt(o){const i=o.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(o)*i}function dt(o,i){return o.getPropertyValue(i).split(",").map(n=>n.trim())}function _t(o){const i=o.getBoundingClientRect();return{top:i.top,right:i.right,bottom:i.bottom,left:i.left,width:i.width,height:i.height,x:i.x,y:i.y}}function ht(o,i,t){const{top:n,bottom:r,left:l,right:f}=o;return t>=n&&t<=r&&i>=l&&i<=f}function Ge(o,i,t){o.top+=i,o.bottom=o.top+o.height,o.left+=t,o.right=o.left+o.width}function Dt(o,i,t,n){const{top:r,right:l,bottom:f,left:S,width:E,height:b}=o,V=E*i,G=b*i;return n>r-G&&n<f+G&&t>S-V&&t<l+V}class kt{constructor(i){this._document=i,this.positions=new Map}clear(){this.positions.clear()}cache(i){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),i.forEach(t=>{this.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:_t(t)})})}handleScroll(i){const t=ie(i),n=this.positions.get(t);if(!n)return null;const r=n.scrollPosition;let l,f;if(t===this._document){const b=this.getViewportScrollPosition();l=b.top,f=b.left}else l=t.scrollTop,f=t.scrollLeft;const S=r.top-l,E=r.left-f;return this.positions.forEach((b,V)=>{b.clientRect&&t!==V&&t.contains(V)&&Ge(b.clientRect,S,E)}),r.top=l,r.left=f,{top:S,left:E}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}}function Ft(o){const i=o.cloneNode(!0),t=i.querySelectorAll("[id]"),n=o.nodeName.toLowerCase();i.removeAttribute("id");for(let r=0;r<t.length;r++)t[r].removeAttribute("id");return"canvas"===n?Zt(o,i):("input"===n||"select"===n||"textarea"===n)&&Ut(o,i),Lt("canvas",o,i,Zt),Lt("input, textarea, select",o,i,Ut),i}function Lt(o,i,t,n){const r=i.querySelectorAll(o);if(r.length){const l=t.querySelectorAll(o);for(let f=0;f<r.length;f++)n(r[f],l[f])}}let zn=0;function Ut(o,i){"file"!==i.type&&(i.value=o.value),"radio"===i.type&&i.name&&(i.name=`mat-clone-${i.name}-${zn++}`)}function Zt(o,i){const t=i.getContext("2d");if(t)try{t.drawImage(o,0,0)}catch{}}const Bt=Te({passive:!0}),et=Te({passive:!1}),ft=new Set(["position"]);class jn{get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(i){const t=M(i);t!==this._disabled&&(this._disabled=t,this._toggleNativeDragInteractions(),this._handles.forEach(n=>Fe(n,t)))}constructor(i,t,n,r,l,f){this._config=t,this._document=n,this._ngZone=r,this._viewportRuler=l,this._dragDropRegistry=f,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=!1,this._moveEvents=new L.x,this._pointerMoveSubscription=H.w0.EMPTY,this._pointerUpSubscription=H.w0.EMPTY,this._scrollSubscription=H.w0.EMPTY,this._resizeSubscription=H.w0.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new L.x,this.started=new L.x,this.released=new L.x,this.ended=new L.x,this.entered=new L.x,this.exited=new L.x,this.dropped=new L.x,this.moved=this._moveEvents,this._pointerDown=S=>{if(this.beforeStarted.next(),this._handles.length){const E=this._getTargetHandle(S);E&&!this._disabledHandles.has(E)&&!this.disabled&&this._initializeDragSequence(E,S)}else this.disabled||this._initializeDragSequence(this._rootElement,S)},this._pointerMove=S=>{const E=this._getPointerPositionOnPage(S);if(!this._hasStartedDragging){if(Math.abs(E.x-this._pickupPositionOnPage.x)+Math.abs(E.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const Se=Date.now()>=this._dragStartTime+this._getDragStartDelay(S),ue=this._dropContainer;if(!Se)return void this._endDragSequence(S);(!ue||!ue.isDragging()&&!ue.isReceiving())&&(S.preventDefault(),this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(S)))}return}S.preventDefault();const b=this._getConstrainedPointerPosition(E);if(this._hasMoved=!0,this._lastKnownPointerPosition=E,this._updatePointerDirectionDelta(b),this._dropContainer)this._updateActiveDropContainer(b,E);else{const V=this.constrainPosition?this._initialClientRect:this._pickupPositionOnPage,G=this._activeTransform;G.x=b.x-V.x+this._passiveTransform.x,G.y=b.y-V.y+this._passiveTransform.y,this._applyRootElementTransform(G.x,G.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:b,event:S,distance:this._getDragDistance(b),delta:this._pointerDirectionDelta})})},this._pointerUp=S=>{this._endDragSequence(S)},this._nativeDragStart=S=>{if(this._handles.length){const E=this._getTargetHandle(S);E&&!this._disabledHandles.has(E)&&!this.disabled&&S.preventDefault()}else this.disabled||S.preventDefault()},this.withRootElement(i).withParent(t.parentDragRef||null),this._parentPositions=new kt(n),f.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(i){this._handles=i.map(n=>U(n)),this._handles.forEach(n=>Fe(n,this.disabled)),this._toggleNativeDragInteractions();const t=new Set;return this._disabledHandles.forEach(n=>{this._handles.indexOf(n)>-1&&t.add(n)}),this._disabledHandles=t,this}withPreviewTemplate(i){return this._previewTemplate=i,this}withPlaceholderTemplate(i){return this._placeholderTemplate=i,this}withRootElement(i){const t=U(i);return t!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{t.addEventListener("mousedown",this._pointerDown,et),t.addEventListener("touchstart",this._pointerDown,Bt),t.addEventListener("dragstart",this._nativeDragStart,et)}),this._initialTransform=void 0,this._rootElement=t),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(i){return this._boundaryElement=i?U(i):null,this._resizeSubscription.unsubscribe(),i&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(i){return this._parentDragRef=i,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&this._rootElement?.remove(),this._anchor?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(i){!this._disabledHandles.has(i)&&this._handles.indexOf(i)>-1&&(this._disabledHandles.add(i),Fe(i,!0))}enableHandle(i){this._disabledHandles.has(i)&&(this._disabledHandles.delete(i),Fe(i,this.disabled))}withDirection(i){return this._direction=i,this}_withDropContainer(i){this._dropContainer=i}getFreeDragPosition(){const i=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:i.x,y:i.y}}setFreeDragPosition(i){return this._activeTransform={x:0,y:0},this._passiveTransform.x=i.x,this._passiveTransform.y=i.y,this._dropContainer||this._applyRootElementTransform(i.x,i.y),this}withPreviewContainer(i){return this._previewContainer=i,this}_sortFromLastPointerPosition(){const i=this._lastKnownPointerPosition;i&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(i),i)}_removeSubscriptions(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}_destroyPreview(){this._preview?.remove(),this._previewRef?.destroy(),this._preview=this._previewRef=null}_destroyPlaceholder(){this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(i){if(this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging))if(this.released.next({source:this,event:i}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(i),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;const t=this._getPointerPositionOnPage(i);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(t),dropPoint:t,event:i})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(i){ze(i)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const t=this._dropContainer;if(t){const n=this._rootElement,r=n.parentNode,l=this._placeholder=this._createPlaceholderElement(),f=this._anchor=this._anchor||this._document.createComment(""),S=this._getShadowRoot();r.insertBefore(f,n),this._initialTransform=n.style.transform||"",this._preview=this._createPreviewElement(),Rt(n,!1,ft),this._document.body.appendChild(r.replaceChild(l,n)),this._getPreviewInsertionPoint(r,S).appendChild(this._preview),this.started.next({source:this,event:i}),t.start(),this._initialContainer=t,this._initialIndex=t.getItemIndex(this)}else this.started.next({source:this,event:i}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(t?t.getScrollableParents():[])}_initializeDragSequence(i,t){this._parentDragRef&&t.stopPropagation();const n=this.isDragging(),r=ze(t),l=!r&&0!==t.button,f=this._rootElement,S=ie(t),E=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now(),b=r?function Dn(o){const i=o.touches&&o.touches[0]||o.changedTouches&&o.changedTouches[0];return!(!i||-1!==i.identifier||null!=i.radiusX&&1!==i.radiusX||null!=i.radiusY&&1!==i.radiusY)}(t):function Pn(o){return 0===o.buttons||0===o.offsetX&&0===o.offsetY}(t);if(S&&S.draggable&&"mousedown"===t.type&&t.preventDefault(),n||l||E||b)return;if(this._handles.length){const ge=f.style;this._rootElementTapHighlight=ge.webkitTapHighlightColor||"",ge.webkitTapHighlightColor="transparent"}this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._initialClientRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(ge=>this._updateOnScroll(ge)),this._boundaryElement&&(this._boundaryRect=_t(this._boundaryElement));const V=this._previewTemplate;this._pickupPositionInElement=V&&V.template&&!V.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialClientRect,i,t);const G=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(t);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:G.x,y:G.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,t)}_cleanupDragArtifacts(i){Rt(this._rootElement,!0,ft),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._initialClientRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{const t=this._dropContainer,n=t.getItemIndex(this),r=this._getPointerPositionOnPage(i),l=this._getDragDistance(r),f=t._isOverContainer(r.x,r.y);this.ended.next({source:this,distance:l,dropPoint:r,event:i}),this.dropped.next({item:this,currentIndex:n,previousIndex:this._initialIndex,container:t,previousContainer:this._initialContainer,isPointerOverContainer:f,distance:l,dropPoint:r,event:i}),t.drop(this,n,this._initialIndex,this._initialContainer,f,l,r,i),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:i,y:t},{x:n,y:r}){let l=this._initialContainer._getSiblingContainerFromPosition(this,i,t);!l&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(i,t)&&(l=this._initialContainer),l&&l!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=l,this._dropContainer.enter(this,i,t,l===this._initialContainer&&l.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:l,currentIndex:l.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(n,r),this._dropContainer._sortItem(this,i,t,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(i,t):this._applyPreviewTransform(i-this._pickupPositionInElement.x,t-this._pickupPositionInElement.y))}_createPreviewElement(){const i=this._previewTemplate,t=this.previewClass,n=i?i.template:null;let r;if(n&&i){const l=i.matchSize?this._initialClientRect:null,f=i.viewContainer.createEmbeddedView(n,i.context);f.detectChanges(),r=Yt(f,this._document),this._previewRef=f,i.matchSize?Vt(r,l):r.style.transform=tt(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else r=Ft(this._rootElement),Vt(r,this._initialClientRect),this._initialTransform&&(r.style.transform=this._initialTransform);return ut(r.style,{"pointer-events":"none",margin:"0",position:"fixed",top:"0",left:"0","z-index":`${this._config.zIndex||1e3}`},ft),Fe(r,!1),r.classList.add("cdk-drag-preview"),r.setAttribute("dir",this._direction),t&&(Array.isArray(t)?t.forEach(l=>r.classList.add(l)):r.classList.add(t)),r}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const i=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._applyPreviewTransform(i.left,i.top);const t=function Gn(o){const i=getComputedStyle(o),t=dt(i,"transition-property"),n=t.find(S=>"transform"===S||"all"===S);if(!n)return 0;const r=t.indexOf(n),l=dt(i,"transition-duration"),f=dt(i,"transition-delay");return Pt(l[r])+Pt(f[r])}(this._preview);return 0===t?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(n=>{const r=f=>{(!f||ie(f)===this._preview&&"transform"===f.propertyName)&&(this._preview?.removeEventListener("transitionend",r),n(),clearTimeout(l))},l=setTimeout(r,1.5*t);this._preview.addEventListener("transitionend",r)}))}_createPlaceholderElement(){const i=this._placeholderTemplate,t=i?i.template:null;let n;return t?(this._placeholderRef=i.viewContainer.createEmbeddedView(t,i.context),this._placeholderRef.detectChanges(),n=Yt(this._placeholderRef,this._document)):n=Ft(this._rootElement),n.style.pointerEvents="none",n.classList.add("cdk-drag-placeholder"),n}_getPointerPositionInElement(i,t,n){const r=t===this._rootElement?null:t,l=r?r.getBoundingClientRect():i,f=ze(n)?n.targetTouches[0]:n,S=this._getViewportScrollPosition();return{x:l.left-i.left+(f.pageX-l.left-S.left),y:l.top-i.top+(f.pageY-l.top-S.top)}}_getPointerPositionOnPage(i){const t=this._getViewportScrollPosition(),n=ze(i)?i.touches[0]||i.changedTouches[0]||{pageX:0,pageY:0}:i,r=n.pageX-t.left,l=n.pageY-t.top;if(this._ownerSVGElement){const f=this._ownerSVGElement.getScreenCTM();if(f){const S=this._ownerSVGElement.createSVGPoint();return S.x=r,S.y=l,S.matrixTransform(f.inverse())}}return{x:r,y:l}}_getConstrainedPointerPosition(i){const t=this._dropContainer?this._dropContainer.lockAxis:null;let{x:n,y:r}=this.constrainPosition?this.constrainPosition(i,this,this._initialClientRect,this._pickupPositionInElement):i;if("x"===this.lockAxis||"x"===t?r=this._pickupPositionOnPage.y:("y"===this.lockAxis||"y"===t)&&(n=this._pickupPositionOnPage.x),this._boundaryRect){const{x:l,y:f}=this._pickupPositionInElement,S=this._boundaryRect,{width:E,height:b}=this._getPreviewRect(),V=S.top+f,G=S.bottom-(b-f);n=$t(n,S.left+l,S.right-(E-l)),r=$t(r,V,G)}return{x:n,y:r}}_updatePointerDirectionDelta(i){const{x:t,y:n}=i,r=this._pointerDirectionDelta,l=this._pointerPositionAtLastDirectionChange,f=Math.abs(t-l.x),S=Math.abs(n-l.y);return f>this._config.pointerDirectionChangeThreshold&&(r.x=t>l.x?1:-1,l.x=t),S>this._config.pointerDirectionChangeThreshold&&(r.y=n>l.y?1:-1,l.y=n),r}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const i=this._handles.length>0||!this.isDragging();i!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=i,Fe(this._rootElement,i))}_removeRootElementListeners(i){i.removeEventListener("mousedown",this._pointerDown,et),i.removeEventListener("touchstart",this._pointerDown,Bt),i.removeEventListener("dragstart",this._nativeDragStart,et)}_applyRootElementTransform(i,t){const n=tt(i,t),r=this._rootElement.style;null==this._initialTransform&&(this._initialTransform=r.transform&&"none"!=r.transform?r.transform:""),r.transform=Qe(n,this._initialTransform)}_applyPreviewTransform(i,t){const n=this._previewTemplate?.template?void 0:this._initialTransform,r=tt(i,t);this._preview.style.transform=Qe(r,n)}_getDragDistance(i){const t=this._pickupPositionOnPage;return t?{x:i.x-t.x,y:i.y-t.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:i,y:t}=this._passiveTransform;if(0===i&&0===t||this.isDragging()||!this._boundaryElement)return;const n=this._rootElement.getBoundingClientRect(),r=this._boundaryElement.getBoundingClientRect();if(0===r.width&&0===r.height||0===n.width&&0===n.height)return;const l=r.left-n.left,f=n.right-r.right,S=r.top-n.top,E=n.bottom-r.bottom;r.width>n.width?(l>0&&(i+=l),f>0&&(i-=f)):i=0,r.height>n.height?(S>0&&(t+=S),E>0&&(t-=E)):t=0,(i!==this._passiveTransform.x||t!==this._passiveTransform.y)&&this.setFreeDragPosition({y:t,x:i})}_getDragStartDelay(i){const t=this.dragStartDelay;return"number"==typeof t?t:ze(i)?t.touch:t?t.mouse:0}_updateOnScroll(i){const t=this._parentPositions.handleScroll(i);if(t){const n=ie(i);this._boundaryRect&&n!==this._boundaryElement&&n.contains(this._boundaryElement)&&Ge(this._boundaryRect,t.top,t.left),this._pickupPositionOnPage.x+=t.left,this._pickupPositionOnPage.y+=t.top,this._dropContainer||(this._activeTransform.x-=t.left,this._activeTransform.y-=t.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=x(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(i,t){const n=this._previewContainer||"global";if("parent"===n)return i;if("global"===n){const r=this._document;return t||r.fullscreenElement||r.webkitFullscreenElement||r.mozFullScreenElement||r.msFullscreenElement||r.body}return U(n)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialClientRect),this._previewRect}_getTargetHandle(i){return this._handles.find(t=>i.target&&(i.target===t||t.contains(i.target)))}}function tt(o,i){return`translate3d(${Math.round(o)}px, ${Math.round(i)}px, 0)`}function $t(o,i,t){return Math.max(i,Math.min(t,o))}function ze(o){return"t"===o.type[0]}function Yt(o,i){const t=o.rootNodes;if(1===t.length&&t[0].nodeType===i.ELEMENT_NODE)return t[0];const n=i.createElement("div");return t.forEach(r=>n.appendChild(r)),n}function Vt(o,i){o.style.width=`${i.width}px`,o.style.height=`${i.height}px`,o.style.transform=tt(i.left,i.top)}function Gt(o,i,t){const n=He(i,o.length-1),r=He(t,o.length-1);if(n===r)return;const l=o[n],f=r<n?-1:1;for(let S=n;S!==r;S+=f)o[S]=o[S+f];o[r]=l}function He(o,i){return Math.max(0,Math.min(i,o))}class Kn{constructor(i,t){this._element=i,this._dragDropRegistry=t,this._itemPositions=[],this.orientation="vertical",this._previousSwap={drag:null,delta:0,overlaps:!1}}start(i){this.withItems(i)}sort(i,t,n,r){const l=this._itemPositions,f=this._getItemIndexFromPointerPosition(i,t,n,r);if(-1===f&&l.length>0)return null;const S="horizontal"===this.orientation,E=l.findIndex(ve=>ve.drag===i),b=l[f],G=b.clientRect,ge=E>f?1:-1,Se=this._getItemOffsetPx(l[E].clientRect,G,ge),ue=this._getSiblingOffsetPx(E,l,ge),Ie=l.slice();return Gt(l,E,f),l.forEach((ve,ot)=>{if(Ie[ot]===ve)return;const We=ve.drag===i,Be=We?Se:ue,Je=We?i.getPlaceholderElement():ve.drag.getRootElement();ve.offset+=Be,S?(Je.style.transform=Qe(`translate3d(${Math.round(ve.offset)}px, 0, 0)`,ve.initialTransform),Ge(ve.clientRect,0,Be)):(Je.style.transform=Qe(`translate3d(0, ${Math.round(ve.offset)}px, 0)`,ve.initialTransform),Ge(ve.clientRect,Be,0))}),this._previousSwap.overlaps=ht(G,t,n),this._previousSwap.drag=b.drag,this._previousSwap.delta=S?r.x:r.y,{previousIndex:E,currentIndex:f}}enter(i,t,n,r){const l=null==r||r<0?this._getItemIndexFromPointerPosition(i,t,n):r,f=this._activeDraggables,S=f.indexOf(i),E=i.getPlaceholderElement();let b=f[l];if(b===i&&(b=f[l+1]),!b&&(null==l||-1===l||l<f.length-1)&&this._shouldEnterAsFirstChild(t,n)&&(b=f[0]),S>-1&&f.splice(S,1),b&&!this._dragDropRegistry.isDragging(b)){const V=b.getRootElement();V.parentElement.insertBefore(E,V),f.splice(l,0,i)}else U(this._element).appendChild(E),f.push(i);E.style.transform="",this._cacheItemPositions()}withItems(i){this._activeDraggables=i.slice(),this._cacheItemPositions()}withSortPredicate(i){this._sortPredicate=i}reset(){this._activeDraggables.forEach(i=>{const t=i.getRootElement();if(t){const n=this._itemPositions.find(r=>r.drag===i)?.initialTransform;t.style.transform=n||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(i){return("horizontal"===this.orientation&&"rtl"===this.direction?this._itemPositions.slice().reverse():this._itemPositions).findIndex(n=>n.drag===i)}updateOnScroll(i,t){this._itemPositions.forEach(({clientRect:n})=>{Ge(n,i,t)}),this._itemPositions.forEach(({drag:n})=>{this._dragDropRegistry.isDragging(n)&&n._sortFromLastPointerPosition()})}_cacheItemPositions(){const i="horizontal"===this.orientation;this._itemPositions=this._activeDraggables.map(t=>{const n=t.getVisibleElement();return{drag:t,offset:0,initialTransform:n.style.transform||"",clientRect:_t(n)}}).sort((t,n)=>i?t.clientRect.left-n.clientRect.left:t.clientRect.top-n.clientRect.top)}_getItemOffsetPx(i,t,n){const r="horizontal"===this.orientation;let l=r?t.left-i.left:t.top-i.top;return-1===n&&(l+=r?t.width-i.width:t.height-i.height),l}_getSiblingOffsetPx(i,t,n){const r="horizontal"===this.orientation,l=t[i].clientRect,f=t[i+-1*n];let S=l[r?"width":"height"]*n;if(f){const E=r?"left":"top",b=r?"right":"bottom";-1===n?S-=f.clientRect[E]-l[b]:S+=l[E]-f.clientRect[b]}return S}_shouldEnterAsFirstChild(i,t){if(!this._activeDraggables.length)return!1;const n=this._itemPositions,r="horizontal"===this.orientation;if(n[0].drag!==this._activeDraggables[0]){const f=n[n.length-1].clientRect;return r?i>=f.right:t>=f.bottom}{const f=n[0].clientRect;return r?i<=f.left:t<=f.top}}_getItemIndexFromPointerPosition(i,t,n,r){const l="horizontal"===this.orientation,f=this._itemPositions.findIndex(({drag:S,clientRect:E})=>S!==i&&((!r||S!==this._previousSwap.drag||!this._previousSwap.overlaps||(l?r.x:r.y)!==this._previousSwap.delta)&&(l?t>=Math.floor(E.left)&&t<Math.floor(E.right):n>=Math.floor(E.top)&&n<Math.floor(E.bottom))));return-1!==f&&this._sortPredicate(f,i)?f:-1}}const Ht=.05;class qn{constructor(i,t,n,r,l){this._dragDropRegistry=t,this._ngZone=r,this._viewportRuler=l,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new L.x,this.entered=new L.x,this.exited=new L.x,this.dropped=new L.x,this.sorted=new L.x,this.receivingStarted=new L.x,this.receivingStopped=new L.x,this._isDragging=!1,this._draggables=[],this._siblings=[],this._activeSiblings=new Set,this._viewportScrollSubscription=H.w0.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new L.x,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),function Fn(o=0,i=we.z){return o<0&&(o=0),(0,be.H)(o,o,i)}(0,h).pipe((0,Ve.R)(this._stopScrollTimers)).subscribe(()=>{const f=this._scrollNode,S=this.autoScrollStep;1===this._verticalScrollDirection?f.scrollBy(0,-S):2===this._verticalScrollDirection&&f.scrollBy(0,S),1===this._horizontalScrollDirection?f.scrollBy(-S,0):2===this._horizontalScrollDirection&&f.scrollBy(S,0)})},this.element=U(i),this._document=n,this.withScrollableParents([this.element]),t.registerDropContainer(this),this._parentPositions=new kt(n),this._sortStrategy=new Kn(this.element,t),this._sortStrategy.withSortPredicate((f,S)=>this.sortPredicate(f,S,this))}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(i,t,n,r){this._draggingStarted(),null==r&&this.sortingDisabled&&(r=this._draggables.indexOf(i)),this._sortStrategy.enter(i,t,n,r),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:i,container:this,currentIndex:this.getItemIndex(i)})}exit(i){this._reset(),this.exited.next({item:i,container:this})}drop(i,t,n,r,l,f,S,E={}){this._reset(),this.dropped.next({item:i,currentIndex:t,previousIndex:n,container:this,previousContainer:r,isPointerOverContainer:l,distance:f,dropPoint:S,event:E})}withItems(i){const t=this._draggables;return this._draggables=i,i.forEach(n=>n._withDropContainer(this)),this.isDragging()&&(t.filter(r=>r.isDragging()).every(r=>-1===i.indexOf(r))?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(i){return this._sortStrategy.direction=i,this}connectedTo(i){return this._siblings=i.slice(),this}withOrientation(i){return this._sortStrategy.orientation=i,this}withScrollableParents(i){const t=U(this.element);return this._scrollableElements=-1===i.indexOf(t)?[t,...i]:i.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(i){return this._isDragging?this._sortStrategy.getItemIndex(i):this._draggables.indexOf(i)}isReceiving(){return this._activeSiblings.size>0}_sortItem(i,t,n,r){if(this.sortingDisabled||!this._clientRect||!Dt(this._clientRect,.05,t,n))return;const l=this._sortStrategy.sort(i,t,n,r);l&&this.sorted.next({previousIndex:l.previousIndex,currentIndex:l.currentIndex,container:this,item:i})}_startScrollingIfNecessary(i,t){if(this.autoScrollDisabled)return;let n,r=0,l=0;if(this._parentPositions.positions.forEach((f,S)=>{S===this._document||!f.clientRect||n||Dt(f.clientRect,.05,i,t)&&([r,l]=function Wn(o,i,t,n){const r=jt(i,n),l=Kt(i,t);let f=0,S=0;if(r){const E=o.scrollTop;1===r?E>0&&(f=1):o.scrollHeight-E>o.clientHeight&&(f=2)}if(l){const E=o.scrollLeft;1===l?E>0&&(S=1):o.scrollWidth-E>o.clientWidth&&(S=2)}return[f,S]}(S,f.clientRect,i,t),(r||l)&&(n=S))}),!r&&!l){const{width:f,height:S}=this._viewportRuler.getViewportSize(),E={width:f,height:S,top:0,right:f,bottom:S,left:0};r=jt(E,t),l=Kt(E,i),n=window}n&&(r!==this._verticalScrollDirection||l!==this._horizontalScrollDirection||n!==this._scrollNode)&&(this._verticalScrollDirection=r,this._horizontalScrollDirection=l,this._scrollNode=n,(r||l)&&n?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const i=U(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=i.msScrollSnapType||i.scrollSnapType||"",i.scrollSnapType=i.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){const i=U(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(i).clientRect}_reset(){this._isDragging=!1;const i=U(this.element).style;i.scrollSnapType=i.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(t=>t._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_isOverContainer(i,t){return null!=this._clientRect&&ht(this._clientRect,i,t)}_getSiblingContainerFromPosition(i,t,n){return this._siblings.find(r=>r._canReceive(i,t,n))}_canReceive(i,t,n){if(!this._clientRect||!ht(this._clientRect,t,n)||!this.enterPredicate(i,this))return!1;const r=this._getShadowRoot().elementFromPoint(t,n);if(!r)return!1;const l=U(this.element);return r===l||l.contains(r)}_startReceiving(i,t){const n=this._activeSiblings;!n.has(i)&&t.every(r=>this.enterPredicate(r,this)||this._draggables.indexOf(r)>-1)&&(n.add(i),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:i,receiver:this,items:t}))}_stopReceiving(i){this._activeSiblings.delete(i),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:i,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(i=>{if(this.isDragging()){const t=this._parentPositions.handleScroll(i);t&&this._sortStrategy.updateOnScroll(t.top,t.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const i=x(U(this.element));this._cachedShadowRoot=i||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const i=this._sortStrategy.getActiveItemsSnapshot().filter(t=>t.isDragging());this._siblings.forEach(t=>t._startReceiving(this,i))}}function jt(o,i){const{top:t,bottom:n,height:r}=o,l=r*Ht;return i>=t-l&&i<=t+l?1:i>=n-l&&i<=n+l?2:0}function Kt(o,i){const{left:t,right:n,width:r}=o,l=r*Ht;return i>=t-l&&i<=t+l?1:i>=n-l&&i<=n+l?2:0}const nt=Te({passive:!1,capture:!0});let Jn=(()=>{class o{constructor(t,n){this._ngZone=t,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=[],this._globalListeners=new Map,this._draggingPredicate=r=>r.isDragging(),this.pointerMove=new L.x,this.pointerUp=new L.x,this.scroll=new L.x,this._preventDefaultWhileDragging=r=>{this._activeDragInstances.length>0&&r.preventDefault()},this._persistentTouchmoveListener=r=>{this._activeDragInstances.length>0&&(this._activeDragInstances.some(this._draggingPredicate)&&r.preventDefault(),this.pointerMove.next(r))},this._document=n}registerDropContainer(t){this._dropInstances.has(t)||this._dropInstances.add(t)}registerDragItem(t){this._dragInstances.add(t),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,nt)})}removeDropContainer(t){this._dropInstances.delete(t)}removeDragItem(t){this._dragInstances.delete(t),this.stopDragging(t),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,nt)}startDragging(t,n){if(!(this._activeDragInstances.indexOf(t)>-1)&&(this._activeDragInstances.push(t),1===this._activeDragInstances.length)){const r=n.type.startsWith("touch");this._globalListeners.set(r?"touchend":"mouseup",{handler:l=>this.pointerUp.next(l),options:!0}).set("scroll",{handler:l=>this.scroll.next(l),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:nt}),r||this._globalListeners.set("mousemove",{handler:l=>this.pointerMove.next(l),options:nt}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((l,f)=>{this._document.addEventListener(f,l.handler,l.options)})})}}stopDragging(t){const n=this._activeDragInstances.indexOf(t);n>-1&&(this._activeDragInstances.splice(n,1),0===this._activeDragInstances.length&&this._clearGlobalListeners())}isDragging(t){return this._activeDragInstances.indexOf(t)>-1}scrolled(t){const n=[this.scroll];return t&&t!==this._document&&n.push(new q.y(r=>this._ngZone.runOutsideAngular(()=>{const f=S=>{this._activeDragInstances.length&&r.next(S)};return t.addEventListener("scroll",f,!0),()=>{t.removeEventListener("scroll",f,!0)}}))),(0,lt.T)(...n)}ngOnDestroy(){this._dragInstances.forEach(t=>this.removeDragItem(t)),this._dropInstances.forEach(t=>this.removeDropContainer(t)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((t,n)=>{this._document.removeEventListener(n,t.handler,t.options)}),this._globalListeners.clear()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(e.R0b),e.LFG(O.K0))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();const Xn={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let pt=(()=>{class o{constructor(t,n,r,l){this._document=t,this._ngZone=n,this._viewportRuler=r,this._dragDropRegistry=l}createDrag(t,n=Xn){return new jn(t,n,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(t){return new qn(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(O.K0),e.LFG(e.R0b),e.LFG(Sn),e.LFG(Jn))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();const gt=new e.OlP("CDK_DRAG_PARENT"),mt=new e.OlP("CdkDropListGroup"),qt=new e.OlP("CDK_DRAG_CONFIG");let ei=0;const Wt=new e.OlP("CdkDropList");let Jt=(()=>{class o{get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(t){this._dropListRef.disabled=this._disabled=M(t)}constructor(t,n,r,l,f,S,E){this.element=t,this._changeDetectorRef=r,this._scrollDispatcher=l,this._dir=f,this._group=S,this._destroyed=new L.x,this.connectedTo=[],this.id="cdk-drop-list-"+ei++,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.dropped=new e.vpe,this.entered=new e.vpe,this.exited=new e.vpe,this.sorted=new e.vpe,this._unsortedItems=new Set,this._dropListRef=n.createDropList(t),this._dropListRef.data=this,E&&this._assignDefaults(E),this._dropListRef.enterPredicate=(b,V)=>this.enterPredicate(b.data,V.data),this._dropListRef.sortPredicate=(b,V,G)=>this.sortPredicate(b,V.data,G.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),o._dropLists.push(this),S&&S._items.add(this)}addItem(t){this._unsortedItems.add(t),this._dropListRef.isDragging()&&this._syncItemsWithRef()}removeItem(t){this._unsortedItems.delete(t),this._dropListRef.isDragging()&&this._syncItemsWithRef()}getSortedItems(){return Array.from(this._unsortedItems).sort((t,n)=>t._dragRef.getVisibleElement().compareDocumentPosition(n._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){const t=o._dropLists.indexOf(this);t>-1&&o._dropLists.splice(t,1),this._group&&this._group._items.delete(this),this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(t){this._dir&&this._dir.change.pipe((0,ct.O)(this._dir.value),(0,Ve.R)(this._destroyed)).subscribe(n=>t.withDirection(n)),t.beforeStarted.subscribe(()=>{const n=function D(o){return Array.isArray(o)?o:[o]}(this.connectedTo).map(r=>"string"==typeof r?o._dropLists.find(f=>f.id===r):r);if(this._group&&this._group._items.forEach(r=>{-1===n.indexOf(r)&&n.push(r)}),!this._scrollableParentsResolved){const r=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(l=>l.getElementRef().nativeElement);this._dropListRef.withScrollableParents(r),this._scrollableParentsResolved=!0}t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.sortingDisabled=M(this.sortingDisabled),t.autoScrollDisabled=M(this.autoScrollDisabled),t.autoScrollStep=F(this.autoScrollStep,2),t.connectedTo(n.filter(r=>r&&r!==this).map(r=>r._dropListRef)).withOrientation(this.orientation)})}_handleEvents(t){t.beforeStarted.subscribe(()=>{this._syncItemsWithRef(),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(n=>{this.entered.emit({container:this,item:n.item.data,currentIndex:n.currentIndex})}),t.exited.subscribe(n=>{this.exited.emit({container:this,item:n.item.data}),this._changeDetectorRef.markForCheck()}),t.sorted.subscribe(n=>{this.sorted.emit({previousIndex:n.previousIndex,currentIndex:n.currentIndex,container:this,item:n.item.data})}),t.dropped.subscribe(n=>{this.dropped.emit({previousIndex:n.previousIndex,currentIndex:n.currentIndex,previousContainer:n.previousContainer.data,container:n.container.data,item:n.item.data,isPointerOverContainer:n.isPointerOverContainer,distance:n.distance,dropPoint:n.dropPoint,event:n.event}),this._changeDetectorRef.markForCheck()}),(0,lt.T)(t.receivingStarted,t.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(t){const{lockAxis:n,draggingDisabled:r,sortingDisabled:l,listAutoScrollDisabled:f,listOrientation:S}=t;this.disabled=r??!1,this.sortingDisabled=l??!1,this.autoScrollDisabled=f??!1,this.orientation=S||"vertical",n&&(this.lockAxis=n)}_syncItemsWithRef(){this._dropListRef.withItems(this.getSortedItems().map(t=>t._dragRef))}}return o._dropLists=[],o.\u0275fac=function(t){return new(t||o)(e.Y36(e.SBq),e.Y36(pt),e.Y36(e.sBO),e.Y36(mn),e.Y36(xt,8),e.Y36(mt,12),e.Y36(qt,8))},o.\u0275dir=e.lG2({type:o,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(t,n){2&t&&(e.uIk("id",n.id),e.ekj("cdk-drop-list-disabled",n.disabled)("cdk-drop-list-dragging",n._dropListRef.isDragging())("cdk-drop-list-receiving",n._dropListRef.isReceiving()))},inputs:{connectedTo:["cdkDropListConnectedTo","connectedTo"],data:["cdkDropListData","data"],orientation:["cdkDropListOrientation","orientation"],id:"id",lockAxis:["cdkDropListLockAxis","lockAxis"],disabled:["cdkDropListDisabled","disabled"],sortingDisabled:["cdkDropListSortingDisabled","sortingDisabled"],enterPredicate:["cdkDropListEnterPredicate","enterPredicate"],sortPredicate:["cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:["cdkDropListAutoScrollDisabled","autoScrollDisabled"],autoScrollStep:["cdkDropListAutoScrollStep","autoScrollStep"]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],standalone:!0,features:[e._Bn([{provide:mt,useValue:void 0},{provide:Wt,useExisting:o}])]}),o})();const Tt=new e.OlP("CdkDragHandle");let Xt=(()=>{class o{get disabled(){return this._disabled}set disabled(t){this._disabled=M(t),this._stateChanges.next(this)}constructor(t,n){this.element=t,this._stateChanges=new L.x,this._disabled=!1,this._parentDrag=n}ngOnDestroy(){this._stateChanges.complete()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.SBq),e.Y36(gt,12))},o.\u0275dir=e.lG2({type:o,selectors:[["","cdkDragHandle",""]],hostAttrs:[1,"cdk-drag-handle"],inputs:{disabled:["cdkDragHandleDisabled","disabled"]},standalone:!0,features:[e._Bn([{provide:Tt,useExisting:o}])]}),o})();const Qt=new e.OlP("CdkDragPlaceholder"),en=new e.OlP("CdkDragPreview");let tn=(()=>{class o{get matchSize(){return this._matchSize}set matchSize(t){this._matchSize=M(t)}constructor(t){this.templateRef=t,this._matchSize=!1}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.Rgc))},o.\u0275dir=e.lG2({type:o,selectors:[["ng-template","cdkDragPreview",""]],inputs:{data:"data",matchSize:"matchSize"},standalone:!0,features:[e._Bn([{provide:en,useExisting:o}])]}),o})(),nn=(()=>{class o{get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(t){this._disabled=M(t),this._dragRef.disabled=this._disabled}constructor(t,n,r,l,f,S,E,b,V,G,ge){this.element=t,this.dropContainer=n,this._ngZone=l,this._viewContainerRef=f,this._dir=E,this._changeDetectorRef=V,this._selfHandle=G,this._parentDrag=ge,this._destroyed=new L.x,this.started=new e.vpe,this.released=new e.vpe,this.ended=new e.vpe,this.entered=new e.vpe,this.exited=new e.vpe,this.dropped=new e.vpe,this.moved=new q.y(Se=>{const ue=this._dragRef.moved.pipe((0,Ln.U)(Ie=>({source:this,pointerPosition:Ie.pointerPosition,event:Ie.event,delta:Ie.delta,distance:Ie.distance}))).subscribe(Se);return()=>{ue.unsubscribe()}}),this._dragRef=b.createDrag(t,{dragStartThreshold:S&&null!=S.dragStartThreshold?S.dragStartThreshold:5,pointerDirectionChangeThreshold:S&&null!=S.pointerDirectionChangeThreshold?S.pointerDirectionChangeThreshold:5,zIndex:S?.zIndex}),this._dragRef.data=this,o._dragInstances.push(this),S&&this._assignDefaults(S),n&&(this._dragRef._withDropContainer(n._dropListRef),n.addItem(this)),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(t){this._dragRef.setFreeDragPosition(t)}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe((0,bt.q)(1),(0,Ve.R)(this._destroyed)).subscribe(()=>{this._updateRootElement(),this._setupHandlesListener(),this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)})})}ngOnChanges(t){const n=t.rootElementSelector,r=t.freeDragPosition;n&&!n.firstChange&&this._updateRootElement(),r&&!r.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this);const t=o._dragInstances.indexOf(this);t>-1&&o._dragInstances.splice(t,1),this._ngZone.runOutsideAngular(()=>{this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_updateRootElement(){const t=this.element.nativeElement;let n=t;this.rootElementSelector&&(n=void 0!==t.closest?t.closest(this.rootElementSelector):t.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(n||t)}_getBoundaryElement(){const t=this.boundaryElement;return t?"string"==typeof t?this.element.nativeElement.closest(t):U(t):null}_syncInputs(t){t.beforeStarted.subscribe(()=>{if(!t.isDragging()){const n=this._dir,r=this.dragStartDelay,l=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,f=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.dragStartDelay="object"==typeof r&&r?r:F(r),t.constrainPosition=this.constrainPosition,t.previewClass=this.previewClass,t.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(l).withPreviewTemplate(f).withPreviewContainer(this.previewContainer||"global"),n&&t.withDirection(n.value)}}),t.beforeStarted.pipe((0,bt.q)(1)).subscribe(()=>{if(this._parentDrag)return void t.withParent(this._parentDrag._dragRef);let n=this.element.nativeElement.parentElement;for(;n;){if(n.classList.contains("cdk-drag")){t.withParent(o._dragInstances.find(r=>r.element.nativeElement===n)?._dragRef||null);break}n=n.parentElement}})}_handleEvents(t){t.started.subscribe(n=>{this.started.emit({source:this,event:n.event}),this._changeDetectorRef.markForCheck()}),t.released.subscribe(n=>{this.released.emit({source:this,event:n.event})}),t.ended.subscribe(n=>{this.ended.emit({source:this,distance:n.distance,dropPoint:n.dropPoint,event:n.event}),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(n=>{this.entered.emit({container:n.container.data,item:this,currentIndex:n.currentIndex})}),t.exited.subscribe(n=>{this.exited.emit({container:n.container.data,item:this})}),t.dropped.subscribe(n=>{this.dropped.emit({previousIndex:n.previousIndex,currentIndex:n.currentIndex,previousContainer:n.previousContainer.data,container:n.container.data,isPointerOverContainer:n.isPointerOverContainer,item:this,distance:n.distance,dropPoint:n.dropPoint,event:n.event})})}_assignDefaults(t){const{lockAxis:n,dragStartDelay:r,constrainPosition:l,previewClass:f,boundaryElement:S,draggingDisabled:E,rootElementSelector:b,previewContainer:V}=t;this.disabled=E??!1,this.dragStartDelay=r||0,n&&(this.lockAxis=n),l&&(this.constrainPosition=l),f&&(this.previewClass=f),S&&(this.boundaryElement=S),b&&(this.rootElementSelector=b),V&&(this.previewContainer=V)}_setupHandlesListener(){this._handles.changes.pipe((0,ct.O)(this._handles),(0,Un.b)(t=>{const n=t.filter(r=>r._parentDrag===this).map(r=>r.element);this._selfHandle&&this.rootElementSelector&&n.push(this.element),this._dragRef.withHandles(n)}),(0,Zn.w)(t=>(0,lt.T)(...t.map(n=>n._stateChanges.pipe((0,ct.O)(n))))),(0,Ve.R)(this._destroyed)).subscribe(t=>{const n=this._dragRef,r=t.element.nativeElement;t.disabled?n.disableHandle(r):n.enableHandle(r)})}}return o._dragInstances=[],o.\u0275fac=function(t){return new(t||o)(e.Y36(e.SBq),e.Y36(Wt,12),e.Y36(O.K0),e.Y36(e.R0b),e.Y36(e.s_b),e.Y36(qt,8),e.Y36(xt,8),e.Y36(pt),e.Y36(e.sBO),e.Y36(Tt,10),e.Y36(gt,12))},o.\u0275dir=e.lG2({type:o,selectors:[["","cdkDrag",""]],contentQueries:function(t,n,r){if(1&t&&(e.Suo(r,en,5),e.Suo(r,Qt,5),e.Suo(r,Tt,5)),2&t){let l;e.iGM(l=e.CRH())&&(n._previewTemplate=l.first),e.iGM(l=e.CRH())&&(n._placeholderTemplate=l.first),e.iGM(l=e.CRH())&&(n._handles=l)}},hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(t,n){2&t&&e.ekj("cdk-drag-disabled",n.disabled)("cdk-drag-dragging",n._dragRef.isDragging())},inputs:{data:["cdkDragData","data"],lockAxis:["cdkDragLockAxis","lockAxis"],rootElementSelector:["cdkDragRootElement","rootElementSelector"],boundaryElement:["cdkDragBoundary","boundaryElement"],dragStartDelay:["cdkDragStartDelay","dragStartDelay"],freeDragPosition:["cdkDragFreeDragPosition","freeDragPosition"],disabled:["cdkDragDisabled","disabled"],constrainPosition:["cdkDragConstrainPosition","constrainPosition"],previewClass:["cdkDragPreviewClass","previewClass"],previewContainer:["cdkDragPreviewContainer","previewContainer"]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],standalone:!0,features:[e._Bn([{provide:gt,useExisting:o}]),e.TTD]}),o})(),ii=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[pt],imports:[Cn]}),o})();var ae=R(433),Ae=R(9453),ri=R(5398),j=R(6993);class St{static#e=this.map={1:{moduleId:j.j.module_gen_prod_energycells_01.id},2:{moduleId:j.j.module_gen_prod_water_01.id},3:{moduleId:j.j.module_arg_prod_meat_01.id},4:{moduleId:j.j.module_par_prod_majasnails_01.id},5:{moduleId:j.j.module_gen_prod_spices_01.id},6:{moduleId:j.j.module_arg_prod_wheat_01.id},7:{moduleId:j.j.module_par_prod_sojabeans_01.id},8:{moduleId:j.j.module_tel_prod_sunriseflowers_01.id},9:{moduleId:j.j.module_tel_prod_swampplant_01.id},10:{moduleId:j.j.module_arg_prod_medicalsupplies_01.id},11:{moduleId:j.j.module_tel_prod_medicalsupplies_01.id},12:{moduleId:j.j.module_par_prod_medicalsupplies_01.id},13:{moduleId:j.j.module_arg_prod_foodrations_01.id},14:{moduleId:j.j.module_par_prod_sojahusk_01.id},15:{moduleId:j.j.module_tel_prod_nostropoil_01.id},16:{moduleId:j.j.module_arg_prod_spacefuel_01.id},17:{moduleId:j.j.module_tel_prod_spaceweed_01.id},18:{moduleId:j.j.module_par_prod_majadust_01.id},19:{moduleId:j.j.module_gen_prod_refinedmetals_01.id},20:{moduleId:j.j.module_gen_prod_siliconwafers_01.id},21:{moduleId:j.j.module_gen_prod_antimattercells_01.id},22:{moduleId:j.j.module_gen_prod_graphene_01.id},23:{moduleId:j.j.module_gen_prod_superfluidcoolant_01.id},24:{moduleId:j.j.module_gen_prod_microchips_01.id},25:{moduleId:j.j.module_gen_prod_scanningarrays_01.id},26:{moduleId:j.j.module_gen_prod_hullparts_01},27:{moduleId:j.j.module_gen_prod_advancedcomposites_01.id},28:{moduleId:j.j.module_gen_prod_engineparts_01.id},29:{moduleId:j.j.module_gen_prod_plasmaconductors_01.id},30:{moduleId:j.j.module_gen_prod_quantumtubes_01.id},31:{moduleId:j.j.module_gen_prod_advancedelectronics_01.id},32:{moduleId:j.j.module_gen_prod_antimatterconverters_01.id},33:{moduleId:j.j.module_gen_prod_claytronics_01.id},34:{moduleId:j.j.module_gen_prod_dronecomponents_01.id},35:{moduleId:j.j.module_gen_prod_missilecomponents_01.id},36:{moduleId:j.j.module_gen_prod_shieldcomponents_01.id},37:{moduleId:j.j.module_gen_prod_turretcomponents_01.id},38:{moduleId:j.j.module_gen_prod_weaponcomponents_01.id},39:{moduleId:j.j.module_gen_prod_smartchips_01.id},40:{moduleId:j.j.module_gen_prod_fieldcoils_01.id}};getLayouts(i){return i.map(n=>({name:n.name,config:n.config.map(r=>({moduleId:St.map[r.moduleId].moduleId,count:r.count}))}))}getSaveData(i){return null}}class oi{constructor(i){this.moduleService=i}findModule(i,t){return this.moduleService.getModuleByWare(i,t)}getLayouts(i){const t=i.layouts;return t?t.map(n=>({name:n.name,config:n.config.map(r=>{const l=this.findModule(r.moduleId,r.productionId);return{count:r.count,moduleId:l?l.id:null}}).filter(r=>null!=r.moduleId)})):[]}getSaveData(i){return{layouts:i}}}class si{getLayouts(i){return i.layouts}getSaveData(i){return{layouts:i}}}var ai=R(2323),je=R(9746),li=R(633);let Ke=(()=>{class o{static#e=this.version=2;static#t=this.storageKey="layouts";getCurrentService(){return this.services[o.version]}constructor(t,n,r){this.storageService=t,this.moduleService=n,this.analytics=r,this.services=[new St,new oi(n),new si]}getLayouts(){const t=this.storageService.get(o.storageKey)||{version:o.version};return this.services[t.version||0].getLayouts(t)||[]}getLayout(t){return this.analytics.event({label:t,category:"Layouts",action:"Load Layout"}),this.getLayouts().find(n=>n.name===t)}saveLayout(t){const n=this.getLayouts(),r=n.findIndex(l=>l.name.toLowerCase()===t.name.toLowerCase());r>=0?n[r]=t:n.push(t),this.analytics.event({label:t.name,category:"Layouts",action:"Save Layout"}),this.saveLayoutsInternal(n)}deleteLayout(t){this.analytics.event({label:t,category:"Layouts",action:"Delete Layout"});const n=this.getLayouts(),r=n.findIndex(l=>l.name.toLowerCase()===t.toLowerCase());r>=0&&n.splice(r,1),this.saveLayoutsInternal(n)}saveLayoutsInternal(t){const n=this.getCurrentService().getSaveData(t);this.storageService.add(o.storageKey,{...n,version:o.version})}static#n=this.\u0275fac=function(n){return new(n||o)(e.LFG(ai.V),e.LFG(je.C),e.LFG(li.y))};static#i=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac})}return o})();var Ct=R(2655),rn=R(7234),it=R(3273);let on=(()=>{class o{static#e=this.primary="primary";static#t=this.secondary="secondary";static#n=this.success="success";static#i=this.danger="danger";static#r=this.warning="warning";static#o=this.info="info"}return o})(),sn=(()=>{class o{constructor(t){this.activeModal=t}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(Ae.Kz))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["ng-component"]],inputs:{title:"title",message:"message"},decls:13,vars:2,consts:function(){let t,n;return t=$localize`:@@yes:Yes`,n=$localize`:@@no:No`,[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[3,"innerHTML"],[1,"modal-footer"],["type","button",1,"btn","btn-primary",3,"click"],t,n]},template:function(n,r){1&n&&(e.TgZ(0,"div",0)(1,"h4",1),e._uU(2),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return r.activeModal.dismiss()}),e.TgZ(4,"span",3),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",4),e._UZ(7,"p",5),e.qZA(),e.TgZ(8,"div",6)(9,"button",7),e.NdJ("click",function(){return r.activeModal.close(!0)}),e.SDv(10,8),e.qZA(),e.TgZ(11,"button",7),e.NdJ("click",function(){return r.activeModal.close(!1)}),e.SDv(12,9),e.qZA()()),2&n&&(e.xp6(2),e.Oqu(r.title),e.xp6(5),e.Q6J("innerHTML",r.message,e.oJD))},encapsulation:2})}return o})();function ci(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"a",11),e.NdJ("click",function(r){const f=e.CHM(t).$implicit,S=e.oxw();return e.KtG(S.loadLayout(r,f))}),e.TgZ(1,"div")(2,"strong"),e._uU(3),e.qZA(),e.TgZ(4,"div",12)(5,"a",13),e.NdJ("click",function(r){const f=e.CHM(t).$implicit,S=e.oxw();return e.KtG(S.loadLayout(r,f))}),e.SDv(6,14),e.qZA(),e._uU(7," | "),e.TgZ(8,"a",15),e.NdJ("click",function(r){const f=e.CHM(t).$implicit,S=e.oxw();return e.KtG(S.addLayout(r,f))}),e.SDv(9,16),e.qZA(),e._uU(10," | "),e.TgZ(11,"a",17),e.NdJ("click",function(r){const f=e.CHM(t).$implicit,S=e.oxw();return e.KtG(S.deleteLayout(r,f))}),e.SDv(12,18),e.qZA()()(),e.TgZ(13,"div",19),e._uU(14),e.qZA()()}if(2&o){const t=i.$implicit,n=e.oxw();e.xp6(3),e.Oqu(t.name),e.xp6(11),e.hij(" ",n.getModules(t)," ")}}var Pe=(()=>{return(o=Pe||(Pe={}))[o.load=0]="load",o[o.add=1]="add",Pe;var o})();let ui=(()=>{class o extends it.V{constructor(t,n,r,l){super(),this.activeModal=t,this.modal=n,this.layoutService=r,this.moduleService=l}ngOnInit(){this.entities=this.layoutService.getLayouts().map(t=>({name:t.name,modules:t.config.map(n=>({count:n.count,module:this.moduleService.getEntity(n.moduleId)}))}))}getModules(t){let n=!1,r=t.modules;return r.length>3&&(r=r.slice(0,3),n=!0),r.map(l=>l.count+" x "+(null==l.module?"":l.module.name)).join(", ")+(n?"...":"")}loadLayout(t,n){t.preventDefault(),t.stopPropagation(),this.activeModal.close({layoutName:n.name,type:Pe.load})}addLayout(t,n){t.preventDefault(),t.stopPropagation(),this.activeModal.close({layoutName:n.name,type:Pe.add})}deleteLayout(t,n){t.preventDefault(),t.stopPropagation();const r=this.modal.open(sn);r.componentInstance.title="Confirm Delete",r.componentInstance.message=`Are you sure you want to delete <strong>${n.name}</strong>?`,r.result.then(l=>{l&&(this.layoutService.deleteLayout(n.name),this.ngOnInit())})}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(Ae.Kz),e.Y36(Ae.FF),e.Y36(Ke),e.Y36(je.C))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["ng-component"]],features:[e.qOj],decls:12,vars:1,consts:function(){let t,n,r,l,f;return t=$localize`:@@loadLayout:Load Layout`,n=$localize`:@@cancel:Cancel`,r=$localize`:@@load:Load Layout`,l=$localize`:@@load:Add Modules`,f=$localize`:@@delete:Delete Layout`,[[1,"modal-header"],[1,"modal-title"],t,["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"list-group"],["class","list-group-item list-group-item-action",3,"click",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],n,[1,"list-group-item","list-group-item-action",3,"click"],[1,"float-right","small"],[1,"hover","text-primary",3,"click"],r,[1,"hover","text-secondary",3,"click"],l,[1,"hover","text-danger",3,"click"],f,[1,"small"]]},template:function(n,r){1&n&&(e.TgZ(0,"div",0)(1,"h4",1),e.SDv(2,2),e.qZA(),e.TgZ(3,"button",3),e.NdJ("click",function(){return r.activeModal.close()}),e.TgZ(4,"span",4),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",5)(7,"div",6),e.YNc(8,ci,15,2,"a",7),e.qZA()(),e.TgZ(9,"div",8)(10,"button",9),e.NdJ("click",function(){return r.activeModal.close()}),e.SDv(11,10),e.qZA()()),2&n&&(e.xp6(8),e.Q6J("ngForOf",r.entities))},dependencies:[O.sg],encapsulation:2})}return o})(),di=(()=>{class o{constructor(t,n,r){this.activeModal=t,this.modal=n,this.layoutService=r}canSave(){return this.name}saveLayout(){if(this.layoutService.getLayout(this.name)){const n=this.modal.open(sn);n.componentInstance.title="Confirm Save",n.componentInstance.message=`<strong>${this.name}</strong> already exists. Confirm overwrite?`,n.result.then(r=>{r&&this.activeModal.close(this.name)})}else this.activeModal.close(this.name)}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(Ae.Kz),e.Y36(Ae.FF),e.Y36(Ke))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["ng-component"]],decls:14,vars:2,consts:function(){let t,n,r;return t=$localize`:@@saveLayout:Save Layout`,n=$localize`:@@save:Save`,r=$localize`:@@cancel:Cancel`,[[1,"modal-header"],[1,"modal-title"],t,["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"form-group"],[1,"form-control",3,"ngModel","ngModelChange"],[1,"modal-footer"],["type","button",1,"btn","btn-success",3,"disabled","click"],n,["type","button",1,"btn","btn-secondary",3,"click"],r]},template:function(n,r){1&n&&(e.TgZ(0,"div",0)(1,"h4",1),e.SDv(2,2),e.qZA(),e.TgZ(3,"button",3),e.NdJ("click",function(){return r.activeModal.close()}),e.TgZ(4,"span",4),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",5)(7,"div",6)(8,"input",7),e.NdJ("ngModelChange",function(f){return r.name=f}),e.qZA()()(),e.TgZ(9,"div",8)(10,"button",9),e.NdJ("click",function(){return r.saveLayout()}),e.SDv(11,10),e.qZA(),e.TgZ(12,"button",11),e.NdJ("click",function(){return r.activeModal.close()}),e.SDv(13,12),e.qZA()()),2&n&&(e.xp6(8),e.Q6J("ngModel",r.name),e.xp6(2),e.Q6J("disabled",!r.canSave()))},dependencies:[ae.Fj,ae.JJ,ae.On],encapsulation:2})}return o})(),_i=(()=>{class o{constructor(t){this.activeModal=t}copy(t){t.select(),document.execCommand("copy")}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(Ae.Kz))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-share-layout"]],inputs:{url:"url"},decls:16,vars:1,consts:function(){let t,n,r;return t=$localize`:@@shareLayout:Share Layout`,n=$localize`:@@copy:Copy`,r=$localize`:@@ok:Ok`,[[1,"modal-header"],[1,"modal-title"],t,["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"input-group"],["readonly","",1,"form-control",3,"value"],["urlInput",""],[1,"input-group-append"],["type","button",1,"btn","btn-sm","btn-outline-secondary",3,"click"],n,[1,"modal-footer"],["type","button",1,"btn","btn-success",3,"click"],r]},template:function(n,r){if(1&n){const l=e.EpF();e.TgZ(0,"div",0)(1,"h4",1),e.SDv(2,2),e.qZA(),e.TgZ(3,"button",3),e.NdJ("click",function(){return r.activeModal.dismiss()}),e.TgZ(4,"span",4),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",5)(7,"div",6),e._UZ(8,"input",7,8),e.TgZ(10,"div",9)(11,"button",10),e.NdJ("click",function(){e.CHM(l);const S=e.MAs(9);return e.KtG(r.copy(S))}),e.SDv(12,11),e.qZA()()()(),e.TgZ(13,"div",12)(14,"button",13),e.NdJ("click",function(){return r.activeModal.close()}),e.SDv(15,14),e.qZA()()}2&n&&(e.xp6(8),e.Q6J("value",r.url))},encapsulation:2})}return o})();var Ne=R(973);let yt=(()=>{class o{static#e=this.default="default";static#t=this.argon="argon";static#n=this.teladi="teladi";static#i=this.paranid="paranid";static#r=this.recycling="recycling"}return o})();var Le=R(4941),ye=R(7946);const vt={argon:{race:Le.I.argon,amount:200,consumption:[{ware:ye.H.foodrations,amount:450},{ware:ye.H.medicalsupplies,amount:270}]},teladi:{race:Le.I.teladi,amount:200,consumption:[{ware:ye.H.nostropoil,amount:228},{ware:ye.H.medicalsupplies,amount:270}]},paranid:{race:Le.I.paranid,amount:200,consumption:[{ware:ye.H.sojahusk,amount:288},{ware:ye.H.medicalsupplies,amount:270}]},split:{race:Le.I.split,amount:200,consumption:[{ware:ye.H.cheltmeat,amount:102},{ware:ye.H.scruffinfruits,amount:138},{ware:ye.H.medicalsupplies,amount:270}]},terran:{race:Le.I.terran,amount:200,consumption:[{ware:ye.H.terranmre,amount:258},{ware:ye.H.medicalsupplies,amount:270}]},boron:{race:Le.I.boron,amount:200,consumption:[{ware:ye.H.bofu,amount:90},{ware:ye.H.medicalsupplies,amount:198},{ware:ye.H.water,amount:162}]},get:o=>vt[o]||vt.argon};var hi=R(5730);const an=["module_gen_prod_scrap_recycler","module_ter_prod_scrap_recycler"];class qe{constructor(i,t,n="",r=1){this.wareService=i,this.moduleService=t,this.moduleId=n,this.count=r}get moduleId(){return this._moduleId}set moduleId(i){i!=this._moduleId&&(this._moduleId=i,this.update())}get count(){return this._count}set count(i){i!=this._count&&(this._count=i,this.update())}update(){if(this._moduleId){if(this.module=this.moduleService.getEntity(this.moduleId),this.needs=[],this.production=[],this.module.type==Ne.J.production){const i=this.module.product;for(let t of i){let n=null;an.includes(this.module.id)&&(n=t.production.find(l=>l.method==yt.recycling)),null==n&&(n=null==this.module.makerRace?t.production.find(l=>l.method==yt.default):t.production.find(l=>l.method==this.module.makerRace.id)||t.production.find(l=>l.method==yt.default));const r=3600/n.time;this.production.push({amount:n.amount*r,ware:t,value:n}),n.wares.forEach(l=>{const f=this.wareService.getEntity(l.ware);this.needs.push({amount:l.amount*r,ware:f})})}}else if(this.module.type==Ne.J.habitation){const i=this.module.workForce.capacity,t=vt.get(this.module.workForce.race.id);t.consumption.forEach(n=>{this.needs.push({amount:n.amount*i/t.amount,ware:n.ware})})}}else this.module=null,this.production=null,this.needs=[]}}class Et{static calculateWorkforce(i){return{value:i.reduce((r,l)=>l.module&&l.module.workForce&&l.module.workForce.max?r+l.count*l.module.workForce.max:r,0),capacity:i.reduce((r,l)=>l.module&&l.module.workForce&&l.module.workForce.capacity?r+l.count*l.module.workForce.capacity:r,0)}}static calculate(i,t,n){let r=this.calculateWorkforce(i),l=0==r.capacity||0==r.value?0:n/r.value;l>1&&(l=1);let f={};i.length>0&&(f=i.map(E=>{let b=1;if("Habitation"===E.module?.type){let G=E.module.workForce.capacity*E.count;n>=G?n-=G:(b=n/G,n=0)}const V=E.needs.map(G=>({ware:G.ware,count:E.count,amount:-G.amount,efficiency:100*b,name:E.module.name,total:E.count*-G.amount*b,type:E.module.type}));if(E.production)for(let G of E.production){const ge=G.value.effects?G.value.effects.find(ue=>ue.type==hi.z.work):null;let Se=null==ge?1:1+ge.product*l;if(G.ware.id===ye.H.energycells.id){let ue=parseInt(t);(isNaN(ue)||ue<0)&&(ue=100),Se=Se*ue/100}V.push({ware:G.ware,count:E.count,amount:G.amount,efficiency:100*Se,name:E.module.name,total:E.count*G.amount*Se,type:E.module.type})}return V}).reduce((E,b)=>E.concat(b)).reduce(function(E,b){return E[b.ware.id]=E[b.ware.id]||[],E[b.ware.id].push(b),E},{}));const S=[];for(const E in f)if(f.hasOwnProperty(E)){const b=f[E];let V=0;b.forEach(G=>{V+=G.total}),S.push({ware:b[0].ware,amount:V,items:b})}return S}}var At=R(1667),Ue=(()=>{return(o=Ue||(Ue={}))[o.expense=0]="expense",o[o.product=1]="product",Ue;var o})();class fi{constructor(i,t,n,r,l){this.item=i,this.component=t,this.minPrice=n,this.maxPrice=r,this.items=l}get module(){return this.item.module}get count(){return this.item.count}get price(){return this.item.count*(this.minPrice+(this.maxPrice-this.minPrice)*this.component.modulesResourcesPrice/100)}}class pi{constructor(i,t,n){this.ware=i,this.amount=t,this.component=n}get price(){return this.amount*(this.ware.price.min+(this.ware.price.max-this.ware.price.min)*this.component.modulesResourcesPrice/100)}}class ln{constructor(i,t,n,r=null){this.model=i,this.pricePercentage=t,this.priceType=n,this.warePrice=r}get name(){return this.model.ware.name}get amount(){return this.model.amount}get price(){return null!=this.warePrice?0:this.model.ware.price.min+(this.model.ware.price.max-this.model.ware.price.min)*(this.priceType==Ue.expense?this.pricePercentage.resourcesPrice:this.pricePercentage.productsPrice)/100}}var rt=R(2459);let Nt=(()=>{class o{constructor(){this.partialWorkforceChanged=new L.x,this.partialWorkforce=0}setPartialWorkforce(t){this.partialWorkforce=t,this.partialWorkforceChanged.next(this.partialWorkforce)}get $partialWorkforce(){return this.partialWorkforce}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();function gi(o,i){1&o&&e._UZ(0,"i",55)}function mi(o,i){1&o&&e._UZ(0,"i",56)}function Ti(o,i){if(1&o&&(e.TgZ(0,"tr",59)(1,"td",60),e._uU(2),e.qZA(),e.TgZ(3,"td",10),e._uU(4),e.ALo(5,"number"),e.qZA()()),2&o){const t=i.$implicit;e.xp6(2),e.AsE("",t.count," x ",t.name,""),e.xp6(2),e.hij("-",e.xi3(5,3,t.amount*t.count,"1.0-0"),"")}}function Si(o,i){1&o&&(e.TgZ(0,"tr",59)(1,"td",60),e._uU(2," 1 x Unknown Module "),e.qZA(),e.TgZ(3,"td",10),e._uU(4,"-200"),e.qZA()())}function Ci(o,i){if(1&o&&(e.ynx(0),e.YNc(1,Ti,6,6,"tr",57),e.YNc(2,Si,5,0,"tr",58),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.workforceNeeded),e.xp6(1),e.Q6J("ngIf",t.isHq)}}function yi(o,i){1&o&&e._UZ(0,"i",55)}function vi(o,i){1&o&&e._UZ(0,"i",56)}function Ei(o,i){if(1&o&&(e.TgZ(0,"tr",31)(1,"td",60),e._uU(2),e.qZA(),e.TgZ(3,"td",10),e._uU(4),e.ALo(5,"number"),e.qZA()()),2&o){const t=i.$implicit;e.xp6(2),e.AsE("",t.count," x ",t.name,""),e.xp6(2),e.hij("+",e.xi3(5,3,t.amount*t.count,"1.0-0"),"")}}function Ai(o,i){if(1&o&&(e.ynx(0),e.YNc(1,Ei,6,6,"tr",61),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.workforceCapacity)}}function Ni(o,i){1&o&&e._UZ(0,"i",55)}function Mi(o,i){1&o&&e._UZ(0,"i",56)}const Oi=function(o,i){return{"text-danger":o,"text-warning":i}};function Ii(o,i){if(1&o&&(e.TgZ(0,"tr",8)(1,"td",63),e._uU(2),e.ALo(3,"number"),e.qZA(),e.TgZ(4,"td",10),e._uU(5),e.ALo(6,"number"),e.qZA()()),2&o){const t=i.$implicit;e.Q6J("ngClass",e.WLB(10,Oi,t.price>0,0==t.price)),e.xp6(2),e.AsE("",e.xi3(3,4,t.amount,"1.0-0")," x ",t.name,""),e.xp6(3),e.hij(" ",e.xi3(6,7,t.amount*t.price,"1.0-0")," ")}}function wi(o,i){if(1&o&&(e.ynx(0),e.YNc(1,Ii,7,13,"tr",62),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.resourcesNeeded)}}function bi(o,i){1&o&&e._UZ(0,"i",55)}function xi(o,i){1&o&&e._UZ(0,"i",56)}function Ri(o,i){if(1&o&&(e.TgZ(0,"tr",65)(1,"td",63),e._uU(2),e.ALo(3,"number"),e.qZA(),e.TgZ(4,"td",10),e._uU(5),e.ALo(6,"number"),e.qZA()()),2&o){const t=i.$implicit;e.xp6(2),e.AsE("",e.xi3(3,3,t.amount,"1.0-0")," x ",t.name,""),e.xp6(3),e.hij("+",e.xi3(6,6,t.amount*t.price,"1.0-0"),"")}}function Pi(o,i){if(1&o&&(e.ynx(0),e.YNc(1,Ri,7,9,"tr",64),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.resourcesProduced)}}function Di(o,i){1&o&&(e.ynx(0),e.TgZ(1,"span"),e.SDv(2,66),e.qZA(),e.BQk())}function ki(o,i){1&o&&(e.ynx(0),e.TgZ(1,"span"),e.SDv(2,67),e.qZA(),e.BQk())}function Fi(o,i){1&o&&(e.ynx(0),e.TgZ(1,"span"),e.SDv(2,68),e.qZA(),e.BQk())}function Li(o,i){if(1&o&&(e.ynx(0),e._uU(1),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.hij("",t.resourcesPrice,"%")}}function Ui(o,i){1&o&&(e.ynx(0),e.TgZ(1,"span"),e.SDv(2,69),e.qZA(),e.BQk())}function Zi(o,i){1&o&&(e.ynx(0),e.TgZ(1,"span"),e.SDv(2,70),e.qZA(),e.BQk())}function Bi(o,i){1&o&&(e.ynx(0),e.TgZ(1,"span"),e.SDv(2,71),e.qZA(),e.BQk())}function $i(o,i){if(1&o&&(e.ynx(0),e._uU(1),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.hij("",t.productsPrice,"%")}}function Yi(o,i){1&o&&e._UZ(0,"i",55)}function Vi(o,i){1&o&&e._UZ(0,"i",56)}function Gi(o,i){if(1&o&&(e.TgZ(0,"tr")(1,"td",63),e._uU(2),e.qZA(),e.TgZ(3,"td",10),e._uU(4),e.ALo(5,"number"),e.qZA()()),2&o){const t=i.$implicit,n=e.oxw(2).$implicit;e.xp6(2),e.AsE("",n.count*t.amount," x ",t.ware.name,""),e.xp6(2),e.hij(" ",e.xi3(5,3,n.count*t.price,"1.0-0")," ")}}function zi(o,i){if(1&o&&(e.ynx(0),e.YNc(1,Gi,6,6,"tr",50),e.BQk()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.items)}}function Hi(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",5),e.NdJ("click",function(){const l=e.CHM(t).$implicit,f=e.oxw();return e.KtG(f.toggleExpanded(l.module.id))}),e.TgZ(2,"td"),e.YNc(3,Yi,1,0,"i",6),e.YNc(4,Vi,1,0,"i",7),e._uU(5),e.qZA(),e.TgZ(6,"td",10),e._uU(7),e.ALo(8,"number"),e.qZA()(),e.YNc(9,zi,2,1,"ng-container",11),e.BQk()}if(2&o){const t=i.$implicit,n=e.oxw();e.xp6(3),e.Q6J("ngIf",!n.expandState[t.module.id]),e.xp6(1),e.Q6J("ngIf",n.expandState[t.module.id]),e.xp6(1),e.AsE(" ",t.count," x ",t.module.name," "),e.xp6(2),e.hij(" ",e.xi3(8,6,t.price,"1.0-0")," "),e.xp6(2),e.Q6J("ngIf",n.expandState[t.module.id])}}function ji(o,i){if(1&o&&(e.TgZ(0,"tr")(1,"td",10),e._uU(2),e.qZA(),e.TgZ(3,"td",10),e._uU(4),e.ALo(5,"number"),e.qZA()()),2&o){const t=i.$implicit;e.xp6(2),e.Oqu(t.ware.name),e.xp6(2),e.Oqu(e.xi3(5,2,t.value,"1.0-0"))}}function Ki(o,i){1&o&&(e.ynx(0),e.TgZ(1,"span"),e.SDv(2,72),e.qZA(),e.BQk())}function qi(o,i){1&o&&(e.ynx(0),e.TgZ(1,"span"),e.SDv(2,73),e.qZA(),e.BQk())}function Wi(o,i){1&o&&(e.ynx(0),e.TgZ(1,"span"),e.SDv(2,74),e.qZA(),e.BQk())}function Ji(o,i){if(1&o&&(e.ynx(0),e._uU(1),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.hij("",t.modulesResourcesPrice,"%")}}const cn=function(o,i){return{"text-danger":o,"text-success":i}};class Ze{static#e=this.basicResources=[At.B.gases,At.B.minerals,At.B.ice];constructor(i,t){this.wareService=i,this.stationSummaryService=t,this.expandState={},this.provideBasicResources=!1,this.provideAllResources=!1,this.isHq=!1,this.resourcesPrice=50,this.productsPrice=50,this.modulesResourcesPrice=50,this._totalWorkforce=0,this.totalWorkforceCapacity=0,this.partialWorkforce=0,this.workforceNeeded=[],this.workforceCapacity=[],this.resourcesNeeded=[],this.resourcesProduced=[],this.totalModuleResourceCosts=[],this.change=new e.vpe,this.sunlight=100}ngOnChanges(){this.update()}get totalWorkforce(){return this._totalWorkforce+(this.isHq?200:0)}onChange(){this.update(),this.change.emit()}update(){if(this._totalWorkforce=0,this.workforceNeeded=[],this.workforceCapacity=[],this.resourcesNeeded=[],this.resourcesProduced=[],this.moduleCosts=[],null==this.modules)return;this.modules.forEach(r=>{if(null!=r.module&&null!=r.module.workForce&&(null!=r.module.workForce.max&&(this._totalWorkforce+=r.count*r.module.workForce.max,this.workforceNeeded.push({amount:r.module.workForce.max,name:r.module.name,count:r.count})),null!=r.module.workForce.capacity&&this.workforceCapacity.push({amount:r.module.workForce.capacity,name:r.module.name,count:r.count})),null!=r.module){const l=this.getModuleCost(r);null!=l&&this.moduleCosts.push(l)}});const i=this.modules.reduce((r,l)=>l.module&&l.module.workForce&&l.module.workForce.capacity?r+l.count*l.module.workForce.capacity:r,0),t=this.modules.reduce((r,l)=>l.module&&l.module.workForce&&l.module.workForce.max?r+l.count*l.module.workForce.max:r,0);this.totalWorkforceCapacity!=i&&(this.totalWorkforceCapacity=i,this.partialWorkforce=t),this.stationSummaryService.setPartialWorkforce(this.partialWorkforce);const n=Et.calculate(this.modules,this.sunlight,this.partialWorkforce);n.sort((r,l)=>this.wareService.compareWares(r.ware,l.ware)),n.forEach(r=>{if(r.amount<0){let l=null;(this.provideAllResources||this.provideBasicResources&&Ze.basicResources.indexOf(r.ware.group)>=0)&&(l=0);const f=new ln(r,this,Ue.expense,l);this.resourcesNeeded.push(f)}else if(r.amount>0){const l=new ln(r,this,Ue.product);this.resourcesProduced.push(l)}}),this.totalModuleResourceCosts=[],this.moduleCosts.forEach(r=>{r.items.forEach(l=>{let f=this.totalModuleResourceCosts.find(S=>S.ware.id==l.ware.id);null==f?(f={ware:l.ware,value:r.count*l.amount},this.totalModuleResourceCosts.push(f)):f.value+=r.count*l.amount})})}get workforceStep(){return 0===this.totalWorkforceCapacity?1:this.totalWorkforceCapacity/20}get workforcePercent(){return 0===this.totalWorkforceCapacity?"0%":Math.round(100*this.partialWorkforce/this.totalWorkforceCapacity)+"%"}get totalExpenses(){let i=0;return this.resourcesNeeded.forEach(t=>{i+=t.amount*t.price}),i}get totalProfits(){let i=0;return this.resourcesProduced.forEach(t=>{i+=t.amount*t.price}),i}get totalModuleCost(){let i=0;return this.moduleCosts.forEach(t=>{i+=t.price}),i}getModuleCost(i){const t=i.module.production[0];if(!t)return null;let n=0,r=0;const l=[];return t.wares.forEach(f=>{const S=this.wareService.getEntity(f.ware);n+=S.price.min*f.amount,r+=S.price.max*f.amount,l.push(new pi(S,f.amount,this))}),new fi(i,this,n,r,l)}toggleExpanded(i){this.expandState[i]=!this.expandState[i]}static#t=this.\u0275fac=function(t){return new(t||Ze)(e.Y36(rt.l),e.Y36(Nt))};static#n=this.\u0275cmp=e.Xpm({type:Ze,selectors:[["app-station-summary"]],inputs:{modules:"modules",sunlight:"sunlight"},outputs:{change:"change"},features:[e.TTD],decls:157,vars:72,consts:function(){let i,t,n,r,l,f,S,E,b,V,G,ge,Se,ue,Ie,ve,ot,We,Be,Je,un,dn,_n,hn,fn,pn;return i=$localize`:@@workforce:Workforce`,t=$localize`:@@value:Value`,n=$localize`:@@neededWorkforce: Needed Workforce `,r=$localize`:@@workforceCapacity: Workforce Capacity `,l=$localize`:@@isHeadquarters:Headquarters (The HQ needs 200 workers for some reason)`,f=$localize`:@@productionPerHour:Production Per Hour`,S=$localize`:@@amount:Amount`,E=$localize`:@@expenses: Expenses`,b=$localize`:@@production: Production`,V=$localize`:@@profit: Profit`,G=$localize`:@@minersProvideBasicResources:Miners provide basic resources`,ge=$localize`:@@rovideAllResources:Resources are provided by other stations`,Se=$localize`:@@resourcePrice:Resources Price:`,ue=$localize`:@@stationCosts:Station Costs`,Ie=$localize`:@@amount:Amount`,ve=$localize`:@@total:Total:`,ot=$localize`:@@resourcesPrice:Resources Price:`,We=$localize`:@@min:Min`,Be=$localize`:@@average:Average`,Je=$localize`:@@max:Max`,un=$localize`:@@min:Min`,dn=$localize`:@@average:Average`,_n=$localize`:@@max:Max`,hn=$localize`:@@min:Min`,fn=$localize`:@@average:Average`,pn=$localize`:@@max:Max`,[[1,"table","table-sm","small","table-hover"],["scope","col"],i,["scope","col",1,"text-right"],t,[1,"hover",3,"click"],["class","fa fa-angle-double-down",4,"ngIf"],["class","fa fa-angle-double-up",4,"ngIf"],[3,"ngClass"],n,[1,"text-right"],[4,"ngIf"],r,["colspan","2"],[1,"form-check"],["type","checkbox","id","is-hq",1,"form-check-input",3,"ngModel","ngModelChange"],["for","is-hq",1,"form-check-label"],l,[1,"row"],[1,"form-group","col"],["for","workforce-slider"],[1,"d-flex","flex-row"],[1,"flex-grow-1"],["type","range","id","workforce-slider","min","0",1,"form-control-range","small",3,"max","ngModel","ngModelChange"],[1,"ml-1"],f,S,[1,"hover","text-danger",3,"click"],E,[1,"hover","text-primary",3,"click"],b,[1,"text-success"],[1,"fa","fa-line-chart"],V,["type","checkbox","id","basic-resources",1,"form-check-input",3,"ngModel","ngModelChange"],["for","basic-resources",1,"form-check-label"],G,["type","checkbox","id","all-resources",1,"form-check-input",3,"ngModel","ngModelChange"],["for","all-resources",1,"form-check-label"],ge,["for","resources-price"],Se,[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["type","range","id","resources-price","min","0","max","100","step","5",1,"form-control-range","small",3,"ngModel","ngModelChange"],["for","products-price"],["type","range","id","products-price","min","0","max","100","step","5",1,"form-control-range","small",3,"ngModel","ngModelChange"],ue,Ie,[4,"ngFor","ngForOf"],ve,["for","modules-resources-price"],ot,["type","range","id","modules-resources-price","min","0","max","100","step","5",1,"form-control-range","small",3,"ngModel","ngModelChange"],[1,"fa","fa-angle-double-down"],[1,"fa","fa-angle-double-up"],["class","text-danger",4,"ngFor","ngForOf"],["class","text-danger",4,"ngIf"],[1,"text-danger"],[1,"pl-4"],["class","text-success",4,"ngFor","ngForOf"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"pl-5"],["class","text-primary",4,"ngFor","ngForOf"],[1,"text-primary"],We,Be,Je,un,dn,_n,hn,fn,pn]},template:function(t,n){1&t&&(e.TgZ(0,"table",0)(1,"thead")(2,"tr")(3,"th",1),e.SDv(4,2),e.qZA(),e.TgZ(5,"th",3),e.SDv(6,4),e.qZA()()(),e.TgZ(7,"tbody")(8,"tr",5),e.NdJ("click",function(){return n.toggleExpanded("totalWorkforce")}),e.TgZ(9,"td"),e.YNc(10,gi,1,0,"i",6),e.YNc(11,mi,1,0,"i",7),e.TgZ(12,"span",8),e.SDv(13,9),e.qZA()(),e.TgZ(14,"td",10),e._uU(15),e.ALo(16,"number"),e.qZA()(),e.YNc(17,Ci,3,2,"ng-container",11),e.TgZ(18,"tr",5),e.NdJ("click",function(){return n.toggleExpanded("totalWorkforceCapacity")}),e.TgZ(19,"td"),e.YNc(20,yi,1,0,"i",6),e.YNc(21,vi,1,0,"i",7),e.TgZ(22,"span",8),e.SDv(23,12),e.qZA()(),e.TgZ(24,"td",10),e._uU(25),e.ALo(26,"number"),e.qZA()(),e.YNc(27,Ai,2,1,"ng-container",11),e.TgZ(28,"tr")(29,"td",13)(30,"div",14)(31,"input",15),e.NdJ("ngModelChange",function(l){return n.isHq=l})("ngModelChange",function(){return n.onChange()}),e.qZA(),e.TgZ(32,"label",16),e.SDv(33,17),e.qZA()()()(),e.TgZ(34,"tr")(35,"td",13)(36,"div",18)(37,"div",19)(38,"label",20)(39,"span"),e._uU(40,"Actual Workforce:"),e.qZA(),e._uU(41,"\xa0"),e.TgZ(42,"strong"),e._uU(43),e.ALo(44,"number"),e.qZA()(),e.TgZ(45,"div",21)(46,"div",22)(47,"input",23),e.NdJ("ngModelChange",function(l){return n.partialWorkforce=l})("ngModelChange",function(){return n.onChange()}),e.qZA()(),e.TgZ(48,"div",24),e._uU(49),e.qZA()()()()()()()(),e.TgZ(50,"table",0)(51,"thead")(52,"tr")(53,"th",1),e.SDv(54,25),e.qZA(),e.TgZ(55,"th",3),e.SDv(56,26),e.qZA()()(),e.TgZ(57,"tbody")(58,"tr",27),e.NdJ("click",function(){return n.toggleExpanded("totalExpenses")}),e.TgZ(59,"td"),e.YNc(60,Ni,1,0,"i",6),e.YNc(61,Mi,1,0,"i",7),e.TgZ(62,"span"),e.SDv(63,28),e.qZA()(),e.TgZ(64,"td",10),e._uU(65),e.ALo(66,"number"),e.qZA()(),e.YNc(67,wi,2,1,"ng-container",11),e.TgZ(68,"tr",29),e.NdJ("click",function(){return n.toggleExpanded("totalProfits")}),e.TgZ(69,"td"),e.YNc(70,bi,1,0,"i",6),e.YNc(71,xi,1,0,"i",7),e.TgZ(72,"span"),e.SDv(73,30),e.qZA()(),e.TgZ(74,"td",10),e._uU(75),e.ALo(76,"number"),e.qZA()(),e.YNc(77,Pi,2,1,"ng-container",11),e.TgZ(78,"tr",31)(79,"td"),e._UZ(80,"i",32),e.TgZ(81,"strong"),e.SDv(82,33),e.qZA()(),e.TgZ(83,"td",10)(84,"strong"),e._uU(85),e.ALo(86,"number"),e.qZA()()(),e.TgZ(87,"tr")(88,"td",13)(89,"div",14)(90,"input",34),e.NdJ("ngModelChange",function(l){return n.provideBasicResources=l})("ngModelChange",function(){return n.onChange()}),e.qZA(),e.TgZ(91,"label",35),e.SDv(92,36),e.qZA()()()(),e.TgZ(93,"tr")(94,"td",13)(95,"div",14)(96,"input",37),e.NdJ("ngModelChange",function(l){return n.provideAllResources=l})("ngModelChange",function(){return n.onChange()}),e.qZA(),e.TgZ(97,"label",38),e.SDv(98,39),e.qZA()()()(),e.TgZ(99,"tr")(100,"td",13)(101,"div",18)(102,"div",19)(103,"label",40)(104,"span"),e.SDv(105,41),e.qZA(),e._uU(106,"\xa0 "),e.TgZ(107,"strong",42),e.YNc(108,Di,3,0,"ng-container",43),e.YNc(109,ki,3,0,"ng-container",43),e.YNc(110,Fi,3,0,"ng-container",43),e.YNc(111,Li,2,1,"ng-container",44),e.qZA()(),e._UZ(112,"br"),e.TgZ(113,"input",45),e.NdJ("ngModelChange",function(l){return n.resourcesPrice=l})("ngModelChange",function(){return n.onChange()}),e.qZA()(),e.TgZ(114,"div",19)(115,"label",46)(116,"span"),e._uU(117,"Products Price:"),e.qZA(),e._uU(118,"\xa0 "),e.TgZ(119,"strong",42),e.YNc(120,Ui,3,0,"ng-container",43),e.YNc(121,Zi,3,0,"ng-container",43),e.YNc(122,Bi,3,0,"ng-container",43),e.YNc(123,$i,2,1,"ng-container",44),e.qZA()(),e._UZ(124,"br"),e.TgZ(125,"input",47),e.NdJ("ngModelChange",function(l){return n.productsPrice=l})("ngModelChange",function(){return n.onChange()}),e.qZA()()()()()()(),e.TgZ(126,"table",0)(127,"thead")(128,"tr")(129,"th",1),e.SDv(130,48),e.qZA(),e.TgZ(131,"th",3),e.SDv(132,49),e.qZA()()(),e.TgZ(133,"tbody"),e.YNc(134,Hi,10,9,"ng-container",50),e.TgZ(135,"tr")(136,"th",10),e.SDv(137,51),e.qZA(),e.TgZ(138,"th",10),e._uU(139),e.ALo(140,"number"),e.qZA()(),e.YNc(141,ji,6,5,"tr",50),e.TgZ(142,"tr")(143,"td",13)(144,"div",18)(145,"div",19)(146,"label",52)(147,"span"),e.SDv(148,53),e.qZA(),e._uU(149,"\xa0 "),e.TgZ(150,"strong",42),e.YNc(151,Ki,3,0,"ng-container",43),e.YNc(152,qi,3,0,"ng-container",43),e.YNc(153,Wi,3,0,"ng-container",43),e.YNc(154,Ji,2,1,"ng-container",44),e.qZA()(),e._UZ(155,"br"),e.TgZ(156,"input",54),e.NdJ("ngModelChange",function(l){return n.modulesResourcesPrice=l})("ngModelChange",function(){return n.onChange()}),e.qZA()()()()()()()),2&t&&(e.xp6(10),e.Q6J("ngIf",!n.expandState.totalWorkforce),e.xp6(1),e.Q6J("ngIf",n.expandState.totalWorkforce),e.xp6(1),e.Q6J("ngClass",e.WLB(66,cn,n.totalWorkforce>n.totalWorkforceCapacity,n.totalWorkforce<=n.totalWorkforceCapacity)),e.xp6(3),e.Oqu(e.xi3(16,45,n.totalWorkforce,"1.0-0")),e.xp6(2),e.Q6J("ngIf",n.expandState.totalWorkforce),e.xp6(3),e.Q6J("ngIf",!n.expandState.totalWorkforceCapacity),e.xp6(1),e.Q6J("ngIf",n.expandState.totalWorkforceCapacity),e.xp6(1),e.Q6J("ngClass",e.WLB(69,cn,n.totalWorkforce>n.totalWorkforceCapacity,n.totalWorkforce<=n.totalWorkforceCapacity)),e.xp6(3),e.hij(" ",e.xi3(26,48,n.totalWorkforceCapacity,"1.0-0")," "),e.xp6(2),e.Q6J("ngIf",n.expandState.totalWorkforceCapacity),e.xp6(4),e.Q6J("ngModel",n.isHq),e.xp6(12),e.Oqu(e.xi3(44,51,n.partialWorkforce,"1.0-0")),e.xp6(4),e.Q6J("max",n.totalWorkforceCapacity)("ngModel",n.partialWorkforce),e.uIk("step",n.workforceStep),e.xp6(2),e.hij(" ",n.workforcePercent," "),e.xp6(11),e.Q6J("ngIf",!n.expandState.totalExpenses),e.xp6(1),e.Q6J("ngIf",n.expandState.totalExpenses),e.xp6(4),e.Oqu(e.xi3(66,54,n.totalExpenses,"1.0-0")),e.xp6(2),e.Q6J("ngIf",n.expandState.totalExpenses),e.xp6(3),e.Q6J("ngIf",!n.expandState.totalProfits),e.xp6(1),e.Q6J("ngIf",n.expandState.totalProfits),e.xp6(4),e.Oqu(e.xi3(76,57,n.totalProfits,"1.0-0")),e.xp6(2),e.Q6J("ngIf",n.expandState.totalProfits),e.xp6(8),e.Oqu(e.xi3(86,60,n.totalProfits+n.totalExpenses,"1.0-0")),e.xp6(5),e.Q6J("ngModel",n.provideBasicResources),e.xp6(6),e.Q6J("ngModel",n.provideAllResources),e.xp6(11),e.Q6J("ngSwitch",n.resourcesPrice),e.xp6(1),e.Q6J("ngSwitchCase",0),e.xp6(1),e.Q6J("ngSwitchCase",50),e.xp6(1),e.Q6J("ngSwitchCase",100),e.xp6(3),e.Q6J("ngModel",n.resourcesPrice),e.xp6(6),e.Q6J("ngSwitch",n.productsPrice),e.xp6(1),e.Q6J("ngSwitchCase",0),e.xp6(1),e.Q6J("ngSwitchCase",50),e.xp6(1),e.Q6J("ngSwitchCase",100),e.xp6(3),e.Q6J("ngModel",n.productsPrice),e.xp6(9),e.Q6J("ngForOf",n.moduleCosts),e.xp6(5),e.Oqu(e.xi3(140,63,n.totalModuleCost,"1.0-0")),e.xp6(2),e.Q6J("ngForOf",n.totalModuleResourceCosts),e.xp6(9),e.Q6J("ngSwitch",n.modulesResourcesPrice),e.xp6(1),e.Q6J("ngSwitchCase",0),e.xp6(1),e.Q6J("ngSwitchCase",50),e.xp6(1),e.Q6J("ngSwitchCase",100),e.xp6(3),e.Q6J("ngModel",n.modulesResourcesPrice))},dependencies:[O.mk,O.sg,O.O5,O.RF,O.n9,O.ED,ae.Fj,ae.eT,ae.Wl,ae.JJ,ae.On,O.JJ],encapsulation:2})}var Xi=R(617),Qi=R(9220);let er=(()=>{class o extends it.V{constructor(t,n,r){super(),this.activeModal=t,this.moduleService=n,this.layoutService=r}ngOnInit(){}importPlans(){let t,n=null;try{const r=Qi.xml2js(this.xml,{compact:!0});t=this.importCore(r)}catch{n="Failed to import layouts"}this.activeModal.close({error:n,layouts:t})}importCore(t){const n=[];for(const r of t.plans.plan){if(null==r.entry||0===r.entry.length)continue;const l=r._attributes?.name||"Imported Plan",f=[];for(const E of r.entry){const[b]=this.moduleService.getModulesByMacro(E._attributes.macro);if(b){const V=f.find(G=>G.moduleId===b.id);V?V.count++:f.push({moduleId:b.id,count:1})}}this.layoutService.saveLayout({name:l,config:f}),n.push(l)}return n}get canImport(){return this.xml}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(Ae.Kz),e.Y36(je.C),e.Y36(Ke))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-import-plans"]],features:[e.qOj],decls:20,vars:2,consts:function(){let t;return t=$localize`:@@cancel:Cancel`,[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"font-italic","text-info"],[1,"small","text-secondary"],["rows","10",1,"w-100","mt-2",3,"ngModel","ngModelChange"],[1,"modal-footer"],["type","button",1,"btn","btn-success",3,"disabled","click"],["type","button",1,"btn","btn-secondary",3,"click"],t]},template:function(n,r){1&n&&(e.TgZ(0,"div",0)(1,"h4",1),e._uU(2,"Import Plans"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return r.activeModal.close()}),e.TgZ(4,"span",3),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",4)(7,"div"),e._uU(8,"Paste the "),e.TgZ(9,"span",5),e._uU(10,"constructionplans.xml"),e.qZA(),e._uU(11," content below. The plans will be added to your saved layout list."),e.qZA(),e.TgZ(12,"div",6),e._uU(13,"File can be found in Documents\\Egosoft\\X4\\[12345678]\\constructionplans.xml"),e.qZA(),e.TgZ(14,"textarea",7),e.NdJ("ngModelChange",function(f){return r.xml=f}),e.qZA()(),e.TgZ(15,"div",8)(16,"button",9),e.NdJ("click",function(){return r.importPlans()}),e._uU(17,"Import"),e.qZA(),e.TgZ(18,"button",10),e.NdJ("click",function(){return r.activeModal.close()}),e.SDv(19,11),e.qZA()()),2&n&&(e.xp6(14),e.Q6J("ngModel",r.xml),e.xp6(2),e.Q6J("disabled",!r.canImport))},dependencies:[ae.Fj,ae.JJ,ae.On],encapsulation:2})}return o})(),tr=(()=>{class o extends it.V{constructor(t){super(),this.activeModal=t}ngOnInit(){}exportPlan(){this.stationName=this.stationName?this.stationName:"New Station";const t=this.exportCore(this),n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURI(t)),n.setAttribute("target","_blank"),n.setAttribute("download",`${this.stationName}.xml`),n.click(),n.remove(),this.activeModal.close(t)}exportCore(t){let n="",r=1;const l=Math.random().toString(36).slice(2);for(const S of t.macros){let E=1;for(;E<=S.count;)n+=`\n         <entry index="${r}" macro="${S.macro}">\n         </entry>`,r++,E++}return`<?xml version="1.0" encoding="UTF-8"?>\n   <plans>\n      <plan id="${l}" name="${t.stationName}" description="Buy me a beer, not a coffee">${n}\n      </plan>\n   </plans>`}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(Ae.Kz))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-export-plan"]],features:[e.qOj],decls:17,vars:1,consts:function(){let t,n;return t=$localize`:@@export:Export`,n=$localize`:@@cancel:Cancel`,[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],["rows","1","maxlength","42","placeholder","Station Name",1,"w-100","mt-2",3,"ngModel","ngModelChange","keydown.enter"],[1,"small","text-secondary"],[1,"modal-footer"],["type","button",1,"btn","btn-success",3,"click"],t,["type","button",1,"btn","btn-secondary",3,"click"],n]},template:function(n,r){1&n&&(e.TgZ(0,"div",0)(1,"h4",1),e._uU(2,"Export Plan"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return r.activeModal.close()}),e.TgZ(4,"span",3),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",4)(7,"div"),e._uU(8," Your construction plan is ready to be exported. "),e.qZA(),e.TgZ(9,"textarea",5),e.NdJ("ngModelChange",function(f){return r.stationName=f})("keydown.enter",function(){return r.exportPlan()}),e.qZA(),e.TgZ(10,"div",6),e._uU(11,"Place file in the folder: Documents\\Egosoft\\X4\\[12345678]\\constructionplan"),e.qZA()(),e.TgZ(12,"div",7)(13,"button",8),e.NdJ("click",function(){return r.exportPlan()}),e.SDv(14,9),e.qZA(),e.TgZ(15,"button",10),e.NdJ("click",function(){return r.activeModal.close()}),e.SDv(16,11),e.qZA()()),2&n&&(e.xp6(9),e.Q6J("ngModel",r.stationName))},dependencies:[ae.Fj,ae.JJ,ae.nD,ae.On],encapsulation:2})}return o})();var nr=R(1481);function ir(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div"),e._UZ(1,"span",2),e.TgZ(2,"button",3),e.NdJ("click",function(){const l=e.CHM(t).$implicit,f=e.oxw(2);return e.KtG(f.close(l))}),e.TgZ(3,"span",4),e._uU(4,"\xd7"),e.qZA()()()}if(2&o){const t=i.$implicit;e.Gre("alert alert-",t.type,""),e.xp6(1),e.Q6J("innerHTML",t.content,e.oJD)}}function rr(o,i){if(1&o&&(e.TgZ(0,"div"),e.YNc(1,ir,5,4,"div",1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.messages)}}let or=(()=>{class o{close(t){const n=this.messages.indexOf(t);n>=0&&this.messages.splice(n,1)}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-messages"]],inputs:{messages:"messages"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"class",4,"ngFor","ngForOf"],[3,"innerHTML"],["type","button","data-dismiss","alert","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"]],template:function(n,r){1&n&&e.YNc(0,rr,2,1,"div",0),2&n&&e.Q6J("ngIf",r.messages&&r.messages.length)},dependencies:[O.sg,O.O5],encapsulation:2})}return o})();function sr(o,i){1&o&&e._UZ(0,"i",12)}function ar(o,i){1&o&&e._UZ(0,"i",13)}function lr(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"span"),e.SDv(2,17),e.qZA(),e._uU(3,"\xa0"),e.TgZ(4,"strong"),e._uU(5),e.ALo(6,"number"),e.qZA(),e._uU(7,"\xa0"),e.TgZ(8,"span"),e.SDv(9,18),e.qZA(),e.BQk()),2&o){const t=e.oxw().$implicit;e.xp6(5),e.hij("",e.xi3(6,1,t.efficiency,"1.0-0"),"%")}}function cr(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"span"),e.SDv(2,19),e.qZA(),e._uU(3,"\xa0"),e.TgZ(4,"strong"),e._uU(5),e.ALo(6,"number"),e.qZA(),e._uU(7,"\xa0"),e.TgZ(8,"span"),e.SDv(9,20),e.qZA(),e.BQk()),2&o){const t=e.oxw().$implicit;e.xp6(5),e.hij("",e.xi3(6,1,t.efficiency,"1.0-0"),"%")}}const Mt=function(o,i){return{"text-danger":o,"text-success":i}};function ur(o,i){if(1&o&&(e.TgZ(0,"tr",9)(1,"td",15)(2,"strong"),e._uU(3),e.qZA(),e._uU(4," x "),e.TgZ(5,"strong"),e._uU(6),e.qZA(),e.YNc(7,lr,10,4,"ng-container",11),e.YNc(8,cr,10,4,"ng-container",11),e.qZA(),e.TgZ(9,"td",16),e._uU(10),e.ALo(11,"number"),e.qZA()()),2&o){const t=i.$implicit;e.Q6J("ngClass",e.WLB(9,Mt,t.total<0,t.total>0)),e.xp6(3),e.Oqu(t.count),e.xp6(3),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",t.total>0),e.xp6(1),e.Q6J("ngIf","Habitation"===t.type),e.xp6(2),e.Oqu(e.xi3(11,6,t.total,"1.0-0"))}}function dr(o,i){if(1&o&&(e.ynx(0),e.YNc(1,ur,12,12,"tr",14),e.BQk()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.items)}}function _r(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",6),e.NdJ("click",function(){const l=e.CHM(t).$implicit,f=e.oxw();return e.KtG(f.toggleExpanded(l))}),e.TgZ(2,"td"),e.YNc(3,sr,1,0,"i",7),e.YNc(4,ar,1,0,"i",8),e.TgZ(5,"span",9),e._uU(6),e.qZA()(),e.TgZ(7,"td",10),e._uU(8),e.ALo(9,"number"),e.qZA()(),e.YNc(10,dr,2,1,"ng-container",11),e.BQk()}if(2&o){const t=i.$implicit;e.xp6(3),e.Q6J("ngIf",!t.expanded),e.xp6(1),e.Q6J("ngIf",t.expanded),e.xp6(1),e.Q6J("ngClass",e.WLB(10,Mt,t.amount<0,t.amount>0)),e.xp6(1),e.hij(" ",t.ware.name,""),e.xp6(1),e.Q6J("ngClass",e.WLB(13,Mt,t.amount<0,t.amount>0)),e.xp6(1),e.Oqu(e.xi3(9,7,t.amount,"1.0-0")),e.xp6(2),e.Q6J("ngIf",t.expanded)}}let hr=(()=>{class o{constructor(t,n){this.wareService=t,this.stationSummaryService=n,this.expandState={},this.totalWorkforce=0,this.totalWorkforceCapacity=0,this.partialWorkforce=0,this.resources=[],this.sunlight=100,this.workforceSubscription=this.stationSummaryService.partialWorkforceChanged.subscribe(r=>{this.partialWorkforce=r,this.update()})}ngOnChanges(){this.update()}ngOnInit(){}toggleExpanded(t){t.expanded=!t.expanded,this.expandState[t.ware.id]=t.expanded}update(){if(this.totalWorkforce=0,null==this.modules)return;this.totalWorkforce=this.modules.reduce((n,r)=>r.module&&r.module.workForce&&r.module.workForce.max?n+r.count*r.module.workForce.max:n,0);const t=this.modules.reduce((n,r)=>r.module&&r.module.workForce&&r.module.workForce.capacity?n+r.count*r.module.workForce.capacity:n,0);this.totalWorkforceCapacity!=t&&(this.totalWorkforceCapacity=t,this.partialWorkforce=t),this.resources=Et.calculate(this.modules,this.sunlight,this.partialWorkforce),this.resources.forEach(n=>{n.expanded=this.expandState[n.items[0].ware.id]}),this.resources.sort((n,r)=>this.wareService.compareWares(n.ware,r.ware))}ngOnDestroy(){this.workforceSubscription.unsubscribe()}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(rt.l),e.Y36(Nt))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-station-resources"]],inputs:{modules:"modules",sunlight:"sunlight"},features:[e.TTD],decls:9,vars:1,consts:function(){let t,n,r,l,f,S;return t=$localize`:@@resources:Resource`,n=$localize`:@@amount:Amount`,r=$localize`:@@at: at`,l=$localize`:@@efficiency:efficiency`,f=$localize`:@@at: at`,S=$localize`:@@capacity:capacity`,[[1,"table","table-sm","small"],["scope","col"],t,["scope","col",1,"text-right"],n,[4,"ngFor","ngForOf"],[1,"hover",3,"click"],["class","fa fa-angle-double-down",4,"ngIf"],["class","fa fa-angle-double-up",4,"ngIf"],[3,"ngClass"],[1,"text-right",3,"ngClass"],[4,"ngIf"],[1,"fa","fa-angle-double-down"],[1,"fa","fa-angle-double-up"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"pl-4"],[1,"text-right"],r,l,f,S]},template:function(n,r){1&n&&(e.TgZ(0,"table",0)(1,"thead")(2,"tr")(3,"th",1),e.SDv(4,2),e.qZA(),e.TgZ(5,"th",3),e.SDv(6,4),e.qZA()()(),e.TgZ(7,"tbody"),e.YNc(8,_r,11,16,"ng-container",5),e.qZA()()),2&n&&(e.xp6(8),e.Q6J("ngForOf",r.resources))},dependencies:[O.mk,O.sg,O.O5,O.JJ],encapsulation:2})}return o})();function fr(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",9),e.NdJ("click",function(){const l=e.CHM(t).$implicit,f=e.oxw(4);return e.KtG(f.onClick(l))}),e.TgZ(1,"label"),e._uU(2),e.qZA()()}if(2&o){const t=i.$implicit;e.xp6(2),e.Oqu(t.name)}}function pr(o,i){if(1&o&&(e.TgZ(0,"div",6)(1,"label",7)(2,"b"),e._uU(3),e.qZA()(),e.YNc(4,fr,3,1,"div",8),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(3),e.Oqu(t.name),e.xp6(1),e.Q6J("ngForOf",t.modules)}}function gr(o,i){if(1&o&&(e.ynx(0),e.YNc(1,pr,5,2,"div",5),e.BQk()),2&o){const t=i.$implicit;e.xp6(1),e.Q6J("ngIf",t.modules.length>0)}}function mr(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",3),e.NdJ("focus",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onFocus())})("blur",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onBlur())}),e.YNc(1,gr,2,1,"ng-container",4),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.filteredGroups)}}let Tr=(()=>{class o{constructor(){this.id=null,this.groups=[],this.filteredGroups=[],this.selectModule=new e.vpe,this.inputString="",this.visible=!1}ngOnInit(){this.filteredGroups=this.groups.map(t=>Object.assign({},t)),this.setName()}filterModules(t){for(let n=0;n<this.groups.length;n++)this.filteredGroups[n].modules=[...this.groups[n].modules.filter(r=>r.name.trim().toLowerCase().includes(t.trim().toLowerCase()))]}changed(t){t?this.filterModules(t):this.filteredGroups=this.groups.map(n=>Object.assign({},n))}onFocus(){clearTimeout(this.timeout),this.filterModules(this.inputString),this.visible=!0}onBlur(){this.timeout=setTimeout(()=>{this.setName(),this.visible=!1},100)}onClick(t){this.inputString=t.name,this.filterModules(this.inputString),this.selectModule.emit(t.id),this.visible=!1}setName(){this.id&&this.groups.forEach(t=>{const n=t.modules.filter(r=>r.id===this.id)[0];n&&(this.inputString=n.name)})}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-autocomplete"]],inputs:{id:"id",groups:"groups"},outputs:{selectModule:"selectModule"},decls:3,vars:2,consts:function(){let t;return t=$localize`:@@select:( Select )`,[[1,"autocomplete-container"],["type","search","placeholder",t,1,"form-control","form-control-sm",3,"ngModel","ngModelChange","focus","blur"],["tabindex","0","class","autocomplete",3,"focus","blur",4,"ngIf"],["tabindex","0",1,"autocomplete",3,"focus","blur"],[4,"ngFor","ngForOf"],["class","autocomplete__group-container",4,"ngIf"],[1,"autocomplete__group-container"],[1,"autocomplete__group-title"],["class","autocomplete__group-item",3,"click",4,"ngFor","ngForOf"],[1,"autocomplete__group-item",3,"click"]]},template:function(n,r){1&n&&(e.TgZ(0,"div",0)(1,"input",1),e.NdJ("ngModelChange",function(f){return r.inputString=f})("ngModelChange",function(f){return r.changed(f)})("focus",function(){return r.onFocus()})("blur",function(){return r.onBlur()}),e.qZA(),e.YNc(2,mr,2,1,"div",2),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngModel",r.inputString),e.xp6(1),e.Q6J("ngIf",r.visible))},dependencies:[O.sg,O.O5,ae.Fj,ae.JJ,ae.On],styles:[".autocomplete-container[_ngcontent-%COMP%]{position:relative}.autocomplete[_ngcontent-%COMP%]{max-height:40vh;overflow:hidden;overflow-y:scroll;position:absolute;background-color:#444;border-radius:.2rem;border:1px solid #ced4da;z-index:1}.autocomplete__group-title[_ngcontent-%COMP%]{color:#ddd;font-size:1.15em;padding-left:10px}.autocomplete__group-item[_ngcontent-%COMP%]{font-size:1.1em;padding-left:20px;padding-right:10px}.autocomplete__group-item[_ngcontent-%COMP%]:hover{background-color:#0003;cursor:pointer}.autocomplete__group-item[_ngcontent-%COMP%]:hover   label[_ngcontent-%COMP%]{cursor:pointer}label[_ngcontent-%COMP%]{margin:0}input[type=search][_ngcontent-%COMP%]::-webkit-search-cancel-button{-webkit-appearance:searchfield-cancel-button}"]})}return o})();function Sr(o,i){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.module.name," ")}}function Cr(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"tr",12)(1,"td"),e.YNc(2,Sr,2,1,"div",13),e.TgZ(3,"div",14)(4,"app-autocomplete",15),e.NdJ("selectModule",function(r){const f=e.CHM(t).$implicit,S=e.oxw();return e.KtG(S.onSelectModule(r,f))}),e.qZA()()(),e.TgZ(5,"td")(6,"div",14)(7,"input",16),e.NdJ("ngModelChange",function(r){const f=e.CHM(t).$implicit;return e.KtG(f.count=r)})("ngModelChange",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onChange())}),e.qZA()()(),e.TgZ(8,"td"),e._UZ(9,"i",17),e.qZA(),e.TgZ(10,"td")(11,"i",18),e.NdJ("click",function(){const l=e.CHM(t).$implicit,f=e.oxw();return e.KtG(f.removeModule(l))}),e.qZA()()()}if(2&o){const t=i.$implicit,n=e.oxw();e.xp6(4),e.Q6J("id",t.moduleId)("groups",n.wareGroups),e.xp6(3),e.Q6J("ngModel",t.count)}}let yr=(()=>{class o{constructor(t,n,r){this.moduleService=t,this.wareService=n,this.stationSummaryService=r,this.change=new e.vpe,this.sunlight=100}ngOnInit(){const t=this.moduleService.getModulesByType(Ne.J.production).reduce((n,r)=>{if(an.includes(r.id))return n[Ne.J.recycling]=n[Ne.J.recycling]||{name:Ne.J.recycling,group:Ne.J.recycling,modules:[]},n[Ne.J.recycling].modules.push(r),n;for(let l of r.product)n[l.group.id]=n[l.group.id]||{name:l.group.name,group:l.group,modules:[]},n[l.group.id].modules.push(r);return n},[]);this.wareGroups=Object.keys(t).map(n=>t[n]).sort((n,r)=>this.wareService.compareGroups(n.group,r.group));for(const n of Ne.B)this.wareGroups.push({name:n,modules:this.moduleService.getModulesByType(n)})}removeModule(t){const n=this.modules.indexOf(t);n>=0&&(this.modules.splice(n,1),this.onChange())}addModule(){this.modules.push(new qe(this.wareService,this.moduleService))}onChange(){this.change.emit()}backfillModules(){const t=this.modules.find(r=>r.module?.type===Ne.J.habitation);let n="default";for(t&&(n=t.module.makerRace.id);;){const r=Et.calculate(this.modules,this.sunlight,this.stationSummaryService.$partialWorkforce);let l=!1;const f=this.modules;for(const S of r){if(S.amount>=0)continue;const E=this.moduleService.getModuleByWare(S.ware.id,n)||this.moduleService.getModuleByWare(S.ware.id);if(null==E)continue;l=!0;const b=E.product.find(ue=>ue.id==S.ware.id),V=b.production.find(ue=>ue.method==n)||b.production.find(ue=>"default"==ue.method),ge=Math.ceil(-S.amount/(V.amount*(3600/V.time))),Se=f.find(ue=>ue.module?.id==E.id);null==Se?f.push(new qe(this.wareService,this.moduleService,E.id,ge)):Se.count+=ge}if(!l)break}this.onChange()}onSelectModule(t,n){this.modules[this.modules.indexOf(n)].moduleId=t,this.onChange()}drop(t){Gt(this.modules,t.previousIndex,t.currentIndex)}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(je.C),e.Y36(rt.l),e.Y36(Nt))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-station-modules"]],inputs:{modules:"modules",sunlight:"sunlight"},outputs:{change:"change"},decls:25,vars:1,consts:function(){let t,n;return t=$localize`:@@module:Module`,n=$localize`:@@count:Count`,[[1,"table","table-sm","table-hover","small"],["scope","col"],t,n,["aria-hidden","true",1,"fa","fa-ellipsis-v"],["aria-hidden","true",1,"fa","fa-trash"],["cdkDropList","",3,"cdkDropListDropped"],["cdkDrag","","cdkDragBoundary",".table",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"fa","fa-plus-square"],["type","button",1,"btn","btn-sm","btn-info",3,"click"],[1,"fa","fa-list"],["cdkDrag","","cdkDragBoundary",".table"],[4,"cdkDragPreview"],[1,"form-group"],[3,"id","groups","selectModule"],["type","number","placeholder","Module Count","min","0",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["cdkDragHandle","",1,"fa","fa-ellipsis-v","move"],["aria-hidden","true",1,"fa","fa-trash","hover",3,"click"]]},template:function(n,r){1&n&&(e.TgZ(0,"table",0)(1,"thead")(2,"tr")(3,"th",1),e.SDv(4,2),e.qZA(),e.TgZ(5,"th",1),e.SDv(6,3),e.qZA(),e.TgZ(7,"th",1),e._UZ(8,"i",4),e.qZA(),e.TgZ(9,"th",1),e._UZ(10,"i",5),e.qZA()()(),e.TgZ(11,"tbody",6),e.NdJ("cdkDropListDropped",function(f){return r.drop(f)}),e.YNc(12,Cr,12,3,"tr",7),e.qZA(),e.TgZ(13,"tfoot")(14,"tr")(15,"th")(16,"button",8),e.NdJ("click",function(){return r.addModule()}),e._UZ(17,"i",9),e._uU(18,"\xa0Add Module"),e.qZA(),e._uU(19,"\xa0 "),e.TgZ(20,"button",10),e.NdJ("click",function(){return r.backfillModules()}),e._UZ(21,"i",11),e._uU(22,"\xa0"),e.TgZ(23,"span"),e._uU(24,"Autofill Modules"),e.qZA()()()()()()),2&n&&(e.xp6(12),e.Q6J("ngForOf",r.modules))},dependencies:[O.sg,ae.Fj,ae.wV,ae.JJ,ae.qQ,ae.On,Jt,nn,Xt,tn,Tr],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{background-color:#fff;padding:20px;box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.move[_ngcontent-%COMP%]{cursor:move}"]})}return o})();function vr(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",4)(1,"button",5),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.result=null)}),e.TgZ(2,"span",6),e._uU(3,"\xd7"),e.qZA()(),e.TgZ(4,"div"),e._uU(5," Failed to import plans. "),e.qZA()()}}function Er(o,i){1&o&&(e.TgZ(0,"span"),e._uU(1," | "),e.qZA())}function Ar(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"a",10),e.NdJ("click",function(){const l=e.CHM(t).$implicit,f=e.oxw(3);return e.KtG(f.selectLayout(l))}),e._uU(2),e.qZA(),e.YNc(3,Er,2,0,"span",0),e.BQk()}if(2&o){const t=i.$implicit,n=i.last;e.xp6(2),e.Oqu(t),e.xp6(1),e.Q6J("ngIf",!n)}}function Nr(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",7)(1,"button",5),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.result=null)}),e.TgZ(2,"span",6),e._uU(3,"\xd7"),e.qZA()(),e.TgZ(4,"div"),e._uU(5," Imported plans, but errors occurred trying to import some of them. "),e.TgZ(6,"div",8),e.YNc(7,Ar,4,2,"ng-container",9),e.qZA()()()}if(2&o){const t=e.oxw(2);e.xp6(7),e.Q6J("ngForOf",t.result.layouts)}}function Mr(o,i){1&o&&(e.TgZ(0,"span"),e._uU(1," | "),e.qZA())}function Or(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"a",10),e.NdJ("click",function(){const l=e.CHM(t).$implicit,f=e.oxw(3);return e.KtG(f.selectLayout(l))}),e._uU(2),e.qZA(),e.YNc(3,Mr,2,0,"span",0),e.BQk()}if(2&o){const t=i.$implicit,n=i.last;e.xp6(2),e.Oqu(t),e.xp6(1),e.Q6J("ngIf",!n)}}function Ir(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",11)(1,"button",12),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.result=null)}),e.TgZ(2,"span",6),e._uU(3,"\xd7"),e.qZA()(),e.TgZ(4,"div"),e._uU(5," Successfully imported plans "),e.TgZ(6,"div",8),e.YNc(7,Or,4,2,"ng-container",9),e.qZA()()()}if(2&o){const t=e.oxw(2);e.xp6(7),e.Q6J("ngForOf",t.result.layouts)}}function wr(o,i){if(1&o&&(e.ynx(0),e.YNc(1,vr,6,0,"div",1),e.YNc(2,Nr,8,1,"div",2),e.YNc(3,Ir,8,1,"div",3),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.result.error&&(!t.result.layouts||0===t.result.layouts.length)),e.xp6(1),e.Q6J("ngIf",t.result.error&&t.result.layouts&&t.result.layouts.length>0),e.xp6(1),e.Q6J("ngIf",!t.result.error&&t.result.layouts&&t.result.layouts.length>0)}}let br=(()=>{class o{constructor(){this.selectPlan=new e.vpe}set result(t){this._result=t}get result(){return this._result}selectLayout(t){this.selectPlan.emit(t)}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-import-result"]],inputs:{result:"result"},outputs:{selectPlan:"selectPlan"},decls:1,vars:1,consts:[[4,"ngIf"],["class","alert alert-danger",4,"ngIf"],["class","alert alert-warning",4,"ngIf"],["class","alert alert-success",4,"ngIf"],[1,"alert","alert-danger"],["type","button","data-dismiss","alert","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"alert","alert-warning"],[1,"small"],[4,"ngFor","ngForOf"],[1,"cursor-pointer","link","text-primary",3,"click"],[1,"alert","alert-success"],["type","button","data-dismiss","alert","aria-label","Close",1,"close","pull-right",3,"click"]],template:function(n,r){1&n&&e.YNc(0,wr,4,3,"ng-container",0),2&n&&e.Q6J("ngIf",r.result)},dependencies:[O.sg,O.O5],encapsulation:2})}return o})();const xr=["stationResources","stationSummary"];function Rr(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",22)(1,"div",36),e._UZ(2,"app-messages",37),e.TgZ(3,"app-import-result",38),e.NdJ("selectPlan",function(r){e.CHM(t);const l=e.oxw();return e.KtG(l.onSelectPlan(r))}),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("messages",t.messages),e.xp6(1),e.Q6J("result",t.importResult)}}function Pr(o,i){1&o&&(e.TgZ(0,"span",39),e._uU(1,"Station Modules"),e.qZA())}function Dr(o,i){if(1&o&&(e.TgZ(0,"span",39),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Oqu(t.layout.name)}}let kr=(()=>{class o extends it.V{constructor(t,n,r,l,f,S){super(),this.modal=t,this.route=n,this.layoutService=r,this.titleService=l,this.wareService=f,this.moduleService=S,this.messages=[],this.modules=[],this.sunlight=100}ngOnInit(){this.titleService.setTitle(`${Xi.q} - Station Calculator`),this.route.queryParams.pipe((0,Ve.R)(this.onDestroy)).subscribe(t=>{if(t.l)try{const n=t.l.replace(/-/g,"=").replace(/,/g,"&"),r=rn.parse(n);this.modules=r.map(l=>new qe(this.wareService,this.moduleService,l.module,l.count))}catch(n){console.log(n)}}),0===this.modules.length&&this.modules.push(new qe(this.wareService,this.moduleService))}onChange(){this.components.forEach(t=>t.update())}shareLayout(){const t=this.modal.open(_i),n=this.modules.filter(f=>f.count>0&&f.moduleId).map(f=>({module:f.moduleId,count:f.count})),r=rn.stringify(n).replace(/=/g,"-").replace(/&/g,","),l=window.location.href.split("?")[0];t.componentInstance.url=`${l}?l=${r}`}saveLayoutAs(){this.modal.open(di).result.then(n=>{n&&(this.layout={name:n,resourcesPrice:this.summaryComponent.resourcesPrice,productsPrice:this.summaryComponent.productsPrice,modulesResourcesPrice:this.summaryComponent.modulesResourcesPrice,provideBasicResources:this.summaryComponent.provideBasicResources,provideAllResources:this.summaryComponent.provideAllResources,isHeadquarters:this.summaryComponent.isHq,sunlight:this.sunlight,config:this.getModuleConfig()},this.layoutService.saveLayout(this.layout),this.messages.push({type:on.success,content:`<strong>${n}</strong> successfully saved.`}))})}saveLayout(){this.layout&&this.layout.name?(this.layout.config=this.getModuleConfig(),this.layout.resourcesPrice=this.summaryComponent.resourcesPrice,this.layout.productsPrice=this.summaryComponent.productsPrice,this.layout.modulesResourcesPrice=this.summaryComponent.modulesResourcesPrice,this.layout.provideBasicResources=this.summaryComponent.provideBasicResources,this.layout.provideAllResources=this.summaryComponent.provideAllResources,this.layout.isHeadquarters=this.summaryComponent.isHq,this.layout.sunlight=this.sunlight,this.layoutService.saveLayout(this.layout),this.messages.push({type:on.success,content:`<strong>${this.layout.name}</strong> successfully saved.`})):this.saveLayoutAs()}newLayout(){this.layout={name:null,config:[{moduleId:"",count:1}]},this.loadLayoutInternal(this.layout)}loadLayout(){this.modal.open(ui,{size:"lg"}).result.then(n=>{if(n){const r=this.layoutService.getLayout(n.layoutName);if(r)if(n.type==Pe.load)this.layout=r,this.loadLayoutInternal(r);else if(n.type==Pe.add){const l=this.modules.concat([]);this.getModules(r.config).forEach(S=>{const E=l.find(b=>b.moduleId==S.moduleId);null==E?l.push(S):E.count+=S.count}),this.modules=l}}})}importPlans(){this.modal.open(er).result.then(n=>this.importResult=n)}exportPlan(){const t=[];for(const r of this.modules)t.push({macro:r.module.macro,count:r.count});this.modal.open(tr).componentInstance.macros=t}loadLayoutInternal(t){this.modules=this.getModules(t.config),this.summaryComponent.productsPrice=null==t.productsPrice?50:t.productsPrice,this.summaryComponent.modulesResourcesPrice=null==t.modulesResourcesPrice?50:t.modulesResourcesPrice,this.summaryComponent.resourcesPrice=null==t.resourcesPrice?50:t.resourcesPrice,this.summaryComponent.provideBasicResources=t.provideBasicResources,this.summaryComponent.provideAllResources=t.provideAllResources,this.summaryComponent.isHq=t.isHeadquarters,this.sunlight=t.sunlight||100}getModuleConfig(){return this.modules.map(t=>({moduleId:t.moduleId,count:t.count}))}getModules(t){return t.map(n=>new qe(this.wareService,this.moduleService,n.moduleId,n.count))}onSelectPlan(t){const n=this.layoutService.getLayout(t);n&&this.loadLayoutInternal(n)}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(Ae.FF),e.Y36(Ct.gz),e.Y36(Ke),e.Y36(nr.Dx),e.Y36(rt.l),e.Y36(je.C))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-station-calculator"]],viewQuery:function(n,r){if(1&n&&(e.Gf(Ze,7),e.Gf(xr,5)),2&n){let l;e.iGM(l=e.CRH())&&(r.summaryComponent=l.first),e.iGM(l=e.CRH())&&(r.components=l)}},features:[e.qOj],decls:69,vars:10,consts:function(){let t,n,r,l,f,S,E;return t=$localize`:@@newLayout:New`,n=$localize`:@@save:Save`,r=$localize`:@@saveAs:Save As`,l=$localize`:@@load:Load`,f=$localize`:@@share:Share`,S=$localize`:@@share:Import`,E=$localize`:@@export:Export`,[[1,"row","content-row"],[1,"col-md-12"],[1,"card","shadow"],[1,"card-header","shadow-sm"],["type","button",1,"btn","btn-sm","btn-info",3,"click"],[1,"fa","fa-file"],t,["type","button",1,"btn","btn-sm","btn-primary",3,"click"],[1,"fa","fa-save"],n,r,[1,"fa","fa-folder-open"],l,["type","button",1,"btn","btn-sm","btn-secondary",3,"click"],[1,"fa","fa-share-square"],f,["type","button",1,"btn","btn-sm","btn-dark",3,"click"],[1,"fa","fa-file-text"],S,E,[1,"card-body"],["class","row",4,"ngIf"],[1,"row"],[1,"col-md-4","col-sm-12"],[1,"card-title","d-flex","align-items-center"],["class","flex-fill",4,"ngIf"],[1,"d-flex","align-items-center"],[1,"form-label","text-nowrap","px-2"],[1,"input-group"],["type","text","id","sun-light","name","sunlight",1,"form-control",2,"width","70px",3,"ngModel","ngModelChange"],[1,"input-group-text"],[3,"modules","sunlight","change"],[1,"card-title"],[3,"modules","sunlight"],["stationResources",""],["stationSummary",""],[1,"col"],[3,"messages"],[3,"result","selectPlan"],[1,"flex-fill"]]},template:function(n,r){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),e.NdJ("click",function(){return r.newLayout()}),e._UZ(5,"i",5),e._uU(6,"\xa0"),e.TgZ(7,"span"),e.SDv(8,6),e.qZA()(),e._uU(9,"\xa0 "),e.TgZ(10,"button",7),e.NdJ("click",function(){return r.saveLayout()}),e._UZ(11,"i",8),e._uU(12,"\xa0"),e.TgZ(13,"span"),e.SDv(14,9),e.qZA()(),e._uU(15,"\xa0 "),e.TgZ(16,"button",7),e.NdJ("click",function(){return r.saveLayoutAs()}),e._UZ(17,"i",8),e._uU(18,"\xa0"),e.TgZ(19,"span"),e.SDv(20,10),e.qZA()(),e._uU(21,"\xa0 "),e.TgZ(22,"button",4),e.NdJ("click",function(){return r.loadLayout()}),e._UZ(23,"i",11),e._uU(24,"\xa0"),e.TgZ(25,"span"),e.SDv(26,12),e.qZA()(),e._uU(27,"\xa0 "),e.TgZ(28,"button",13),e.NdJ("click",function(){return r.shareLayout()}),e._UZ(29,"i",14),e._uU(30,"\xa0"),e.TgZ(31,"span"),e.SDv(32,15),e.qZA()(),e._uU(33,"\xa0 "),e.TgZ(34,"button",16),e.NdJ("click",function(){return r.importPlans()}),e._UZ(35,"i",17),e._uU(36,"\xa0"),e.TgZ(37,"span"),e.SDv(38,18),e.qZA()(),e.TgZ(39,"button",4),e.NdJ("click",function(){return r.exportPlan()}),e._UZ(40,"i",17),e._uU(41,"\xa0"),e.TgZ(42,"span"),e.SDv(43,19),e.qZA()()(),e.TgZ(44,"div",20),e.YNc(45,Rr,4,2,"div",21),e.TgZ(46,"div",22)(47,"div",23)(48,"h6",24),e.YNc(49,Pr,2,0,"span",25),e.YNc(50,Dr,2,1,"span",25),e.TgZ(51,"div",26)(52,"label",27),e._uU(53,"Sun Light"),e.qZA(),e.TgZ(54,"div",28)(55,"input",29),e.NdJ("ngModelChange",function(f){return r.sunlight=f}),e.qZA(),e.TgZ(56,"span",30),e._uU(57,"%"),e.qZA()()()(),e.TgZ(58,"app-station-modules",31),e.NdJ("change",function(){return r.onChange()}),e.qZA()(),e.TgZ(59,"div",23)(60,"h6",32),e._uU(61,"Station Resources"),e.qZA(),e._UZ(62,"app-station-resources",33,34),e.qZA(),e.TgZ(64,"div",23)(65,"h6",32),e._uU(66,"Station Summary"),e.qZA(),e._UZ(67,"app-station-summary",33,35),e.qZA()()()()()()),2&n&&(e.xp6(45),e.Q6J("ngIf",r.messages.length||r.importResult),e.xp6(4),e.Q6J("ngIf",!r.layout),e.xp6(1),e.Q6J("ngIf",r.layout),e.xp6(5),e.Q6J("ngModel",r.sunlight),e.xp6(3),e.Q6J("modules",r.modules)("sunlight",r.sunlight),e.xp6(4),e.Q6J("modules",r.modules)("sunlight",r.sunlight),e.xp6(5),e.Q6J("modules",r.modules)("sunlight",r.sunlight))},dependencies:[O.O5,ae.Fj,ae.JJ,ae.On,or,hr,yr,Ze,br],encapsulation:2})}return o})(),Fr=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275mod=e.oAB({type:o});static#n=this.\u0275inj=e.cJS({imports:[Ct.Bz.forChild([{path:"",component:kr}]),Ct.Bz]})}return o})(),Lr=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275mod=e.oAB({type:o});static#n=this.\u0275inj=e.cJS({providers:[Ke],imports:[Ae.bz,O.ez,ae.u5,ri.m,Fr,ii]})}return o})()},5343:(he,te)=>{"use strict";te.byteLength=function g(B){var Y=D(B),W=Y[1];return 3*(Y[0]+W)/4-W},te.toByteArray=function J(B){var Y,u,H=D(B),W=H[0],oe=H[1],N=new O(function U(B,Y,H){return 3*(Y+H)/4-H}(0,W,oe)),k=0,h=oe>0?W-4:W;for(u=0;u<h;u+=4)Y=e[B.charCodeAt(u)]<<18|e[B.charCodeAt(u+1)]<<12|e[B.charCodeAt(u+2)]<<6|e[B.charCodeAt(u+3)],N[k++]=Y>>16&255,N[k++]=Y>>8&255,N[k++]=255&Y;return 2===oe&&(Y=e[B.charCodeAt(u)]<<2|e[B.charCodeAt(u+1)]>>4,N[k++]=255&Y),1===oe&&(Y=e[B.charCodeAt(u)]<<10|e[B.charCodeAt(u+1)]<<4|e[B.charCodeAt(u+2)]>>2,N[k++]=Y>>8&255,N[k++]=255&Y),N},te.fromByteArray=function q(B){for(var Y,H=B.length,W=H%3,oe=[],N=16383,k=0,h=H-W;k<h;k+=N)oe.push(z(B,k,k+N>h?h:k+N));return 1===W?oe.push(R[(Y=B[H-1])>>2]+R[Y<<4&63]+"=="):2===W&&oe.push(R[(Y=(B[H-2]<<8)+B[H-1])>>10]+R[Y>>4&63]+R[Y<<2&63]+"="),oe.join("")};for(var R=[],e=[],O=typeof Uint8Array<"u"?Uint8Array:Array,M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",F=0,m=M.length;F<m;++F)R[F]=M[F],e[M.charCodeAt(F)]=F;function D(B){var Y=B.length;if(Y%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var H=B.indexOf("=");return-1===H&&(H=Y),[H,H===Y?0:4-H%4]}function L(B){return R[B>>18&63]+R[B>>12&63]+R[B>>6&63]+R[63&B]}function z(B,Y,H){for(var oe=[],N=Y;N<H;N+=3)oe.push(L((B[N]<<16&16711680)+(B[N+1]<<8&65280)+(255&B[N+2])));return oe.join("")}e["-".charCodeAt(0)]=62,e["_".charCodeAt(0)]=63},3172:(he,te,R)=>{"use strict";var e=R(5343),O=R(8461),M="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;te.Buffer=g,te.SlowBuffer=function N(d){return+d!=d&&(d=0),g.alloc(+d)},te.INSPECT_MAX_BYTES=50;var F=2147483647;function D(d){if(d>F)throw new RangeError('The value "'+d+'" is invalid for option "size"');var s=new Uint8Array(d);return Object.setPrototypeOf(s,g.prototype),s}function g(d,s,a){if("number"==typeof d){if("string"==typeof s)throw new TypeError('The "string" argument must be of type string. Received type number');return z(d)}return U(d,s,a)}function U(d,s,a){if("string"==typeof d)return function q(d,s){if(("string"!=typeof s||""===s)&&(s="utf8"),!g.isEncoding(s))throw new TypeError("Unknown encoding: "+s);var a=0|k(d,s),p=D(a),y=p.write(d,s);return y!==a&&(p=p.slice(0,y)),p}(d,s);if(ArrayBuffer.isView(d))return function Y(d){if(Q(d,Uint8Array)){var s=new Uint8Array(d);return H(s.buffer,s.byteOffset,s.byteLength)}return B(d)}(d);if(null==d)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof d);if(Q(d,ArrayBuffer)||d&&Q(d.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Q(d,SharedArrayBuffer)||d&&Q(d.buffer,SharedArrayBuffer)))return H(d,s,a);if("number"==typeof d)throw new TypeError('The "value" argument must not be of type number. Received type number');var p=d.valueOf&&d.valueOf();if(null!=p&&p!==d)return g.from(p,s,a);var y=function W(d){if(g.isBuffer(d)){var s=0|oe(d.length),a=D(s);return 0===a.length||d.copy(a,0,0,s),a}return void 0!==d.length?"number"!=typeof d.length||me(d.length)?D(0):B(d):"Buffer"===d.type&&Array.isArray(d.data)?B(d.data):void 0}(d);if(y)return y;if(typeof Symbol<"u"&&null!=Symbol.toPrimitive&&"function"==typeof d[Symbol.toPrimitive])return g.from(d[Symbol.toPrimitive]("string"),s,a);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof d)}function J(d){if("number"!=typeof d)throw new TypeError('"size" argument must be of type number');if(d<0)throw new RangeError('The value "'+d+'" is invalid for option "size"')}function z(d){return J(d),D(d<0?0:0|oe(d))}function B(d){for(var s=d.length<0?0:0|oe(d.length),a=D(s),p=0;p<s;p+=1)a[p]=255&d[p];return a}function H(d,s,a){if(s<0||d.byteLength<s)throw new RangeError('"offset" is outside of buffer bounds');if(d.byteLength<s+(a||0))throw new RangeError('"length" is outside of buffer bounds');var p;return p=void 0===s&&void 0===a?new Uint8Array(d):void 0===a?new Uint8Array(d,s):new Uint8Array(d,s,a),Object.setPrototypeOf(p,g.prototype),p}function oe(d){if(d>=F)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+F.toString(16)+" bytes");return 0|d}function k(d,s){if(g.isBuffer(d))return d.length;if(ArrayBuffer.isView(d)||Q(d,ArrayBuffer))return d.byteLength;if("string"!=typeof d)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof d);var a=d.length,p=arguments.length>2&&!0===arguments[2];if(!p&&0===a)return 0;for(var y=!1;;)switch(s){case"ascii":case"latin1":case"binary":return a;case"utf8":case"utf-8":return c(d).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*a;case"hex":return a>>>1;case"base64":return X(d).length;default:if(y)return p?-1:c(d).length;s=(""+s).toLowerCase(),y=!0}}function h(d,s,a){var p=!1;if((void 0===s||s<0)&&(s=0),s>this.length||((void 0===a||a>this.length)&&(a=this.length),a<=0)||(a>>>=0)<=(s>>>=0))return"";for(d||(d="utf8");;)switch(d){case"hex":return we(this,s,a);case"utf8":case"utf-8":return Ee(this,s,a);case"ascii":return ne(this,s,a);case"latin1":case"binary":return Xe(this,s,a);case"base64":return Me(this,s,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Re(this,s,a);default:if(p)throw new TypeError("Unknown encoding: "+d);d=(d+"").toLowerCase(),p=!0}}function u(d,s,a){var p=d[s];d[s]=d[a],d[a]=p}function v(d,s,a,p,y){if(0===d.length)return-1;if("string"==typeof a?(p=a,a=0):a>2147483647?a=2147483647:a<-2147483648&&(a=-2147483648),me(a=+a)&&(a=y?0:d.length-1),a<0&&(a=d.length+a),a>=d.length){if(y)return-1;a=d.length-1}else if(a<0){if(!y)return-1;a=0}if("string"==typeof s&&(s=g.from(s,p)),g.isBuffer(s))return 0===s.length?-1:P(d,s,a,p,y);if("number"==typeof s)return s&=255,"function"==typeof Uint8Array.prototype.indexOf?y?Uint8Array.prototype.indexOf.call(d,s,a):Uint8Array.prototype.lastIndexOf.call(d,s,a):P(d,[s],a,p,y);throw new TypeError("val must be string, number or Buffer")}function P(d,s,a,p,y){var ce,w=1,x=d.length,ee=s.length;if(void 0!==p&&("ucs2"===(p=String(p).toLowerCase())||"ucs-2"===p||"utf16le"===p||"utf-16le"===p)){if(d.length<2||s.length<2)return-1;w=2,x/=2,ee/=2,a/=2}function ie(st,at){return 1===w?st[at]:st.readUInt16BE(at*w)}if(y){var Ce=-1;for(ce=a;ce<x;ce++)if(ie(d,ce)===ie(s,-1===Ce?0:ce-Ce)){if(-1===Ce&&(Ce=ce),ce-Ce+1===ee)return Ce*w}else-1!==Ce&&(ce-=ce-Ce),Ce=-1}else for(a+ee>x&&(a=x-ee),ce=a;ce>=0;ce--){for(var fe=!0,Ye=0;Ye<ee;Ye++)if(ie(d,ce+Ye)!==ie(s,Ye)){fe=!1;break}if(fe)return ce}return-1}function $(d,s,a,p){a=Number(a)||0;var y=d.length-a;p?(p=Number(p))>y&&(p=y):p=y;var w=s.length;p>w/2&&(p=w/2);for(var x=0;x<p;++x){var ee=parseInt(s.substr(2*x,2),16);if(me(ee))return x;d[a+x]=ee}return x}function T(d,s,a,p){return le(c(s,d.length-a),d,a,p)}function K(d,s,a,p){return le(function I(d){for(var s=[],a=0;a<d.length;++a)s.push(255&d.charCodeAt(a));return s}(s),d,a,p)}function re(d,s,a,p){return le(X(s),d,a,p)}function _e(d,s,a,p){return le(function C(d,s){for(var a,p,w=[],x=0;x<d.length&&!((s-=2)<0);++x)p=(a=d.charCodeAt(x))>>8,w.push(a%256),w.push(p);return w}(s,d.length-a),d,a,p)}function Me(d,s,a){return e.fromByteArray(0===s&&a===d.length?d:d.slice(s,a))}function Ee(d,s,a){a=Math.min(d.length,a);for(var p=[],y=s;y<a;){var ie,ce,Ce,fe,w=d[y],x=null,ee=w>239?4:w>223?3:w>191?2:1;if(y+ee<=a)switch(ee){case 1:w<128&&(x=w);break;case 2:128==(192&(ie=d[y+1]))&&(fe=(31&w)<<6|63&ie)>127&&(x=fe);break;case 3:ce=d[y+2],128==(192&(ie=d[y+1]))&&128==(192&ce)&&(fe=(15&w)<<12|(63&ie)<<6|63&ce)>2047&&(fe<55296||fe>57343)&&(x=fe);break;case 4:ce=d[y+2],Ce=d[y+3],128==(192&(ie=d[y+1]))&&128==(192&ce)&&128==(192&Ce)&&(fe=(15&w)<<18|(63&ie)<<12|(63&ce)<<6|63&Ce)>65535&&fe<1114112&&(x=fe)}null===x?(x=65533,ee=1):x>65535&&(p.push((x-=65536)>>>10&1023|55296),x=56320|1023&x),p.push(x),y+=ee}return function De(d){var s=d.length;if(s<=Oe)return String.fromCharCode.apply(String,d);for(var a="",p=0;p<s;)a+=String.fromCharCode.apply(String,d.slice(p,p+=Oe));return a}(p)}te.kMaxLength=F,!(g.TYPED_ARRAY_SUPPORT=function m(){try{var d=new Uint8Array(1),s={foo:function(){return 42}};return Object.setPrototypeOf(s,Uint8Array.prototype),Object.setPrototypeOf(d,s),42===d.foo()}catch{return!1}}())&&typeof console<"u"&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(g.prototype,"parent",{enumerable:!0,get:function(){if(g.isBuffer(this))return this.buffer}}),Object.defineProperty(g.prototype,"offset",{enumerable:!0,get:function(){if(g.isBuffer(this))return this.byteOffset}}),g.poolSize=8192,g.from=function(d,s,a){return U(d,s,a)},Object.setPrototypeOf(g.prototype,Uint8Array.prototype),Object.setPrototypeOf(g,Uint8Array),g.alloc=function(d,s,a){return function L(d,s,a){return J(d),d<=0?D(d):void 0!==s?"string"==typeof a?D(d).fill(s,a):D(d).fill(s):D(d)}(d,s,a)},g.allocUnsafe=function(d){return z(d)},g.allocUnsafeSlow=function(d){return z(d)},g.isBuffer=function(s){return null!=s&&!0===s._isBuffer&&s!==g.prototype},g.compare=function(s,a){if(Q(s,Uint8Array)&&(s=g.from(s,s.offset,s.byteLength)),Q(a,Uint8Array)&&(a=g.from(a,a.offset,a.byteLength)),!g.isBuffer(s)||!g.isBuffer(a))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(s===a)return 0;for(var p=s.length,y=a.length,w=0,x=Math.min(p,y);w<x;++w)if(s[w]!==a[w]){p=s[w],y=a[w];break}return p<y?-1:y<p?1:0},g.isEncoding=function(s){switch(String(s).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},g.concat=function(s,a){if(!Array.isArray(s))throw new TypeError('"list" argument must be an Array of Buffers');if(0===s.length)return g.alloc(0);var p;if(void 0===a)for(a=0,p=0;p<s.length;++p)a+=s[p].length;var y=g.allocUnsafe(a),w=0;for(p=0;p<s.length;++p){var x=s[p];if(Q(x,Uint8Array))w+x.length>y.length?g.from(x).copy(y,w):Uint8Array.prototype.set.call(y,x,w);else{if(!g.isBuffer(x))throw new TypeError('"list" argument must be an Array of Buffers');x.copy(y,w)}w+=x.length}return y},g.byteLength=k,g.prototype._isBuffer=!0,g.prototype.swap16=function(){var s=this.length;if(s%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var a=0;a<s;a+=2)u(this,a,a+1);return this},g.prototype.swap32=function(){var s=this.length;if(s%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var a=0;a<s;a+=4)u(this,a,a+3),u(this,a+1,a+2);return this},g.prototype.swap64=function(){var s=this.length;if(s%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var a=0;a<s;a+=8)u(this,a,a+7),u(this,a+1,a+6),u(this,a+2,a+5),u(this,a+3,a+4);return this},g.prototype.toLocaleString=g.prototype.toString=function(){var s=this.length;return 0===s?"":0===arguments.length?Ee(this,0,s):h.apply(this,arguments)},g.prototype.equals=function(s){if(!g.isBuffer(s))throw new TypeError("Argument must be a Buffer");return this===s||0===g.compare(this,s)},g.prototype.inspect=function(){var s="",a=te.INSPECT_MAX_BYTES;return s=this.toString("hex",0,a).replace(/(.{2})/g,"$1 ").trim(),this.length>a&&(s+=" ... "),"<Buffer "+s+">"},M&&(g.prototype[M]=g.prototype.inspect),g.prototype.compare=function(s,a,p,y,w){if(Q(s,Uint8Array)&&(s=g.from(s,s.offset,s.byteLength)),!g.isBuffer(s))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof s);if(void 0===a&&(a=0),void 0===p&&(p=s?s.length:0),void 0===y&&(y=0),void 0===w&&(w=this.length),a<0||p>s.length||y<0||w>this.length)throw new RangeError("out of range index");if(y>=w&&a>=p)return 0;if(y>=w)return-1;if(a>=p)return 1;if(this===s)return 0;for(var x=(w>>>=0)-(y>>>=0),ee=(p>>>=0)-(a>>>=0),ie=Math.min(x,ee),ce=this.slice(y,w),Ce=s.slice(a,p),fe=0;fe<ie;++fe)if(ce[fe]!==Ce[fe]){x=ce[fe],ee=Ce[fe];break}return x<ee?-1:ee<x?1:0},g.prototype.includes=function(s,a,p){return-1!==this.indexOf(s,a,p)},g.prototype.indexOf=function(s,a,p){return v(this,s,a,p,!0)},g.prototype.lastIndexOf=function(s,a,p){return v(this,s,a,p,!1)},g.prototype.write=function(s,a,p,y){if(void 0===a)y="utf8",p=this.length,a=0;else if(void 0===p&&"string"==typeof a)y=a,p=this.length,a=0;else{if(!isFinite(a))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");a>>>=0,isFinite(p)?(p>>>=0,void 0===y&&(y="utf8")):(y=p,p=void 0)}var w=this.length-a;if((void 0===p||p>w)&&(p=w),s.length>0&&(p<0||a<0)||a>this.length)throw new RangeError("Attempt to write outside buffer bounds");y||(y="utf8");for(var x=!1;;)switch(y){case"hex":return $(this,s,a,p);case"utf8":case"utf-8":return T(this,s,a,p);case"ascii":case"latin1":case"binary":return K(this,s,a,p);case"base64":return re(this,s,a,p);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _e(this,s,a,p);default:if(x)throw new TypeError("Unknown encoding: "+y);y=(""+y).toLowerCase(),x=!0}},g.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Oe=4096;function ne(d,s,a){var p="";a=Math.min(d.length,a);for(var y=s;y<a;++y)p+=String.fromCharCode(127&d[y]);return p}function Xe(d,s,a){var p="";a=Math.min(d.length,a);for(var y=s;y<a;++y)p+=String.fromCharCode(d[y]);return p}function we(d,s,a){var p=d.length;(!s||s<0)&&(s=0),(!a||a<0||a>p)&&(a=p);for(var y="",w=s;w<a;++w)y+=Te[d[w]];return y}function Re(d,s,a){for(var p=d.slice(s,a),y="",w=0;w<p.length-1;w+=2)y+=String.fromCharCode(p[w]+256*p[w+1]);return y}function se(d,s,a){if(d%1!=0||d<0)throw new RangeError("offset is not uint");if(d+s>a)throw new RangeError("Trying to access beyond buffer length")}function pe(d,s,a,p,y,w){if(!g.isBuffer(d))throw new TypeError('"buffer" argument must be a Buffer instance');if(s>y||s<w)throw new RangeError('"value" argument is out of bounds');if(a+p>d.length)throw new RangeError("Index out of range")}function ke(d,s,a,p,y,w){if(a+p>d.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("Index out of range")}function be(d,s,a,p,y){return s=+s,a>>>=0,y||ke(d,0,a,4),O.write(d,s,a,p,23,4),a+4}function xe(d,s,a,p,y){return s=+s,a>>>=0,y||ke(d,0,a,8),O.write(d,s,a,p,52,8),a+8}g.prototype.slice=function(s,a){var p=this.length;(s=~~s)<0?(s+=p)<0&&(s=0):s>p&&(s=p),(a=void 0===a?p:~~a)<0?(a+=p)<0&&(a=0):a>p&&(a=p),a<s&&(a=s);var y=this.subarray(s,a);return Object.setPrototypeOf(y,g.prototype),y},g.prototype.readUintLE=g.prototype.readUIntLE=function(s,a,p){s>>>=0,a>>>=0,p||se(s,a,this.length);for(var y=this[s],w=1,x=0;++x<a&&(w*=256);)y+=this[s+x]*w;return y},g.prototype.readUintBE=g.prototype.readUIntBE=function(s,a,p){s>>>=0,a>>>=0,p||se(s,a,this.length);for(var y=this[s+--a],w=1;a>0&&(w*=256);)y+=this[s+--a]*w;return y},g.prototype.readUint8=g.prototype.readUInt8=function(s,a){return s>>>=0,a||se(s,1,this.length),this[s]},g.prototype.readUint16LE=g.prototype.readUInt16LE=function(s,a){return s>>>=0,a||se(s,2,this.length),this[s]|this[s+1]<<8},g.prototype.readUint16BE=g.prototype.readUInt16BE=function(s,a){return s>>>=0,a||se(s,2,this.length),this[s]<<8|this[s+1]},g.prototype.readUint32LE=g.prototype.readUInt32LE=function(s,a){return s>>>=0,a||se(s,4,this.length),(this[s]|this[s+1]<<8|this[s+2]<<16)+16777216*this[s+3]},g.prototype.readUint32BE=g.prototype.readUInt32BE=function(s,a){return s>>>=0,a||se(s,4,this.length),16777216*this[s]+(this[s+1]<<16|this[s+2]<<8|this[s+3])},g.prototype.readIntLE=function(s,a,p){s>>>=0,a>>>=0,p||se(s,a,this.length);for(var y=this[s],w=1,x=0;++x<a&&(w*=256);)y+=this[s+x]*w;return y>=(w*=128)&&(y-=Math.pow(2,8*a)),y},g.prototype.readIntBE=function(s,a,p){s>>>=0,a>>>=0,p||se(s,a,this.length);for(var y=a,w=1,x=this[s+--y];y>0&&(w*=256);)x+=this[s+--y]*w;return x>=(w*=128)&&(x-=Math.pow(2,8*a)),x},g.prototype.readInt8=function(s,a){return s>>>=0,a||se(s,1,this.length),128&this[s]?-1*(255-this[s]+1):this[s]},g.prototype.readInt16LE=function(s,a){s>>>=0,a||se(s,2,this.length);var p=this[s]|this[s+1]<<8;return 32768&p?4294901760|p:p},g.prototype.readInt16BE=function(s,a){s>>>=0,a||se(s,2,this.length);var p=this[s+1]|this[s]<<8;return 32768&p?4294901760|p:p},g.prototype.readInt32LE=function(s,a){return s>>>=0,a||se(s,4,this.length),this[s]|this[s+1]<<8|this[s+2]<<16|this[s+3]<<24},g.prototype.readInt32BE=function(s,a){return s>>>=0,a||se(s,4,this.length),this[s]<<24|this[s+1]<<16|this[s+2]<<8|this[s+3]},g.prototype.readFloatLE=function(s,a){return s>>>=0,a||se(s,4,this.length),O.read(this,s,!0,23,4)},g.prototype.readFloatBE=function(s,a){return s>>>=0,a||se(s,4,this.length),O.read(this,s,!1,23,4)},g.prototype.readDoubleLE=function(s,a){return s>>>=0,a||se(s,8,this.length),O.read(this,s,!0,52,8)},g.prototype.readDoubleBE=function(s,a){return s>>>=0,a||se(s,8,this.length),O.read(this,s,!1,52,8)},g.prototype.writeUintLE=g.prototype.writeUIntLE=function(s,a,p,y){s=+s,a>>>=0,p>>>=0,y||pe(this,s,a,p,Math.pow(2,8*p)-1,0);var x=1,ee=0;for(this[a]=255&s;++ee<p&&(x*=256);)this[a+ee]=s/x&255;return a+p},g.prototype.writeUintBE=g.prototype.writeUIntBE=function(s,a,p,y){s=+s,a>>>=0,p>>>=0,y||pe(this,s,a,p,Math.pow(2,8*p)-1,0);var x=p-1,ee=1;for(this[a+x]=255&s;--x>=0&&(ee*=256);)this[a+x]=s/ee&255;return a+p},g.prototype.writeUint8=g.prototype.writeUInt8=function(s,a,p){return s=+s,a>>>=0,p||pe(this,s,a,1,255,0),this[a]=255&s,a+1},g.prototype.writeUint16LE=g.prototype.writeUInt16LE=function(s,a,p){return s=+s,a>>>=0,p||pe(this,s,a,2,65535,0),this[a]=255&s,this[a+1]=s>>>8,a+2},g.prototype.writeUint16BE=g.prototype.writeUInt16BE=function(s,a,p){return s=+s,a>>>=0,p||pe(this,s,a,2,65535,0),this[a]=s>>>8,this[a+1]=255&s,a+2},g.prototype.writeUint32LE=g.prototype.writeUInt32LE=function(s,a,p){return s=+s,a>>>=0,p||pe(this,s,a,4,4294967295,0),this[a+3]=s>>>24,this[a+2]=s>>>16,this[a+1]=s>>>8,this[a]=255&s,a+4},g.prototype.writeUint32BE=g.prototype.writeUInt32BE=function(s,a,p){return s=+s,a>>>=0,p||pe(this,s,a,4,4294967295,0),this[a]=s>>>24,this[a+1]=s>>>16,this[a+2]=s>>>8,this[a+3]=255&s,a+4},g.prototype.writeIntLE=function(s,a,p,y){if(s=+s,a>>>=0,!y){var w=Math.pow(2,8*p-1);pe(this,s,a,p,w-1,-w)}var x=0,ee=1,ie=0;for(this[a]=255&s;++x<p&&(ee*=256);)s<0&&0===ie&&0!==this[a+x-1]&&(ie=1),this[a+x]=(s/ee>>0)-ie&255;return a+p},g.prototype.writeIntBE=function(s,a,p,y){if(s=+s,a>>>=0,!y){var w=Math.pow(2,8*p-1);pe(this,s,a,p,w-1,-w)}var x=p-1,ee=1,ie=0;for(this[a+x]=255&s;--x>=0&&(ee*=256);)s<0&&0===ie&&0!==this[a+x+1]&&(ie=1),this[a+x]=(s/ee>>0)-ie&255;return a+p},g.prototype.writeInt8=function(s,a,p){return s=+s,a>>>=0,p||pe(this,s,a,1,127,-128),s<0&&(s=255+s+1),this[a]=255&s,a+1},g.prototype.writeInt16LE=function(s,a,p){return s=+s,a>>>=0,p||pe(this,s,a,2,32767,-32768),this[a]=255&s,this[a+1]=s>>>8,a+2},g.prototype.writeInt16BE=function(s,a,p){return s=+s,a>>>=0,p||pe(this,s,a,2,32767,-32768),this[a]=s>>>8,this[a+1]=255&s,a+2},g.prototype.writeInt32LE=function(s,a,p){return s=+s,a>>>=0,p||pe(this,s,a,4,2147483647,-2147483648),this[a]=255&s,this[a+1]=s>>>8,this[a+2]=s>>>16,this[a+3]=s>>>24,a+4},g.prototype.writeInt32BE=function(s,a,p){return s=+s,a>>>=0,p||pe(this,s,a,4,2147483647,-2147483648),s<0&&(s=4294967295+s+1),this[a]=s>>>24,this[a+1]=s>>>16,this[a+2]=s>>>8,this[a+3]=255&s,a+4},g.prototype.writeFloatLE=function(s,a,p){return be(this,s,a,!0,p)},g.prototype.writeFloatBE=function(s,a,p){return be(this,s,a,!1,p)},g.prototype.writeDoubleLE=function(s,a,p){return xe(this,s,a,!0,p)},g.prototype.writeDoubleBE=function(s,a,p){return xe(this,s,a,!1,p)},g.prototype.copy=function(s,a,p,y){if(!g.isBuffer(s))throw new TypeError("argument should be a Buffer");if(p||(p=0),!y&&0!==y&&(y=this.length),a>=s.length&&(a=s.length),a||(a=0),y>0&&y<p&&(y=p),y===p||0===s.length||0===this.length)return 0;if(a<0)throw new RangeError("targetStart out of bounds");if(p<0||p>=this.length)throw new RangeError("Index out of range");if(y<0)throw new RangeError("sourceEnd out of bounds");y>this.length&&(y=this.length),s.length-a<y-p&&(y=s.length-a+p);var w=y-p;return this===s&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(a,p,y):Uint8Array.prototype.set.call(s,this.subarray(p,y),a),w},g.prototype.fill=function(s,a,p,y){if("string"==typeof s){if("string"==typeof a?(y=a,a=0,p=this.length):"string"==typeof p&&(y=p,p=this.length),void 0!==y&&"string"!=typeof y)throw new TypeError("encoding must be a string");if("string"==typeof y&&!g.isEncoding(y))throw new TypeError("Unknown encoding: "+y);if(1===s.length){var w=s.charCodeAt(0);("utf8"===y&&w<128||"latin1"===y)&&(s=w)}}else"number"==typeof s?s&=255:"boolean"==typeof s&&(s=Number(s));if(a<0||this.length<a||this.length<p)throw new RangeError("Out of range index");if(p<=a)return this;var x;if(a>>>=0,p=void 0===p?this.length:p>>>0,s||(s=0),"number"==typeof s)for(x=a;x<p;++x)this[x]=s;else{var ee=g.isBuffer(s)?s:g.from(s,y),ie=ee.length;if(0===ie)throw new TypeError('The value "'+s+'" is invalid for argument "value"');for(x=0;x<p-a;++x)this[x+a]=ee[x%ie]}return this};var $e=/[^+/0-9A-Za-z-_]/g;function c(d,s){s=s||1/0;for(var a,p=d.length,y=null,w=[],x=0;x<p;++x){if((a=d.charCodeAt(x))>55295&&a<57344){if(!y){if(a>56319){(s-=3)>-1&&w.push(239,191,189);continue}if(x+1===p){(s-=3)>-1&&w.push(239,191,189);continue}y=a;continue}if(a<56320){(s-=3)>-1&&w.push(239,191,189),y=a;continue}a=65536+(y-55296<<10|a-56320)}else y&&(s-=3)>-1&&w.push(239,191,189);if(y=null,a<128){if((s-=1)<0)break;w.push(a)}else if(a<2048){if((s-=2)<0)break;w.push(a>>6|192,63&a|128)}else if(a<65536){if((s-=3)<0)break;w.push(a>>12|224,a>>6&63|128,63&a|128)}else{if(!(a<1114112))throw new Error("Invalid code point");if((s-=4)<0)break;w.push(a>>18|240,a>>12&63|128,a>>6&63|128,63&a|128)}}return w}function X(d){return e.toByteArray(function _(d){if((d=(d=d.split("=")[0]).trim().replace($e,"")).length<2)return"";for(;d.length%4!=0;)d+="=";return d}(d))}function le(d,s,a,p){for(var y=0;y<p&&!(y+a>=s.length||y>=d.length);++y)s[y+a]=d[y];return y}function Q(d,s){return d instanceof s||null!=d&&null!=d.constructor&&null!=d.constructor.name&&d.constructor.name===s.name}function me(d){return d!=d}var Te=function(){for(var d="0123456789abcdef",s=new Array(256),a=0;a<16;++a)for(var p=16*a,y=0;y<16;++y)s[p+y]=d[a]+d[y];return s}()},8461:(he,te)=>{te.read=function(R,e,O,M,F){var m,D,g=8*F-M-1,U=(1<<g)-1,J=U>>1,L=-7,z=O?F-1:0,q=O?-1:1,B=R[e+z];for(z+=q,m=B&(1<<-L)-1,B>>=-L,L+=g;L>0;m=256*m+R[e+z],z+=q,L-=8);for(D=m&(1<<-L)-1,m>>=-L,L+=M;L>0;D=256*D+R[e+z],z+=q,L-=8);if(0===m)m=1-J;else{if(m===U)return D?NaN:1/0*(B?-1:1);D+=Math.pow(2,M),m-=J}return(B?-1:1)*D*Math.pow(2,m-M)},te.write=function(R,e,O,M,F,m){var D,g,U,J=8*m-F-1,L=(1<<J)-1,z=L>>1,q=23===F?Math.pow(2,-24)-Math.pow(2,-77):0,B=M?0:m-1,Y=M?1:-1,H=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(g=isNaN(e)?1:0,D=L):(D=Math.floor(Math.log(e)/Math.LN2),e*(U=Math.pow(2,-D))<1&&(D--,U*=2),(e+=D+z>=1?q/U:q*Math.pow(2,1-z))*U>=2&&(D++,U/=2),D+z>=L?(g=0,D=L):D+z>=1?(g=(e*U-1)*Math.pow(2,F),D+=z):(g=e*Math.pow(2,z-1)*Math.pow(2,F),D=0));F>=8;R[O+B]=255&g,B+=Y,g/=256,F-=8);for(D=D<<F|g,J+=F;J>0;R[O+B]=255&D,B+=Y,D/=256,J-=8);R[O+B-Y]|=128*H}},3502:(he,te,R)=>{var e=R(3172),O=e.Buffer;function M(m,D){for(var g in m)D[g]=m[g]}function F(m,D,g){return O(m,D,g)}O.from&&O.alloc&&O.allocUnsafe&&O.allocUnsafeSlow?he.exports=e:(M(e,te),te.Buffer=F),F.prototype=Object.create(O.prototype),M(O,F),F.from=function(m,D,g){if("number"==typeof m)throw new TypeError("Argument must not be a number");return O(m,D,g)},F.alloc=function(m,D,g){if("number"!=typeof m)throw new TypeError("Argument must be a number");var U=O(m);return void 0!==D?"string"==typeof g?U.fill(D,g):U.fill(D):U.fill(0),U},F.allocUnsafe=function(m){if("number"!=typeof m)throw new TypeError("Argument must be a number");return O(m)},F.allocUnsafeSlow=function(m){if("number"!=typeof m)throw new TypeError("Argument must be a number");return e.SlowBuffer(m)}},1503:(he,te,R)=>{!function(e){e.parser=function(_,c){return new M(_,c)},e.SAXParser=M,e.SAXStream=L,e.createStream=function J(_,c){return new L(_,c)},e.MAX_BUFFER_LENGTH=65536;var g,O=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function M(_,c){if(!(this instanceof M))return new M(_,c);var I=this;(function m(_){for(var c=0,I=O.length;c<I;c++)_[O[c]]=""})(I),I.q=I.c="",I.bufferCheckPosition=e.MAX_BUFFER_LENGTH,I.opt=c||{},I.opt.lowercase=I.opt.lowercase||I.opt.lowercasetags,I.looseCase=I.opt.lowercase?"toLowerCase":"toUpperCase",I.tags=[],I.closed=I.closedRoot=I.sawRoot=!1,I.tag=I.error=null,I.strict=!!_,I.noscript=!(!_&&!I.opt.noscript),I.state=T.BEGIN,I.strictEntities=I.opt.strictEntities,I.ENTITIES=Object.create(I.strictEntities?e.XML_ENTITIES:e.ENTITIES),I.attribList=[],I.opt.xmlns&&(I.ns=Object.create(H)),I.trackPosition=!1!==I.opt.position,I.trackPosition&&(I.position=I.line=I.column=0),re(I,"onready")}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(_){function c(){}return c.prototype=_,new c}),Object.keys||(Object.keys=function(_){var c=[];for(var I in _)_.hasOwnProperty(I)&&c.push(I);return c}),M.prototype={end:function(){De(this)},write:function $e(_){var c=this;if(this.error)throw this.error;if(c.closed)return Oe(c,"Cannot write after close. Assign an onready handler.");if(null===_)return De(c);"object"==typeof _&&(_=_.toString());for(var I=0,C="";C=xe(_,I++),c.c=C,C;)switch(c.trackPosition&&(c.position++,"\n"===C?(c.line++,c.column=0):c.column++),c.state){case T.BEGIN:if(c.state=T.BEGIN_WHITESPACE,"\ufeff"===C)continue;be(c,C);continue;case T.BEGIN_WHITESPACE:be(c,C);continue;case T.TEXT:if(c.sawRoot&&!c.closedRoot){for(var X=I-1;C&&"<"!==C&&"&"!==C;)(C=xe(_,I++))&&c.trackPosition&&(c.position++,"\n"===C?(c.line++,c.column=0):c.column++);c.textNode+=_.substring(X,I-1)}"<"!==C||c.sawRoot&&c.closedRoot&&!c.strict?(!h(C)&&(!c.sawRoot||c.closedRoot)&&ne(c,"Text data outside of root node."),"&"===C?c.state=T.TEXT_ENTITY:c.textNode+=C):(c.state=T.OPEN_WAKA,c.startTagPosition=c.position);continue;case T.SCRIPT:"<"===C?c.state=T.SCRIPT_ENDING:c.script+=C;continue;case T.SCRIPT_ENDING:"/"===C?c.state=T.CLOSE_TAG:(c.script+="<"+C,c.state=T.SCRIPT);continue;case T.OPEN_WAKA:"!"===C?(c.state=T.SGML_DECL,c.sgmlDecl=""):h(C)||(P(W,C)?(c.state=T.OPEN_TAG,c.tagName=C):"/"===C?(c.state=T.CLOSE_TAG,c.tagName=""):"?"===C?(c.state=T.PROC_INST,c.procInstName=c.procInstBody=""):(ne(c,"Unencoded <"),c.startTagPosition+1<c.position&&(C=new Array(c.position-c.startTagPosition).join(" ")+C),c.textNode+="<"+C,c.state=T.TEXT));continue;case T.SGML_DECL:(c.sgmlDecl+C).toUpperCase()===z?(_e(c,"onopencdata"),c.state=T.CDATA,c.sgmlDecl="",c.cdata=""):c.sgmlDecl+C==="--"?(c.state=T.COMMENT,c.comment="",c.sgmlDecl=""):(c.sgmlDecl+C).toUpperCase()===q?(c.state=T.DOCTYPE,(c.doctype||c.sawRoot)&&ne(c,"Inappropriately located doctype declaration"),c.doctype="",c.sgmlDecl=""):">"===C?(_e(c,"onsgmldeclaration",c.sgmlDecl),c.sgmlDecl="",c.state=T.TEXT):(u(C)&&(c.state=T.SGML_DECL_QUOTED),c.sgmlDecl+=C);continue;case T.SGML_DECL_QUOTED:C===c.q&&(c.state=T.SGML_DECL,c.q=""),c.sgmlDecl+=C;continue;case T.DOCTYPE:">"===C?(c.state=T.TEXT,_e(c,"ondoctype",c.doctype),c.doctype=!0):(c.doctype+=C,"["===C?c.state=T.DOCTYPE_DTD:u(C)&&(c.state=T.DOCTYPE_QUOTED,c.q=C));continue;case T.DOCTYPE_QUOTED:c.doctype+=C,C===c.q&&(c.q="",c.state=T.DOCTYPE);continue;case T.DOCTYPE_DTD:c.doctype+=C,"]"===C?c.state=T.DOCTYPE:u(C)&&(c.state=T.DOCTYPE_DTD_QUOTED,c.q=C);continue;case T.DOCTYPE_DTD_QUOTED:c.doctype+=C,C===c.q&&(c.state=T.DOCTYPE_DTD,c.q="");continue;case T.COMMENT:"-"===C?c.state=T.COMMENT_ENDING:c.comment+=C;continue;case T.COMMENT_ENDING:"-"===C?(c.state=T.COMMENT_ENDED,c.comment=Ee(c.opt,c.comment),c.comment&&_e(c,"oncomment",c.comment),c.comment=""):(c.comment+="-"+C,c.state=T.COMMENT);continue;case T.COMMENT_ENDED:">"!==C?(ne(c,"Malformed comment"),c.comment+="--"+C,c.state=T.COMMENT):c.state=T.TEXT;continue;case T.CDATA:"]"===C?c.state=T.CDATA_ENDING:c.cdata+=C;continue;case T.CDATA_ENDING:"]"===C?c.state=T.CDATA_ENDING_2:(c.cdata+="]"+C,c.state=T.CDATA);continue;case T.CDATA_ENDING_2:">"===C?(c.cdata&&_e(c,"oncdata",c.cdata),_e(c,"onclosecdata"),c.cdata="",c.state=T.TEXT):"]"===C?c.cdata+="]":(c.cdata+="]]"+C,c.state=T.CDATA);continue;case T.PROC_INST:"?"===C?c.state=T.PROC_INST_ENDING:h(C)?c.state=T.PROC_INST_BODY:c.procInstName+=C;continue;case T.PROC_INST_BODY:if(!c.procInstBody&&h(C))continue;"?"===C?c.state=T.PROC_INST_ENDING:c.procInstBody+=C;continue;case T.PROC_INST_ENDING:">"===C?(_e(c,"onprocessinginstruction",{name:c.procInstName,body:c.procInstBody}),c.procInstName=c.procInstBody="",c.state=T.TEXT):(c.procInstBody+="?"+C,c.state=T.PROC_INST_BODY);continue;case T.OPEN_TAG:P(oe,C)?c.tagName+=C:(Xe(c),">"===C?se(c):"/"===C?c.state=T.OPEN_TAG_SLASH:(h(C)||ne(c,"Invalid character in tag name"),c.state=T.ATTRIB));continue;case T.OPEN_TAG_SLASH:">"===C?(se(c,!0),pe(c)):(ne(c,"Forward-slash in opening tag not followed by >"),c.state=T.ATTRIB);continue;case T.ATTRIB:if(h(C))continue;">"===C?se(c):"/"===C?c.state=T.OPEN_TAG_SLASH:P(W,C)?(c.attribName=C,c.attribValue="",c.state=T.ATTRIB_NAME):ne(c,"Invalid attribute name");continue;case T.ATTRIB_NAME:"="===C?c.state=T.ATTRIB_VALUE:">"===C?(ne(c,"Attribute without value"),c.attribValue=c.attribName,Re(c),se(c)):h(C)?c.state=T.ATTRIB_NAME_SAW_WHITE:P(oe,C)?c.attribName+=C:ne(c,"Invalid attribute name");continue;case T.ATTRIB_NAME_SAW_WHITE:if("="===C)c.state=T.ATTRIB_VALUE;else{if(h(C))continue;ne(c,"Attribute without value"),c.tag.attributes[c.attribName]="",c.attribValue="",_e(c,"onattribute",{name:c.attribName,value:""}),c.attribName="",">"===C?se(c):P(W,C)?(c.attribName=C,c.state=T.ATTRIB_NAME):(ne(c,"Invalid attribute name"),c.state=T.ATTRIB)}continue;case T.ATTRIB_VALUE:if(h(C))continue;u(C)?(c.q=C,c.state=T.ATTRIB_VALUE_QUOTED):(ne(c,"Unquoted attribute value"),c.state=T.ATTRIB_VALUE_UNQUOTED,c.attribValue=C);continue;case T.ATTRIB_VALUE_QUOTED:if(C!==c.q){"&"===C?c.state=T.ATTRIB_VALUE_ENTITY_Q:c.attribValue+=C;continue}Re(c),c.q="",c.state=T.ATTRIB_VALUE_CLOSED;continue;case T.ATTRIB_VALUE_CLOSED:h(C)?c.state=T.ATTRIB:">"===C?se(c):"/"===C?c.state=T.OPEN_TAG_SLASH:P(W,C)?(ne(c,"No whitespace between attributes"),c.attribName=C,c.attribValue="",c.state=T.ATTRIB_NAME):ne(c,"Invalid attribute name");continue;case T.ATTRIB_VALUE_UNQUOTED:if(!v(C)){"&"===C?c.state=T.ATTRIB_VALUE_ENTITY_U:c.attribValue+=C;continue}Re(c),">"===C?se(c):c.state=T.ATTRIB;continue;case T.CLOSE_TAG:if(c.tagName)">"===C?pe(c):P(oe,C)?c.tagName+=C:c.script?(c.script+="</"+c.tagName,c.tagName="",c.state=T.SCRIPT):(h(C)||ne(c,"Invalid tagname in closing tag"),c.state=T.CLOSE_TAG_SAW_WHITE);else{if(h(C))continue;$(W,C)?c.script?(c.script+="</"+C,c.state=T.SCRIPT):ne(c,"Invalid tagname in closing tag."):c.tagName=C}continue;case T.CLOSE_TAG_SAW_WHITE:if(h(C))continue;">"===C?pe(c):ne(c,"Invalid characters in closing tag");continue;case T.TEXT_ENTITY:case T.ATTRIB_VALUE_ENTITY_Q:case T.ATTRIB_VALUE_ENTITY_U:var Q,me;switch(c.state){case T.TEXT_ENTITY:Q=T.TEXT,me="textNode";break;case T.ATTRIB_VALUE_ENTITY_Q:Q=T.ATTRIB_VALUE_QUOTED,me="attribValue";break;case T.ATTRIB_VALUE_ENTITY_U:Q=T.ATTRIB_VALUE_UNQUOTED,me="attribValue"}";"===C?(c[me]+=ke(c),c.entity="",c.state=Q):P(c.entity.length?k:N,C)?c.entity+=C:(ne(c,"Invalid character in entity name"),c[me]+="&"+c.entity+C,c.entity="",c.state=Q);continue;default:throw new Error(c,"Unknown state: "+c.state)}return c.position>=c.bufferCheckPosition&&function F(_){for(var c=Math.max(e.MAX_BUFFER_LENGTH,10),I=0,C=0,X=O.length;C<X;C++){var le=_[O[C]].length;if(le>c)switch(O[C]){case"textNode":Me(_);break;case"cdata":_e(_,"oncdata",_.cdata),_.cdata="";break;case"script":_e(_,"onscript",_.script),_.script="";break;default:Oe(_,"Max buffer length exceeded: "+O[C])}I=Math.max(I,le)}_.bufferCheckPosition=e.MAX_BUFFER_LENGTH-I+_.position}(c),c},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){!function D(_){Me(_),""!==_.cdata&&(_e(_,"oncdata",_.cdata),_.cdata=""),""!==_.script&&(_e(_,"onscript",_.script),_.script="")}(this)}};try{g=Object(function(){var c=new Error("Cannot find module 'stream'");throw c.code="MODULE_NOT_FOUND",c}())}catch{g=function(){}}var U=e.EVENTS.filter(function(_){return"error"!==_&&"end"!==_});function L(_,c){if(!(this instanceof L))return new L(_,c);g.apply(this),this._parser=new M(_,c),this.writable=!0,this.readable=!0;var I=this;this._parser.onend=function(){I.emit("end")},this._parser.onerror=function(C){I.emit("error",C),I._parser.error=null},this._decoder=null,U.forEach(function(C){Object.defineProperty(I,"on"+C,{get:function(){return I._parser["on"+C]},set:function(X){if(!X)return I.removeAllListeners(C),I._parser["on"+C]=X,X;I.on(C,X)},enumerable:!0,configurable:!1})})}(L.prototype=Object.create(g.prototype,{constructor:{value:L}})).write=function(_){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(_)){if(!this._decoder){var c=R(3054).s;this._decoder=new c("utf8")}_=this._decoder.write(_)}return this._parser.write(_.toString()),this.emit("data",_),!0},L.prototype.end=function(_){return _&&_.length&&this.write(_),this._parser.end(),!0},L.prototype.on=function(_,c){var I=this;return!I._parser["on"+_]&&-1!==U.indexOf(_)&&(I._parser["on"+_]=function(){var C=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);C.splice(0,0,_),I.emit.apply(I,C)}),g.prototype.on.call(I,_,c)};var z="[CDATA[",q="DOCTYPE",B="http://www.w3.org/XML/1998/namespace",Y="http://www.w3.org/2000/xmlns/",H={xml:B,xmlns:Y},W=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,oe=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,N=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,k=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function h(_){return" "===_||"\n"===_||"\r"===_||"\t"===_}function u(_){return'"'===_||"'"===_}function v(_){return">"===_||h(_)}function P(_,c){return _.test(c)}function $(_,c){return!P(_,c)}var _,c,I,T=0;for(var K in e.STATE={BEGIN:T++,BEGIN_WHITESPACE:T++,TEXT:T++,TEXT_ENTITY:T++,OPEN_WAKA:T++,SGML_DECL:T++,SGML_DECL_QUOTED:T++,DOCTYPE:T++,DOCTYPE_QUOTED:T++,DOCTYPE_DTD:T++,DOCTYPE_DTD_QUOTED:T++,COMMENT_STARTING:T++,COMMENT:T++,COMMENT_ENDING:T++,COMMENT_ENDED:T++,CDATA:T++,CDATA_ENDING:T++,CDATA_ENDING_2:T++,PROC_INST:T++,PROC_INST_BODY:T++,PROC_INST_ENDING:T++,OPEN_TAG:T++,OPEN_TAG_SLASH:T++,ATTRIB:T++,ATTRIB_NAME:T++,ATTRIB_NAME_SAW_WHITE:T++,ATTRIB_VALUE:T++,ATTRIB_VALUE_QUOTED:T++,ATTRIB_VALUE_CLOSED:T++,ATTRIB_VALUE_UNQUOTED:T++,ATTRIB_VALUE_ENTITY_Q:T++,ATTRIB_VALUE_ENTITY_U:T++,CLOSE_TAG:T++,CLOSE_TAG_SAW_WHITE:T++,SCRIPT:T++,SCRIPT_ENDING:T++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(_){var c=e.ENTITIES[_],I="number"==typeof c?String.fromCharCode(c):c;e.ENTITIES[_]=I}),e.STATE)e.STATE[e.STATE[K]]=K;function re(_,c,I){_[c]&&_[c](I)}function _e(_,c,I){_.textNode&&Me(_),re(_,c,I)}function Me(_){_.textNode=Ee(_.opt,_.textNode),_.textNode&&re(_,"ontext",_.textNode),_.textNode=""}function Ee(_,c){return _.trim&&(c=c.trim()),_.normalize&&(c=c.replace(/\s+/g," ")),c}function Oe(_,c){return Me(_),_.trackPosition&&(c+="\nLine: "+_.line+"\nColumn: "+_.column+"\nChar: "+_.c),c=new Error(c),_.error=c,re(_,"onerror",c),_}function De(_){return _.sawRoot&&!_.closedRoot&&ne(_,"Unclosed root tag"),_.state!==T.BEGIN&&_.state!==T.BEGIN_WHITESPACE&&_.state!==T.TEXT&&Oe(_,"Unexpected end"),Me(_),_.c="",_.closed=!0,re(_,"onend"),M.call(_,_.strict,_.opt),_}function ne(_,c){if("object"!=typeof _||!(_ instanceof M))throw new Error("bad call to strictFail");_.strict&&Oe(_,c)}function Xe(_){_.strict||(_.tagName=_.tagName[_.looseCase]());var c=_.tags[_.tags.length-1]||_,I=_.tag={name:_.tagName,attributes:{}};_.opt.xmlns&&(I.ns=c.ns),_.attribList.length=0,_e(_,"onopentagstart",I)}function we(_,c){var C=_.indexOf(":")<0?["",_]:_.split(":"),X=C[0],le=C[1];return c&&"xmlns"===_&&(X="xmlns",le=""),{prefix:X,local:le}}function Re(_){if(_.strict||(_.attribName=_.attribName[_.looseCase]()),-1!==_.attribList.indexOf(_.attribName)||_.tag.attributes.hasOwnProperty(_.attribName))_.attribName=_.attribValue="";else{if(_.opt.xmlns){var c=we(_.attribName,!0),C=c.local;if("xmlns"===c.prefix)if("xml"===C&&_.attribValue!==B)ne(_,"xml: prefix must be bound to "+B+"\nActual: "+_.attribValue);else if("xmlns"===C&&_.attribValue!==Y)ne(_,"xmlns: prefix must be bound to "+Y+"\nActual: "+_.attribValue);else{var X=_.tag,le=_.tags[_.tags.length-1]||_;X.ns===le.ns&&(X.ns=Object.create(le.ns)),X.ns[C]=_.attribValue}_.attribList.push([_.attribName,_.attribValue])}else _.tag.attributes[_.attribName]=_.attribValue,_e(_,"onattribute",{name:_.attribName,value:_.attribValue});_.attribName=_.attribValue=""}}function se(_,c){if(_.opt.xmlns){var I=_.tag,C=we(_.tagName);I.prefix=C.prefix,I.local=C.local,I.uri=I.ns[C.prefix]||"",I.prefix&&!I.uri&&(ne(_,"Unbound namespace prefix: "+JSON.stringify(_.tagName)),I.uri=C.prefix),I.ns&&(_.tags[_.tags.length-1]||_).ns!==I.ns&&Object.keys(I.ns).forEach(function(x){_e(_,"onopennamespace",{prefix:x,uri:I.ns[x]})});for(var le=0,Q=_.attribList.length;le<Q;le++){var me=_.attribList[le],Te=me[0],d=me[1],s=we(Te,!0),a=s.prefix,y=""===a?"":I.ns[a]||"",w={name:Te,value:d,prefix:a,local:s.local,uri:y};a&&"xmlns"!==a&&!y&&(ne(_,"Unbound namespace prefix: "+JSON.stringify(a)),w.uri=a),_.tag.attributes[Te]=w,_e(_,"onattribute",w)}_.attribList.length=0}_.tag.isSelfClosing=!!c,_.sawRoot=!0,_.tags.push(_.tag),_e(_,"onopentag",_.tag),c||(_.state=_.noscript||"script"!==_.tagName.toLowerCase()?T.TEXT:T.SCRIPT,_.tag=null,_.tagName=""),_.attribName=_.attribValue="",_.attribList.length=0}function pe(_){if(!_.tagName)return ne(_,"Weird empty close tag."),_.textNode+="</>",void(_.state=T.TEXT);if(_.script){if("script"!==_.tagName)return _.script+="</"+_.tagName+">",_.tagName="",void(_.state=T.SCRIPT);_e(_,"onscript",_.script),_.script=""}var c=_.tags.length,I=_.tagName;_.strict||(I=I[_.looseCase]());for(var C=I;c--&&_.tags[c].name!==C;)ne(_,"Unexpected close tag");if(c<0)return ne(_,"Unmatched closing tag: "+_.tagName),_.textNode+="</"+_.tagName+">",void(_.state=T.TEXT);_.tagName=I;for(var le=_.tags.length;le-- >c;){var Q=_.tag=_.tags.pop();_.tagName=_.tag.name,_e(_,"onclosetag",_.tagName);var me={};for(var Te in Q.ns)me[Te]=Q.ns[Te];_.opt.xmlns&&Q.ns!==(_.tags[_.tags.length-1]||_).ns&&Object.keys(Q.ns).forEach(function(s){_e(_,"onclosenamespace",{prefix:s,uri:Q.ns[s]})})}0===c&&(_.closedRoot=!0),_.tagName=_.attribValue=_.attribName="",_.attribList.length=0,_.state=T.TEXT}function ke(_){var C,c=_.entity,I=c.toLowerCase(),X="";return _.ENTITIES[c]?_.ENTITIES[c]:_.ENTITIES[I]?_.ENTITIES[I]:("#"===(c=I).charAt(0)&&("x"===c.charAt(1)?(c=c.slice(2),X=(C=parseInt(c,16)).toString(16)):(c=c.slice(1),X=(C=parseInt(c,10)).toString(10))),c=c.replace(/^0+/,""),isNaN(C)||X.toLowerCase()!==c?(ne(_,"Invalid character entity"),"&"+_.entity+";"):String.fromCodePoint(C))}function be(_,c){"<"===c?(_.state=T.OPEN_WAKA,_.startTagPosition=_.position):h(c)||(ne(_,"Non-whitespace before first tag."),_.textNode=c,_.state=T.TEXT)}function xe(_,c){var I="";return c<_.length&&(I=_.charAt(c)),I}T=e.STATE,String.fromCodePoint||(_=String.fromCharCode,c=Math.floor,I=function(){var X=[],me=-1,Te=arguments.length;if(!Te)return"";for(var d="";++me<Te;){var s=Number(arguments[me]);if(!isFinite(s)||s<0||s>1114111||c(s)!==s)throw RangeError("Invalid code point: "+s);s<=65535?X.push(s):X.push(55296+((s-=65536)>>10),s%1024+56320),(me+1===Te||X.length>16384)&&(d+=_.apply(null,X),X.length=0)}return d},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:I,configurable:!0,writable:!0}):String.fromCodePoint=I)}(te)},3054:(he,te,R)=>{"use strict";var e=R(3502).Buffer,O=e.isEncoding||function(N){switch((N=""+N)&&N.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function m(N){var k;switch(this.encoding=function F(N){var k=function M(N){if(!N)return"utf8";for(var k;;)switch(N){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return N;default:if(k)return;N=(""+N).toLowerCase(),k=!0}}(N);if("string"!=typeof k&&(e.isEncoding===O||!O(N)))throw new Error("Unknown encoding: "+N);return k||N}(N),this.encoding){case"utf16le":this.text=q,this.end=B,k=4;break;case"utf8":this.fillLast=J,k=4;break;case"base64":this.text=Y,this.end=H,k=3;break;default:return this.write=W,void(this.end=oe)}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(k)}function D(N){return N<=127?0:N>>5==6?2:N>>4==14?3:N>>3==30?4:N>>6==2?-1:-2}function J(N){var k=this.lastTotal-this.lastNeed,h=function U(N,k,h){if(128!=(192&k[0]))return N.lastNeed=0,"\ufffd";if(N.lastNeed>1&&k.length>1){if(128!=(192&k[1]))return N.lastNeed=1,"\ufffd";if(N.lastNeed>2&&k.length>2&&128!=(192&k[2]))return N.lastNeed=2,"\ufffd"}}(this,N);return void 0!==h?h:this.lastNeed<=N.length?(N.copy(this.lastChar,k,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(N.copy(this.lastChar,k,0,N.length),void(this.lastNeed-=N.length))}function q(N,k){if((N.length-k)%2==0){var h=N.toString("utf16le",k);if(h){var u=h.charCodeAt(h.length-1);if(u>=55296&&u<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=N[N.length-2],this.lastChar[1]=N[N.length-1],h.slice(0,-1)}return h}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=N[N.length-1],N.toString("utf16le",k,N.length-1)}function B(N){var k=N&&N.length?this.write(N):"";return this.lastNeed?k+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):k}function Y(N,k){var h=(N.length-k)%3;return 0===h?N.toString("base64",k):(this.lastNeed=3-h,this.lastTotal=3,1===h?this.lastChar[0]=N[N.length-1]:(this.lastChar[0]=N[N.length-2],this.lastChar[1]=N[N.length-1]),N.toString("base64",k,N.length-h))}function H(N){var k=N&&N.length?this.write(N):"";return this.lastNeed?k+this.lastChar.toString("base64",0,3-this.lastNeed):k}function W(N){return N.toString(this.encoding)}function oe(N){return N&&N.length?this.write(N):""}te.s=m,m.prototype.write=function(N){if(0===N.length)return"";var k,h;if(this.lastNeed){if(void 0===(k=this.fillLast(N)))return"";h=this.lastNeed,this.lastNeed=0}else h=0;return h<N.length?k?k+this.text(N,h):this.text(N,h):k||""},m.prototype.end=function z(N){var k=N&&N.length?this.write(N):"";return this.lastNeed?k+"\ufffd":k},m.prototype.text=function L(N,k){var h=function g(N,k,h){var u=k.length-1;if(u<h)return 0;var v=D(k[u]);return v>=0?(v>0&&(N.lastNeed=v-1),v):--u<h||-2===v?0:(v=D(k[u]))>=0?(v>0&&(N.lastNeed=v-2),v):--u<h||-2===v?0:(v=D(k[u]))>=0?(v>0&&(2===v?v=0:N.lastNeed=v-3),v):0}(this,N,k);if(!this.lastNeed)return N.toString("utf8",k);this.lastTotal=h;var u=N.length-(h-this.lastNeed);return N.copy(this.lastChar,0,u),N.toString("utf8",k,u)},m.prototype.fillLast=function(N){if(this.lastNeed<=N.length)return N.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);N.copy(this.lastChar,this.lastTotal-this.lastNeed,0,N.length),this.lastNeed-=N.length}},7234:he=>{"use strict";var te=/([=:@$/])/g,R=/([&;/])/g,e=/[=:@$]/,O=/[&;]/;function M(g,U){return encodeURI(g.replace(U,"/$1"))}he.exports={stringify:function m(g,U){if(!U)return function F(g){return"string"==typeof g?g.replace(/;+$/g,""):g}(m(g,!0));if("number"==typeof g||!0===g||!1===g||null===g)return":"+g;var J=[];if(g instanceof Array){for(var L=0;L<g.length;++L)J.push(typeof g[L]>"u"?":null":m(g[L],!0));return"@"+J.join("&")+";"}if("object"==typeof g){for(var z in g){var q=m(g[z],!0);q&&J.push(M(z,te)+q)}return"$"+J.join("&")+";"}return typeof g>"u"?void 0:"="+M(g.toString(),R)},parse:function D(g){var U=0;function J(z){for(var q="";U!==g.length;++U){if("/"===g.charAt(U)){if((U+=1)===g.length){q+=";";break}}else if(g.charAt(U).match(z))break;q+=g.charAt(U)}return q}return g=decodeURI(g),function L(){var B,z=g.charAt(U++);if("="===z)return J(O);if(":"===z){var q=J(O);return"true"===q||"false"!==q&&(q=parseFloat(q),isNaN(q)?null:q)}if("@"===z){B=[];e:if(!(U>=g.length||";"===g.charAt(U)))for(;;){if(B.push(L()),U>=g.length||";"===g.charAt(U))break e;U+=1}return U+=1,B}if("$"===z){B={};e:if(!(U>=g.length||";"===g.charAt(U)))for(;;){if(B[J(e)]=L(),U>=g.length||";"===g.charAt(U))break e;U+=1}return U+=1,B}throw new Error("Unexpected char "+z)}()}}},5097:he=>{he.exports={isArray:function(te){return Array.isArray?Array.isArray(te):"[object Array]"===Object.prototype.toString.call(te)}}},9220:(he,te,R)=>{var e=R(9910),O=R(6976),M=R(3559),F=R(1097);he.exports={xml2js:e,xml2json:O,js2xml:M,json2xml:F}},3559:(he,te,R)=>{var M,F,e=R(5886),O=R(5097).isArray;function D(h,u,v){return(!v&&h.spaces?"\n":"")+Array(u+1).join(h.spaces)}function g(h,u,v){if(u.ignoreAttributes)return"";"attributesFn"in u&&(h=u.attributesFn(h,F,M));var P,$,T,K,re=[];for(P in h)h.hasOwnProperty(P)&&null!=h[P]&&(K=u.noQuotesForNativeAttributes&&"string"!=typeof h[P]?"":'"',$=($=""+h[P]).replace(/"/g,"&quot;"),T="attributeNameFn"in u?u.attributeNameFn(P,$,F,M):P,re.push(u.spaces&&u.indentAttributes?D(u,v+1,!1):" "),re.push(T+"="+K+("attributeValueFn"in u?u.attributeValueFn($,P,F,M):$)+K));return h&&Object.keys(h).length&&u.spaces&&u.indentAttributes&&re.push(D(u,v,!1)),re.join("")}function U(h,u,v){return M=h,F="xml",u.ignoreDeclaration?"":"<?xml"+g(h[u.attributesKey],u,v)+"?>"}function J(h,u,v){if(u.ignoreInstruction)return"";var P;for(P in h)if(h.hasOwnProperty(P))break;var $="instructionNameFn"in u?u.instructionNameFn(P,h[P],F,M):P;if("object"==typeof h[P])return M=h,F=$,"<?"+$+g(h[P][u.attributesKey],u,v)+"?>";var T=h[P]?h[P]:"";return"instructionFn"in u&&(T=u.instructionFn(T,P,F,M)),"<?"+$+(T?" "+T:"")+"?>"}function L(h,u){return u.ignoreComment?"":"\x3c!--"+("commentFn"in u?u.commentFn(h,F,M):h)+"--\x3e"}function z(h,u){return u.ignoreCdata?"":"<![CDATA["+("cdataFn"in u?u.cdataFn(h,F,M):h.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function q(h,u){return u.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in u?u.doctypeFn(h,F,M):h)+">"}function B(h,u){return u.ignoreText?"":(h=(h=(h=""+h).replace(/&amp;/g,"&")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in u?u.textFn(h,F,M):h)}function W(h,u,v,P){return h.reduce(function($,T){var K=D(u,v,P&&!$);switch(T.type){case"element":return $+K+function H(h,u,v){M=h,F=h.name;var P=[],$="elementNameFn"in u?u.elementNameFn(h.name,h):h.name;P.push("<"+$),h[u.attributesKey]&&P.push(g(h[u.attributesKey],u,v));var T=h[u.elementsKey]&&h[u.elementsKey].length||h[u.attributesKey]&&"preserve"===h[u.attributesKey]["xml:space"];return T||(T="fullTagEmptyElementFn"in u?u.fullTagEmptyElementFn(h.name,h):u.fullTagEmptyElement),T?(P.push(">"),h[u.elementsKey]&&h[u.elementsKey].length&&(P.push(W(h[u.elementsKey],u,v+1)),M=h,F=h.name),P.push(u.spaces&&function Y(h,u){var v;if(h.elements&&h.elements.length)for(v=0;v<h.elements.length;++v)switch(h.elements[v][u.typeKey]){case"text":if(u.indentText)return!0;break;case"cdata":if(u.indentCdata)return!0;break;case"instruction":if(u.indentInstruction)return!0;break;default:return!0}return!1}(h,u)?"\n"+Array(v+1).join(u.spaces):""),P.push("</"+$+">")):P.push("/>"),P.join("")}(T,u,v);case"comment":return $+K+L(T[u.commentKey],u);case"doctype":return $+K+q(T[u.doctypeKey],u);case"cdata":return $+(u.indentCdata?K:"")+z(T[u.cdataKey],u);case"text":return $+(u.indentText?K:"")+B(T[u.textKey],u);case"instruction":var re={};return re[T[u.nameKey]]=T[u.attributesKey]?T:T[u.instructionKey],$+(u.indentInstruction?K:"")+J(re,u,v)}},"")}function oe(h,u,v){var P;for(P in h)if(h.hasOwnProperty(P))switch(P){case u.parentKey:case u.attributesKey:break;case u.textKey:if(u.indentText||v)return!0;break;case u.cdataKey:if(u.indentCdata||v)return!0;break;case u.instructionKey:if(u.indentInstruction||v)return!0;break;default:return!0}return!1}function N(h,u,v,P,$){M=h,F=u;var T="elementNameFn"in v?v.elementNameFn(u,h):u;if(typeof h>"u"||null===h||""===h)return"fullTagEmptyElementFn"in v&&v.fullTagEmptyElementFn(u,h)||v.fullTagEmptyElement?"<"+T+"></"+T+">":"<"+T+"/>";var K=[];if(u){if(K.push("<"+T),"object"!=typeof h)return K.push(">"+B(h,v)+"</"+T+">"),K.join("");h[v.attributesKey]&&K.push(g(h[v.attributesKey],v,P));var re=oe(h,v,!0)||h[v.attributesKey]&&"preserve"===h[v.attributesKey]["xml:space"];if(re||(re="fullTagEmptyElementFn"in v?v.fullTagEmptyElementFn(u,h):v.fullTagEmptyElement),!re)return K.push("/>"),K.join("");K.push(">")}return K.push(k(h,v,P+1,!1)),M=h,F=u,u&&K.push(($?D(v,P,!1):"")+"</"+T+">"),K.join("")}function k(h,u,v,P){var $,T,K,re=[];for(T in h)if(h.hasOwnProperty(T))for(K=O(h[T])?h[T]:[h[T]],$=0;$<K.length;++$){switch(T){case u.declarationKey:re.push(U(K[$],u,v));break;case u.instructionKey:re.push((u.indentInstruction?D(u,v,P):"")+J(K[$],u,v));break;case u.attributesKey:case u.parentKey:break;case u.textKey:re.push((u.indentText?D(u,v,P):"")+B(K[$],u));break;case u.cdataKey:re.push((u.indentCdata?D(u,v,P):"")+z(K[$],u));break;case u.doctypeKey:re.push(D(u,v,P)+q(K[$],u));break;case u.commentKey:re.push(D(u,v,P)+L(K[$],u));break;default:re.push(D(u,v,P)+N(K[$],T,u,v,oe(K[$],u)))}P=P&&!re.length}return re.join("")}he.exports=function(h,u){u=function m(h){var u=e.copyOptions(h);return e.ensureFlagExists("ignoreDeclaration",u),e.ensureFlagExists("ignoreInstruction",u),e.ensureFlagExists("ignoreAttributes",u),e.ensureFlagExists("ignoreText",u),e.ensureFlagExists("ignoreComment",u),e.ensureFlagExists("ignoreCdata",u),e.ensureFlagExists("ignoreDoctype",u),e.ensureFlagExists("compact",u),e.ensureFlagExists("indentText",u),e.ensureFlagExists("indentCdata",u),e.ensureFlagExists("indentAttributes",u),e.ensureFlagExists("indentInstruction",u),e.ensureFlagExists("fullTagEmptyElement",u),e.ensureFlagExists("noQuotesForNativeAttributes",u),e.ensureSpacesExists(u),"number"==typeof u.spaces&&(u.spaces=Array(u.spaces+1).join(" ")),e.ensureKeyExists("declaration",u),e.ensureKeyExists("instruction",u),e.ensureKeyExists("attributes",u),e.ensureKeyExists("text",u),e.ensureKeyExists("comment",u),e.ensureKeyExists("cdata",u),e.ensureKeyExists("doctype",u),e.ensureKeyExists("type",u),e.ensureKeyExists("name",u),e.ensureKeyExists("elements",u),e.checkFnExists("doctype",u),e.checkFnExists("instruction",u),e.checkFnExists("cdata",u),e.checkFnExists("comment",u),e.checkFnExists("text",u),e.checkFnExists("instructionName",u),e.checkFnExists("elementName",u),e.checkFnExists("attributeName",u),e.checkFnExists("attributeValue",u),e.checkFnExists("attributes",u),e.checkFnExists("fullTagEmptyElement",u),u}(u);var v=[];return M=h,F="_root_",u.compact?v.push(k(h,u,0,!0)):(h[u.declarationKey]&&v.push(U(h[u.declarationKey],u,0)),h[u.elementsKey]&&h[u.elementsKey].length&&v.push(W(h[u.elementsKey],u,0,!v.length))),v.join("")}},1097:(he,te,R)=>{var e=R(3559);he.exports=function(O,M){O instanceof Buffer&&(O=O.toString());var F=null;if("string"==typeof O)try{F=JSON.parse(O)}catch{throw new Error("The JSON structure is invalid")}else F=O;return e(F,M)}},5886:(he,te,R)=>{var e=R(5097).isArray;he.exports={copyOptions:function(O){var M,F={};for(M in O)O.hasOwnProperty(M)&&(F[M]=O[M]);return F},ensureFlagExists:function(O,M){(!(O in M)||"boolean"!=typeof M[O])&&(M[O]=!1)},ensureSpacesExists:function(O){(!("spaces"in O)||"number"!=typeof O.spaces&&"string"!=typeof O.spaces)&&(O.spaces=0)},ensureAlwaysArrayExists:function(O){(!("alwaysArray"in O)||"boolean"!=typeof O.alwaysArray&&!e(O.alwaysArray))&&(O.alwaysArray=!1)},ensureKeyExists:function(O,M){(!(O+"Key"in M)||"string"!=typeof M[O+"Key"])&&(M[O+"Key"]=M.compact?"_"+O:O)},checkFnExists:function(O,M){return O+"Fn"in M}}},9910:(he,te,R)=>{var m,g,e=R(1503),M=R(5886),F=R(5097).isArray;function J(h){var u=Number(h);if(!isNaN(u))return u;var v=h.toLowerCase();return"true"===v||"false"!==v&&h}function L(h,u){var v;if(m.compact){if(!g[m[h+"Key"]]&&(F(m.alwaysArray)?-1!==m.alwaysArray.indexOf(m[h+"Key"]):m.alwaysArray)&&(g[m[h+"Key"]]=[]),g[m[h+"Key"]]&&!F(g[m[h+"Key"]])&&(g[m[h+"Key"]]=[g[m[h+"Key"]]]),h+"Fn"in m&&"string"==typeof u&&(u=m[h+"Fn"](u,g)),"instruction"===h&&("instructionFn"in m||"instructionNameFn"in m))for(v in u)if(u.hasOwnProperty(v))if("instructionFn"in m)u[v]=m.instructionFn(u[v],v,g);else{var P=u[v];delete u[v],u[m.instructionNameFn(v,P,g)]=P}F(g[m[h+"Key"]])?g[m[h+"Key"]].push(u):g[m[h+"Key"]]=u}else{g[m.elementsKey]||(g[m.elementsKey]=[]);var $={};if($[m.typeKey]=h,"instruction"===h){for(v in u)if(u.hasOwnProperty(v))break;$[m.nameKey]="instructionNameFn"in m?m.instructionNameFn(v,u,g):v,m.instructionHasAttributes?($[m.attributesKey]=u[v][m.attributesKey],"instructionFn"in m&&($[m.attributesKey]=m.instructionFn($[m.attributesKey],v,g))):("instructionFn"in m&&(u[v]=m.instructionFn(u[v],v,g)),$[m.instructionKey]=u[v])}else h+"Fn"in m&&(u=m[h+"Fn"](u,g)),$[m[h+"Key"]]=u;m.addParent&&($[m.parentKey]=g),g[m.elementsKey].push($)}}function z(h){var u;if("attributesFn"in m&&h&&(h=m.attributesFn(h,g)),(m.trim||"attributeValueFn"in m||"attributeNameFn"in m||m.nativeTypeAttributes)&&h)for(u in h)if(h.hasOwnProperty(u)&&(m.trim&&(h[u]=h[u].trim()),m.nativeTypeAttributes&&(h[u]=J(h[u])),"attributeValueFn"in m&&(h[u]=m.attributeValueFn(h[u],u,g)),"attributeNameFn"in m)){var v=h[u];delete h[u],h[m.attributeNameFn(u,h[u],g)]=v}return h}function q(h){var u={};if(h.body&&("xml"===h.name.toLowerCase()||m.instructionHasAttributes)){for(var P,v=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g;null!==(P=v.exec(h.body));)u[P[1]]=P[2]||P[3]||P[4];u=z(u)}if("xml"===h.name.toLowerCase()){if(m.ignoreDeclaration)return;g[m.declarationKey]={},Object.keys(u).length&&(g[m.declarationKey][m.attributesKey]=u),m.addParent&&(g[m.declarationKey][m.parentKey]=g)}else{if(m.ignoreInstruction)return;m.trim&&(h.body=h.body.trim());var $={};m.instructionHasAttributes&&Object.keys(u).length?($[h.name]={},$[h.name][m.attributesKey]=u):$[h.name]=h.body,L("instruction",$)}}function B(h,u){var v;if("object"==typeof h&&(u=h.attributes,h=h.name),u=z(u),"elementNameFn"in m&&(h=m.elementNameFn(h,g)),m.compact){var P;if(v={},!m.ignoreAttributes&&u&&Object.keys(u).length)for(P in v[m.attributesKey]={},u)u.hasOwnProperty(P)&&(v[m.attributesKey][P]=u[P]);!(h in g)&&(F(m.alwaysArray)?-1!==m.alwaysArray.indexOf(h):m.alwaysArray)&&(g[h]=[]),g[h]&&!F(g[h])&&(g[h]=[g[h]]),F(g[h])?g[h].push(v):g[h]=v}else g[m.elementsKey]||(g[m.elementsKey]=[]),(v={})[m.typeKey]="element",v[m.nameKey]=h,!m.ignoreAttributes&&u&&Object.keys(u).length&&(v[m.attributesKey]=u),m.alwaysChildren&&(v[m.elementsKey]=[]),g[m.elementsKey].push(v);v[m.parentKey]=g,g=v}function Y(h){m.ignoreText||!h.trim()&&!m.captureSpacesBetweenElements||(m.trim&&(h=h.trim()),m.nativeType&&(h=J(h)),m.sanitize&&(h=h.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),L("text",h))}function H(h){m.ignoreComment||(m.trim&&(h=h.trim()),L("comment",h))}function W(h){var u=g[m.parentKey];m.addParent||delete g[m.parentKey],g=u}function oe(h){m.ignoreCdata||(m.trim&&(h=h.trim()),L("cdata",h))}function N(h){m.ignoreDoctype||(h=h.replace(/^ /,""),m.trim&&(h=h.trim()),L("doctype",h))}function k(h){h.note=h}he.exports=function(h,u){var v=e.parser(!0,{}),P={};if(g=P,m=function U(h){return m=M.copyOptions(h),M.ensureFlagExists("ignoreDeclaration",m),M.ensureFlagExists("ignoreInstruction",m),M.ensureFlagExists("ignoreAttributes",m),M.ensureFlagExists("ignoreText",m),M.ensureFlagExists("ignoreComment",m),M.ensureFlagExists("ignoreCdata",m),M.ensureFlagExists("ignoreDoctype",m),M.ensureFlagExists("compact",m),M.ensureFlagExists("alwaysChildren",m),M.ensureFlagExists("addParent",m),M.ensureFlagExists("trim",m),M.ensureFlagExists("nativeType",m),M.ensureFlagExists("nativeTypeAttributes",m),M.ensureFlagExists("sanitize",m),M.ensureFlagExists("instructionHasAttributes",m),M.ensureFlagExists("captureSpacesBetweenElements",m),M.ensureAlwaysArrayExists(m),M.ensureKeyExists("declaration",m),M.ensureKeyExists("instruction",m),M.ensureKeyExists("attributes",m),M.ensureKeyExists("text",m),M.ensureKeyExists("comment",m),M.ensureKeyExists("cdata",m),M.ensureKeyExists("doctype",m),M.ensureKeyExists("type",m),M.ensureKeyExists("name",m),M.ensureKeyExists("elements",m),M.ensureKeyExists("parent",m),M.checkFnExists("doctype",m),M.checkFnExists("instruction",m),M.checkFnExists("cdata",m),M.checkFnExists("comment",m),M.checkFnExists("text",m),M.checkFnExists("instructionName",m),M.checkFnExists("elementName",m),M.checkFnExists("attributeName",m),M.checkFnExists("attributeValue",m),M.checkFnExists("attributes",m),m}(u),v.opt={strictEntities:!0},v.onopentag=B,v.ontext=Y,v.oncomment=H,v.onclosetag=W,v.onerror=k,v.oncdata=oe,v.ondoctype=N,v.onprocessinginstruction=q,v.write(h).close(),P[m.elementsKey]){var $=P[m.elementsKey];delete P[m.elementsKey],P[m.elementsKey]=$,delete P.text}return P}},6976:(he,te,R)=>{var e=R(5886),O=R(9910);he.exports=function(F,m){var D,g,J;return D=function M(F){var m=e.copyOptions(F);return e.ensureSpacesExists(m),m}(m),g=O(F,D),J="compact"in D&&D.compact?"_parent":"parent",("addParent"in D&&D.addParent?JSON.stringify(g,function(L,z){return L===J?"_":z},D.spaces):JSON.stringify(g,null,D.spaces)).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}}}]);